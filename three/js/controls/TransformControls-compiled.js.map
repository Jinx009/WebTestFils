{"version":3,"sources":["TransformControls.js"],"names":[],"mappings":"AAAA,QAAQ,IAAR,CAAc,kTAAd;;AAEA,MAAM,iBAAN,GAA0B,UAAW,MAAX,EAAmB,UAAnB,EAAgC;;AAEzD,KAAK,eAAe,SAApB,EAAgC;;AAE/B,UAAQ,IAAR,CAAc,8EAAd;AACA,eAAa,QAAb;AAEA;;AAED,OAAM,QAAN,CAAe,IAAf,CAAqB,IAArB;;AAEA,MAAK,OAAL,GAAe,KAAf;AACA,MAAK,UAAL,GAAkB,UAAlB;;AAEA,KAAI,SAAS,IAAI,MAAM,sBAAV,EAAb;AACA,MAAK,GAAL,CAAU,MAAV;;AAEA,KAAI,SAAS,IAAI,MAAM,sBAAV,EAAb;AACA,MAAK,GAAL,CAAU,MAAV;;AAEA,KAAI,QAAQ,IAAZ;;AAEA;AACA;AACA;;AAEA,gBAAgB,QAAhB,EAA0B,MAA1B;AACA,gBAAgB,QAAhB,EAA0B,SAA1B;AACA,gBAAgB,SAAhB,EAA2B,IAA3B;AACA,gBAAgB,MAAhB,EAAwB,IAAxB;AACA,gBAAgB,MAAhB,EAAwB,WAAxB;AACA,gBAAgB,iBAAhB,EAAmC,IAAnC;AACA,gBAAgB,cAAhB,EAAgC,IAAhC;AACA,gBAAgB,WAAhB,EAA6B,IAA7B;AACA,gBAAgB,OAAhB,EAAyB,OAAzB;AACA,gBAAgB,MAAhB,EAAwB,CAAxB;AACA,gBAAgB,UAAhB,EAA4B,KAA5B;AACA,gBAAgB,OAAhB,EAAyB,IAAzB;AACA,gBAAgB,OAAhB,EAAyB,IAAzB;AACA,gBAAgB,OAAhB,EAAyB,IAAzB;;AAEA,KAAI,cAAc,EAAE,MAAM,QAAR,EAAlB;AACA,KAAI,iBAAiB,EAAE,MAAM,WAAR,EAArB;AACA,KAAI,eAAe,EAAE,MAAM,SAAR,EAAmB,MAAM,MAAM,IAA/B,EAAnB;AACA,KAAI,oBAAoB,EAAE,MAAM,cAAR,EAAxB;;AAEA;;AAEA,KAAI,YAAY,IAAI,MAAM,SAAV,EAAhB;;AAEA,UAAS,sBAAT,CAAiC,MAAjC,EAAyC,SAAzC,EAAoD,gBAApD,EAAuE;;AAEtE,MAAI,mBAAmB,UAAU,eAAV,CAA2B,MAA3B,EAAmC,IAAnC,CAAvB;;AAEA,OAAM,IAAI,IAAI,CAAd,EAAiB,IAAI,iBAAiB,MAAtC,EAA8C,GAA9C,EAAqD;;AAEpD,OAAK,iBAAkB,CAAlB,EAAsB,MAAtB,CAA6B,OAA7B,IAAwC,gBAA7C,EAAgE;;AAE/D,WAAO,iBAAkB,CAAlB,CAAP;AAEA;AAED;;AAED,SAAO,KAAP;AAEA;;AAED,KAAI,cAAc,IAAI,MAAM,OAAV,EAAlB;AACA,KAAI,eAAe,IAAI,MAAM,OAAV,EAAnB;AACA,KAAI,kBAAkB,IAAI,MAAM,UAAV,EAAtB;AACA,KAAI,QAAQ;AACX,KAAG,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CADQ;AAEX,KAAG,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAFQ;AAGX,KAAG,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB;AAHQ,EAAZ;;AAMA,KAAI,aAAa,IAAI,MAAM,OAAV,EAAjB;AACA,KAAI,WAAW,IAAI,MAAM,OAAV,EAAf;AACA,KAAI,SAAS,IAAI,MAAM,OAAV,EAAb;AACA,KAAI,eAAe,IAAI,MAAM,OAAV,EAAnB;AACA,KAAI,YAAY,IAAI,MAAM,OAAV,EAAhB;AACA,KAAI,UAAU,IAAI,MAAM,OAAV,EAAd;AACA,KAAI,gBAAgB,CAApB;;AAEA,KAAI,iBAAiB,IAAI,MAAM,OAAV,EAArB;AACA,KAAI,mBAAmB,IAAI,MAAM,UAAV,EAAvB;AACA,KAAI,cAAc,IAAI,MAAM,OAAV,EAAlB;;AAEA,KAAI,iBAAiB,IAAI,MAAM,OAAV,EAArB;AACA,KAAI,mBAAmB,IAAI,MAAM,UAAV,EAAvB;AACA,KAAI,sBAAsB,IAAI,MAAM,UAAV,EAA1B;AACA,KAAI,cAAc,IAAI,MAAM,OAAV,EAAlB;;AAEA,KAAI,qBAAqB,IAAI,MAAM,OAAV,EAAzB;AACA,KAAI,uBAAuB,IAAI,MAAM,UAAV,EAA3B;AACA,KAAI,kBAAkB,IAAI,MAAM,OAAV,EAAtB;;AAEA,KAAI,gBAAgB,IAAI,MAAM,OAAV,EAApB;AACA,KAAI,kBAAkB,IAAI,MAAM,UAAV,EAAtB;AACA,KAAI,qBAAqB,IAAI,MAAM,UAAV,EAAzB;AACA,KAAI,aAAa,IAAI,MAAM,OAAV,EAAjB;;AAEA,KAAI,MAAM,IAAI,MAAM,OAAV,EAAV;;AAEA,KAAI,gBAAgB,IAAI,MAAM,OAAV,EAApB;AACA,KAAI,kBAAkB,IAAI,MAAM,UAAV,EAAtB;AACA,KAAI,aAAa,IAAI,MAAM,OAAV,EAAjB;;AAEA;;AAEA,gBAAgB,eAAhB,EAAiC,aAAjC;AACA,gBAAgB,oBAAhB,EAAsC,kBAAtC;AACA,gBAAgB,iBAAhB,EAAmC,eAAnC;AACA,gBAAgB,sBAAhB,EAAwC,oBAAxC;AACA,gBAAgB,gBAAhB,EAAkC,cAAlC;AACA,gBAAgB,kBAAhB,EAAoC,gBAApC;AACA,gBAAgB,YAAhB,EAA8B,UAA9B;AACA,gBAAgB,UAAhB,EAA4B,QAA5B;AACA,gBAAgB,cAAhB,EAAgC,YAAhC;AACA,gBAAgB,eAAhB,EAAiC,aAAjC;AACA,gBAAgB,KAAhB,EAAuB,GAAvB;;AAEA;;AAEC,aAAW,gBAAX,CAA6B,aAA7B,EAA4C,aAA5C,EAA2D,KAA3D;AACA,aAAW,gBAAX,CAA6B,aAA7B,EAA4C,cAA5C,EAA4D,KAA5D;AACA,QAAM,UAAN,CAAiB,aAAjB,CAA+B,gBAA/B,CAAiD,WAAjD,EAA8D,WAA9D,EAA2E,KAA3E;AAEA;;AAED,MAAK,OAAL,GAAe,YAAY;;AAE1B,aAAW,mBAAX,CAAgC,aAAhC,EAA+C,aAA/C;AACA,aAAW,mBAAX,CAAgC,aAAhC,EAA+C,cAA/C;AACA,QAAM,UAAN,CAAiB,aAAjB,CAA+B,mBAA/B,CAAoD,aAApD,EAAmE,aAAnE;AACA,QAAM,UAAN,CAAiB,aAAjB,CAA+B,mBAA/B,CAAoD,WAApD,EAAiE,WAAjE;;AAEA,OAAK,QAAL,CAAe,UAAW,KAAX,EAAmB;;AAEjC,OAAK,MAAM,QAAX,EAAsB,MAAM,QAAN,CAAe,OAAf;AACtB,OAAK,MAAM,QAAX,EAAsB,MAAM,QAAN,CAAe,OAAf;AAEtB,GALD;AAOA,EAdD;;AAgBA;AACA,MAAK,MAAL,GAAc,UAAW,MAAX,EAAoB;;AAEjC,OAAK,MAAL,GAAc,MAAd;AACA,OAAK,OAAL,GAAe,IAAf;;AAEA,SAAO,IAAP;AAEA,EAPD;;AASA;AACA,MAAK,MAAL,GAAc,YAAY;;AAEzB,OAAK,MAAL,GAAc,SAAd;AACA,OAAK,OAAL,GAAe,KAAf;AACA,OAAK,IAAL,GAAY,IAAZ;;AAEA,SAAO,IAAP;AAEA,EARD;;AAUA;AACA,UAAS,cAAT,CAAyB,QAAzB,EAAmC,YAAnC,EAAkD;;AAEjD,MAAI,YAAY,YAAhB;;AAEA,SAAO,cAAP,CAAuB,KAAvB,EAA8B,QAA9B,EAAwC;;AAEvC,QAAK,YAAY;;AAEhB,WAAO,cAAc,SAAd,GAA0B,SAA1B,GAAsC,YAA7C;AAEA,IANsC;;AAQvC,QAAK,UAAW,KAAX,EAAmB;;AAEvB,QAAK,cAAc,KAAnB,EAA2B;;AAE1B,iBAAY,KAAZ;AACA,YAAQ,QAAR,IAAqB,KAArB;AACA,YAAQ,QAAR,IAAqB,KAArB;;AAEA,WAAM,aAAN,CAAqB,EAAE,MAAM,WAAW,UAAnB,EAA+B,OAAO,KAAtC,EAArB;AACA,WAAM,aAAN,CAAqB,WAArB;AAEA;AAED;;AArBsC,GAAxC;;AAyBA,QAAO,QAAP,IAAoB,YAApB;AACA,SAAQ,QAAR,IAAqB,YAArB;AACA,SAAQ,QAAR,IAAqB,YAArB;AAEA;;AAED;AACA,MAAK,iBAAL,GAAyB,YAAY;;AAEpC,MAAK,KAAK,MAAL,KAAgB,SAArB,EAAiC;;AAEhC,QAAK,MAAL,CAAY,iBAAZ;;AAEA,OAAK,KAAK,MAAL,CAAY,MAAZ,KAAuB,IAA5B,EAAmC;;AAElC,YAAQ,KAAR,CAAe,8EAAf;AAEA,IAJD,MAIO;;AAEN,SAAK,MAAL,CAAY,MAAZ,CAAmB,WAAnB,CAA+B,SAA/B,CAA0C,cAA1C,EAA0D,gBAA1D,EAA4E,WAA5E;AAEA;;AAED,QAAK,MAAL,CAAY,WAAZ,CAAwB,SAAxB,CAAmC,aAAnC,EAAkD,eAAlD,EAAmE,UAAnE;;AAEA,uBAAoB,IAApB,CAA0B,gBAA1B,EAA6C,OAA7C;AACA,sBAAmB,IAAnB,CAAyB,eAAzB,EAA2C,OAA3C;AAEA;;AAED,OAAK,MAAL,CAAY,iBAAZ;AACA,OAAK,MAAL,CAAY,WAAZ,CAAwB,SAAxB,CAAmC,cAAnC,EAAmD,gBAAnD,EAAqE,WAArE;;AAEA,MAAI,IAAJ,CAAU,cAAV,EAA2B,GAA3B,CAAgC,aAAhC,EAAgD,SAAhD;;AAEA,QAAM,QAAN,CAAe,SAAf,CAAyB,iBAAzB,CAA2C,IAA3C,CAAiD,IAAjD;AAEA,EA9BD;;AAgCA,MAAK,YAAL,GAAoB,UAAW,OAAX,EAAqB;;AAExC,MAAK,KAAK,MAAL,KAAgB,SAAhB,IAA6B,KAAK,QAAL,KAAkB,IAApD,EAA2D;;AAE3D,YAAU,aAAV,CAAyB,OAAzB,EAAkC,KAAK,MAAvC;;AAEA,MAAI,YAAY,uBAAwB,OAAO,MAAP,CAAe,KAAK,IAApB,CAAxB,EAAoD,SAApD,CAAhB;;AAEA,MAAK,SAAL,EAAiB;;AAEhB,QAAK,IAAL,GAAY,UAAU,MAAV,CAAiB,IAA7B;AAEA,GAJD,MAIO;;AAEN,QAAK,IAAL,GAAY,IAAZ;AAEA;AAED,EAlBD;;AAoBA,MAAK,WAAL,GAAmB,UAAW,OAAX,EAAqB;;AAEvC,MAAK,KAAK,MAAL,KAAgB,SAAhB,IAA6B,KAAK,QAAL,KAAkB,IAA/C,IAAuD,QAAQ,MAAR,KAAmB,CAA/E,EAAmF;;AAEnF,MAAK,KAAK,IAAL,KAAc,IAAnB,EAA0B;;AAEzB,aAAU,aAAV,CAAyB,OAAzB,EAAkC,KAAK,MAAvC;;AAEA,OAAI,iBAAiB,uBAAwB,MAAxB,EAAgC,SAAhC,EAA2C,IAA3C,CAArB;;AAEA,OAAK,cAAL,EAAsB;;AAErB,QAAI,QAAQ,KAAK,KAAjB;;AAEA,QAAK,KAAK,IAAL,KAAc,OAAnB,EAA6B;;AAE5B,aAAQ,OAAR;AAEA,KAJD,MAIO,IAAK,KAAK,IAAL,KAAc,GAAd,IAAqB,KAAK,IAAL,KAAc,MAAnC,IAA6C,KAAK,IAAL,KAAc,KAAhE,EAAwE;;AAE9E,aAAQ,OAAR;AAEA;;AAED,QAAK,UAAU,OAAV,IAAqB,KAAK,IAAL,KAAc,QAAxC,EAAmD;;AAElD,SAAI,OAAO,KAAK,YAAhB;;AAEA,SAAK,KAAK,IAAL,KAAc,GAAd,IAAqB,IAA1B,EAAiC,KAAK,MAAL,CAAY,QAAZ,CAAqB,CAArB,GAAyB,KAAK,KAAL,CAAY,KAAK,MAAL,CAAY,QAAZ,CAAqB,CAArB,GAAyB,IAArC,IAA8C,IAAvE;AACjC,SAAK,KAAK,IAAL,KAAc,GAAd,IAAqB,IAA1B,EAAiC,KAAK,MAAL,CAAY,QAAZ,CAAqB,CAArB,GAAyB,KAAK,KAAL,CAAY,KAAK,MAAL,CAAY,QAAZ,CAAqB,CAArB,GAAyB,IAArC,IAA8C,IAAvE;AACjC,SAAK,KAAK,IAAL,KAAc,GAAd,IAAqB,IAA1B,EAAiC,KAAK,MAAL,CAAY,QAAZ,CAAqB,CAArB,GAAyB,KAAK,KAAL,CAAY,KAAK,MAAL,CAAY,QAAZ,CAAqB,CAArB,GAAyB,IAArC,IAA8C,IAAvE;AAEjC;;AAED,SAAK,MAAL,CAAY,iBAAZ;AACA,SAAK,MAAL,CAAY,MAAZ,CAAmB,iBAAnB;;AAEA,kBAAc,IAAd,CAAoB,KAAK,MAAL,CAAY,QAAhC;AACA,oBAAgB,IAAhB,CAAsB,KAAK,MAAL,CAAY,UAAlC;AACA,eAAW,IAAX,CAAiB,KAAK,MAAL,CAAY,KAA7B;;AAEA,SAAK,MAAL,CAAY,WAAZ,CAAwB,SAAxB,CAAmC,kBAAnC,EAAuD,oBAAvD,EAA6E,eAA7E;;AAEA,eAAW,IAAX,CAAiB,eAAe,KAAhC,EAAwC,GAAxC,CAA6C,kBAA7C;AAEA;;AAED,QAAK,QAAL,GAAgB,IAAhB;AACA,kBAAe,IAAf,GAAsB,KAAK,IAA3B;AACA,QAAK,aAAL,CAAoB,cAApB;AAEA;AAED,EArDD;;AAuDA,MAAK,WAAL,GAAmB,UAAW,OAAX,EAAqB;;AAEvC,MAAI,OAAO,KAAK,IAAhB;AACA,MAAI,OAAO,KAAK,IAAhB;AACA,MAAI,SAAS,KAAK,MAAlB;AACA,MAAI,QAAQ,KAAK,KAAjB;;AAEA,MAAK,SAAS,OAAd,EAAwB;;AAEvB,WAAQ,OAAR;AAEA,GAJD,MAIO,IAAK,SAAS,GAAT,IAAgB,SAAS,MAAzB,IAAmC,SAAS,KAAjD,EAAyD;;AAE/D,WAAQ,OAAR;AAEA;;AAED,MAAK,WAAW,SAAX,IAAwB,SAAS,IAAjC,IAAyC,KAAK,QAAL,KAAkB,KAA3D,IAAoE,QAAQ,MAAR,KAAmB,CAAE,CAA9F,EAAkG;;AAElG,YAAU,aAAV,CAAyB,OAAzB,EAAkC,KAAK,MAAvC;;AAEA,MAAI,iBAAiB,uBAAwB,MAAxB,EAAgC,SAAhC,EAA2C,IAA3C,CAArB;;AAEA,MAAK,CAAE,cAAP,EAAwB;;AAExB,WAAS,IAAT,CAAe,eAAe,KAA9B,EAAsC,GAAtC,CAA2C,kBAA3C;;AAEA,MAAK,SAAS,WAAd,EAA4B;;AAE3B;;AAEA,UAAO,IAAP,CAAa,QAAb,EAAwB,GAAxB,CAA6B,UAA7B;;AAEA,OAAK,UAAU,OAAV,IAAqB,SAAS,KAAnC,EAA2C;;AAE1C,WAAO,eAAP,CAAwB,kBAAxB;AAEA;;AAED,OAAK,KAAK,OAAL,CAAc,GAAd,MAAwB,CAAE,CAA/B,EAAmC,OAAO,CAAP,GAAW,CAAX;AACnC,OAAK,KAAK,OAAL,CAAc,GAAd,MAAwB,CAAE,CAA/B,EAAmC,OAAO,CAAP,GAAW,CAAX;AACnC,OAAK,KAAK,OAAL,CAAc,GAAd,MAAwB,CAAE,CAA/B,EAAmC,OAAO,CAAP,GAAW,CAAX;;AAEnC,OAAK,UAAU,OAAV,IAAqB,SAAS,KAAnC,EAA2C;;AAE1C,WAAO,eAAP,CAAwB,eAAxB,EAA0C,MAA1C,CAAkD,WAAlD;AAEA,IAJD,MAIO;;AAEN,WAAO,eAAP,CAAwB,mBAAxB,EAA8C,MAA9C,CAAsD,WAAtD;AAEA;;AAED,UAAO,QAAP,CAAgB,IAAhB,CAAsB,MAAtB,EAA+B,GAA/B,CAAoC,aAApC;;AAEA;;AAEA,OAAK,KAAK,eAAV,EAA4B;;AAE3B,QAAK,UAAU,OAAf,EAAyB;;AAExB,YAAO,QAAP,CAAgB,eAAhB,CAAiC,gBAAgB,IAAhB,CAAsB,eAAtB,EAAwC,OAAxC,EAAjC;;AAEA,SAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,aAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,KAAL,CAAY,OAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,eAArC,IAAyD,KAAK,eAAlF;AAEA;;AAED,SAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,aAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,KAAL,CAAY,OAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,eAArC,IAAyD,KAAK,eAAlF;AAEA;;AAED,SAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,aAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,KAAL,CAAY,OAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,eAArC,IAAyD,KAAK,eAAlF;AAEA;;AAED,YAAO,QAAP,CAAgB,eAAhB,CAAiC,eAAjC;AAEA;;AAED,QAAK,UAAU,OAAf,EAAyB;;AAExB,SAAK,OAAO,MAAZ,EAAqB;;AAEpB,aAAO,QAAP,CAAgB,GAAhB,CAAqB,YAAY,qBAAZ,CAAmC,OAAO,MAAP,CAAc,WAAjD,CAArB;AAEA;;AAED,SAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,aAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,KAAL,CAAY,OAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,eAArC,IAAyD,KAAK,eAAlF;AAEA;;AAED,SAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,aAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,KAAL,CAAY,OAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,eAArC,IAAyD,KAAK,eAAlF;AAEA;;AAED,SAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,aAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,KAAL,CAAY,OAAO,QAAP,CAAgB,CAAhB,GAAoB,KAAK,eAArC,IAAyD,KAAK,eAAlF;AAEA;;AAED,SAAK,OAAO,MAAZ,EAAqB;;AAEpB,aAAO,QAAP,CAAgB,GAAhB,CAAqB,YAAY,qBAAZ,CAAmC,OAAO,MAAP,CAAc,WAAjD,CAArB;AAEA;AAED;AAED;AAED,GA9FD,MA8FO,IAAK,SAAS,OAAd,EAAwB;;AAE9B,OAAK,KAAK,MAAL,CAAa,KAAb,MAAyB,CAAE,CAAhC,EAAoC;;AAEnC,QAAI,IAAI,SAAS,MAAT,KAAoB,WAAW,MAAX,EAA5B;;AAEA,QAAK,SAAS,GAAT,CAAc,UAAd,IAA6B,CAAlC,EAAsC,KAAK,CAAE,CAAP;;AAEtC,iBAAa,GAAb,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB;AAEA,IARD,MAQO;;AAEN,gBAAY,IAAZ,CAAkB,UAAlB;AACA,iBAAa,IAAb,CAAmB,QAAnB;;AAEA,gBAAY,eAAZ,CAA6B,kBAA7B;AACA,iBAAa,eAAb,CAA8B,kBAA9B;;AAEA,iBAAa,MAAb,CAAqB,WAArB;;AAEA,QAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,kBAAa,CAAb,GAAiB,CAAjB;AAEA;;AAED,QAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,kBAAa,CAAb,GAAiB,CAAjB;AAEA;;AAED,QAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,kBAAa,CAAb,GAAiB,CAAjB;AAEA;AAED;;AAED;;AAEA,UAAO,KAAP,CAAa,IAAb,CAAmB,UAAnB,EAAgC,QAAhC,CAA0C,YAA1C;;AAEA,OAAK,KAAK,SAAV,EAAsB;;AAErB,QAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,YAAO,KAAP,CAAa,CAAb,GAAiB,KAAK,KAAL,CAAY,OAAO,KAAP,CAAa,CAAb,GAAiB,KAAK,SAAlC,IAAgD,KAAK,SAArD,IAAkE,KAAK,SAAxF;AAEA;;AAED,QAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,YAAO,KAAP,CAAa,CAAb,GAAiB,KAAK,KAAL,CAAY,OAAO,KAAP,CAAa,CAAb,GAAiB,KAAK,SAAlC,IAAgD,KAAK,SAArD,IAAkE,KAAK,SAAxF;AAEA;;AAED,QAAK,KAAK,MAAL,CAAa,GAAb,MAAuB,CAAE,CAA9B,EAAkC;;AAEjC,YAAO,KAAP,CAAa,CAAb,GAAiB,KAAK,KAAL,CAAY,OAAO,KAAP,CAAa,CAAb,GAAiB,KAAK,SAAlC,IAAgD,KAAK,SAArD,IAAkE,KAAK,SAAxF;AAEA;AAED;AAED,GAlEM,MAkEA,IAAK,SAAS,QAAd,EAAyB;;AAE/B,UAAO,IAAP,CAAa,QAAb,EAAwB,GAAxB,CAA6B,UAA7B;;AAEA,OAAI,iBAAiB,KAAK,cAAc,UAAd,CAA0B,YAAY,qBAAZ,CAAmC,KAAK,MAAL,CAAY,WAA/C,CAA1B,CAA1B;;AAEA,OAAK,SAAS,GAAd,EAAoB;;AAEnB,iBAAa,IAAb,CAAmB,GAAnB;AACA,oBAAgB,SAAS,OAAT,CAAkB,UAAlB,CAAhB;;AAEA,cAAU,IAAV,CAAgB,UAAhB,EAA6B,SAA7B;AACA,YAAQ,IAAR,CAAc,QAAd,EAAyB,SAAzB;;AAEA,qBAAmB,QAAQ,KAAR,CAAe,SAAf,EAA2B,GAA3B,CAAgC,GAAhC,IAAwC,CAAxC,GAA4C,CAA5C,GAAgD,CAAE,CAArE;AAEA,IAVD,MAUO,IAAK,SAAS,MAAd,EAAuB;;AAE7B,iBAAa,IAAb,CAAmB,MAAnB,EAA4B,KAA5B,CAAmC,GAAnC,EAAyC,SAAzC;AACA,oBAAgB,OAAO,GAAP,CAAY,YAAY,IAAZ,CAAkB,YAAlB,EAAiC,KAAjC,CAAwC,KAAK,GAA7C,CAAZ,IAAmE,cAAnF;AAEA,IALM,MAKA,IAAK,SAAS,GAAT,IAAgB,SAAS,GAAzB,IAAgC,SAAS,GAA9C,EAAoD;;AAE1D,iBAAa,IAAb,CAAmB,MAAO,IAAP,CAAnB;;AAEA,gBAAY,IAAZ,CAAkB,MAAO,IAAP,CAAlB;;AAEA,QAAK,UAAU,OAAf,EAAyB;;AAExB,iBAAY,eAAZ,CAA6B,eAA7B;AAEA;;AAED,oBAAgB,OAAO,GAAP,CAAY,YAAY,KAAZ,CAAmB,GAAnB,EAAyB,SAAzB,EAAZ,IAAqD,cAArE;AAEA;;AAED;;AAEA,OAAK,KAAK,YAAV,EAAyB,gBAAgB,KAAK,KAAL,CAAY,gBAAgB,KAAK,YAAjC,IAAkD,KAAK,YAAvE;;AAEzB,QAAK,aAAL,GAAqB,aAArB;;AAEA;AACA,OAAK,UAAU,OAAV,IAAqB,SAAS,GAA9B,IAAqC,SAAS,MAAnD,EAA4D;;AAE3D,WAAO,UAAP,CAAkB,IAAlB,CAAwB,eAAxB;AACA,WAAO,UAAP,CAAkB,QAAlB,CAA4B,gBAAgB,gBAAhB,CAAkC,YAAlC,EAAgD,aAAhD,CAA5B,EAA8F,SAA9F;AAEA,IALD,MAKO;;AAEN,iBAAa,eAAb,CAA8B,mBAA9B;AACA,WAAO,UAAP,CAAkB,IAAlB,CAAwB,gBAAgB,gBAAhB,CAAkC,YAAlC,EAAgD,aAAhD,CAAxB;AACA,WAAO,UAAP,CAAkB,QAAlB,CAA4B,eAA5B,EAA8C,SAA9C;AAEA;AAED;;AAED,OAAK,aAAL,CAAoB,WAApB;AACA,OAAK,aAAL,CAAoB,iBAApB;AAEA,EAzPD;;AA2PA,MAAK,SAAL,GAAiB,UAAW,OAAX,EAAqB;;AAErC,MAAK,QAAQ,MAAR,KAAmB,CAAxB,EAA4B;;AAE5B,MAAK,KAAK,QAAL,IAAmB,KAAK,IAAL,KAAc,IAAtC,EAA+C;;AAE9C,gBAAa,IAAb,GAAoB,KAAK,IAAzB;AACA,QAAK,aAAL,CAAoB,YAApB;AAEA;;AAED,OAAK,QAAL,GAAgB,KAAhB;AACA,OAAK,IAAL,GAAY,IAAZ;AAEA,EAdD;;AAgBA;;AAEA,UAAS,UAAT,CAAqB,KAArB,EAA6B;;AAE5B,MAAK,MAAM,UAAN,CAAiB,aAAjB,CAA+B,kBAApC,EAAyD;;AAExD,UAAO;AACN,OAAG,CADG;AAEN,OAAG,CAFG;AAGN,YAAQ,MAAM;AAHR,IAAP;AAMA,GARD,MAQO;;AAEN,OAAI,UAAU,MAAM,cAAN,GAAuB,MAAM,cAAN,CAAsB,CAAtB,CAAvB,GAAmD,KAAjE;;AAEA,OAAI,OAAO,WAAW,qBAAX,EAAX;;AAEA,UAAO;AACN,OAAG,CAAE,QAAQ,OAAR,GAAkB,KAAK,IAAzB,IAAkC,KAAK,KAAvC,GAA+C,CAA/C,GAAmD,CADhD;AAEN,OAAG,EAAI,QAAQ,OAAR,GAAkB,KAAK,GAA3B,IAAmC,KAAK,MAAxC,GAAiD,CAAjD,GAAqD,CAFlD;AAGN,YAAQ,MAAM;AAHR,IAAP;AAMA;AAED;;AAED;;AAEA,UAAS,cAAT,CAAyB,KAAzB,EAAiC;;AAEhC,MAAK,CAAE,MAAM,OAAb,EAAuB;;AAEvB,UAAS,MAAM,WAAf;;AAEC,QAAK,OAAL;AACA,QAAK,KAAL;AACC,UAAM,YAAN,CAAoB,WAAY,KAAZ,CAApB;AACA;;AALF;AASA;;AAED,UAAS,aAAT,CAAwB,KAAxB,EAAgC;;AAE/B,MAAK,CAAE,MAAM,OAAb,EAAuB;;AAEvB,QAAM,UAAN,CAAiB,KAAjB,CAAuB,WAAvB,GAAqC,MAArC,CAJ+B,CAIc;AAC7C,QAAM,UAAN,CAAiB,aAAjB,CAA+B,gBAA/B,CAAiD,aAAjD,EAAgE,aAAhE,EAA+E,KAA/E;;AAEA,QAAM,YAAN,CAAoB,WAAY,KAAZ,CAApB;AACA,QAAM,WAAN,CAAmB,WAAY,KAAZ,CAAnB;AAEA;;AAED,UAAS,aAAT,CAAwB,KAAxB,EAAgC;;AAE/B,MAAK,CAAE,MAAM,OAAb,EAAuB;;AAEvB,QAAM,WAAN,CAAmB,WAAY,KAAZ,CAAnB;AAEA;;AAED,UAAS,WAAT,CAAsB,KAAtB,EAA8B;;AAE7B,MAAK,CAAE,MAAM,OAAb,EAAuB;;AAEvB,QAAM,UAAN,CAAiB,KAAjB,CAAuB,WAAvB,GAAqC,EAArC;AACA,QAAM,UAAN,CAAiB,aAAjB,CAA+B,mBAA/B,CAAoD,aAApD,EAAmE,aAAnE,EAAkF,KAAlF;;AAEA,QAAM,SAAN,CAAiB,WAAY,KAAZ,CAAjB;AAEA;;AAED;;AAEA,MAAK,OAAL,GAAe,YAAY;;AAE1B,SAAO,MAAM,IAAb;AAEA,EAJD;;AAMA,MAAK,OAAL,GAAe,UAAW,IAAX,EAAkB;;AAEhC,QAAM,IAAN,GAAa,IAAb;AAEA,EAJD;;AAMA,MAAK,kBAAL,GAA0B,UAAW,eAAX,EAA6B;;AAEtD,QAAM,eAAN,GAAwB,eAAxB;AAEA,EAJD;;AAMA,MAAK,eAAL,GAAuB,UAAW,YAAX,EAA0B;;AAEhD,QAAM,YAAN,GAAqB,YAArB;AAEA,EAJD;;AAMA,MAAK,YAAL,GAAoB,UAAW,SAAX,EAAuB;;AAE1C,QAAM,SAAN,GAAkB,SAAlB;AAEA,EAJD;;AAMA,MAAK,OAAL,GAAe,UAAW,IAAX,EAAkB;;AAEhC,QAAM,IAAN,GAAa,IAAb;AAEA,EAJD;;AAMA,MAAK,QAAL,GAAgB,UAAW,KAAX,EAAmB;;AAElC,QAAM,KAAN,GAAc,KAAd;AAEA,EAJD;;AAMA,MAAK,MAAL,GAAc,YAAY;;AAEzB,UAAQ,IAAR,CAAc,uGAAd;AAEA,EAJD;AAMA,CAjsBD;;AAmsBA,MAAM,iBAAN,CAAwB,SAAxB,GAAoC,OAAO,MAAP,CAAe,OAAO,MAAP,CAAe,MAAM,QAAN,CAAe,SAA9B,CAAf,EAA0D;;AAE7F,cAAa,MAAM,iBAF0E;;AAI7F,sBAAqB;;AAJwE,CAA1D,CAApC;;AASA,MAAM,sBAAN,GAA+B,YAAY;;AAE1C;;AAEA,OAAM,QAAN,CAAe,IAAf,CAAqB,IAArB;;AAEA,MAAK,IAAL,GAAY,wBAAZ;;AAEA;;AAEA,KAAI,gBAAgB,IAAI,MAAM,iBAAV,CAA6B;AAChD,aAAW,KADqC;AAEhD,cAAY,KAFoC;AAGhD,eAAa,IAHmC;AAIhD,QAAM,MAAM,UAJoC;AAKhD,OAAK,KAL2C;AAMhD,cAAY;AANoC,EAA7B,CAApB;;AASA,KAAI,oBAAoB,IAAI,MAAM,iBAAV,CAA6B;AACpD,aAAW,KADyC;AAEpD,cAAY,KAFwC;AAGpD,eAAa,IAHuC;AAIpD,aAAW,CAJyC;AAKpD,OAAK,KAL+C;AAMpD,cAAY;AANwC,EAA7B,CAAxB;;AASA;;AAEA,KAAI,eAAe,cAAc,KAAd,EAAnB;AACA,cAAa,OAAb,GAAuB,IAAvB;;AAEA,KAAI,YAAY,cAAc,KAAd,EAAhB;AACA,WAAU,OAAV,GAAoB,IAApB;;AAEA,KAAI,SAAS,cAAc,KAAd,EAAb;AACA,QAAO,KAAP,CAAa,GAAb,CAAkB,QAAlB;;AAEA,KAAI,WAAW,cAAc,KAAd,EAAf;AACA,UAAS,KAAT,CAAe,GAAf,CAAoB,QAApB;;AAEA,KAAI,UAAU,cAAc,KAAd,EAAd;AACA,SAAQ,KAAR,CAAc,GAAd,CAAmB,QAAnB;;AAEA,KAAI,sBAAsB,cAAc,KAAd,EAA1B;AACA,qBAAoB,OAApB,GAA8B,IAA9B;;AAEA,KAAI,uBAAuB,oBAAoB,KAApB,EAA3B;AACA,sBAAqB,KAArB,CAA2B,GAA3B,CAAgC,QAAhC;;AAEA,KAAI,qBAAqB,oBAAoB,KAApB,EAAzB;AACA,oBAAmB,KAAnB,CAAyB,GAAzB,CAA8B,QAA9B;;AAEA,KAAI,wBAAwB,oBAAoB,KAApB,EAA5B;AACA,uBAAsB,KAAtB,CAA4B,GAA5B,CAAiC,QAAjC;;AAEA,KAAI,YAAY,cAAc,KAAd,EAAhB;AACA,WAAU,KAAV,CAAgB,GAAhB,CAAqB,QAArB;;AAEA,KAAI,aAAa,kBAAkB,KAAlB,EAAjB;AACA,YAAW,KAAX,CAAiB,GAAjB,CAAsB,QAAtB;;AAEA,KAAI,eAAe,kBAAkB,KAAlB,EAAnB;AACA,cAAa,KAAb,CAAmB,GAAnB,CAAwB,QAAxB;;AAEA,KAAI,cAAc,kBAAkB,KAAlB,EAAlB;AACA,aAAY,KAAZ,CAAkB,GAAlB,CAAuB,QAAvB;;AAEA,KAAI,cAAc,kBAAkB,KAAlB,EAAlB;AACA,aAAY,KAAZ,CAAkB,GAAlB,CAAuB,QAAvB;;AAEA,KAAI,iBAAiB,kBAAkB,KAAlB,EAArB;AACA,gBAAe,KAAf,CAAqB,GAArB,CAA0B,QAA1B;;AAEA,KAAI,gBAAgB,kBAAkB,KAAlB,EAApB;AACA,eAAc,KAAd,CAAoB,GAApB,CAAyB,QAAzB;;AAEA,KAAI,cAAc,kBAAkB,KAAlB,EAAlB;AACA,aAAY,KAAZ,CAAkB,GAAlB,CAAuB,QAAvB;;AAEA,KAAI,2BAA2B,cAAc,KAAd,EAA/B;AACA,0BAAyB,OAAzB,GAAmC,IAAnC;;AAEA;;AAEA,KAAI,gBAAgB,IAAI,MAAM,sBAAV,CAAkC,CAAlC,EAAqC,IAArC,EAA2C,GAA3C,EAAgD,EAAhD,EAAoD,CAApD,EAAuD,KAAvD,CAApB;;AAEA,KAAI,sBAAsB,IAAI,MAAM,iBAAV,CAA6B,KAA7B,EAAoC,KAApC,EAA2C,KAA3C,CAA1B;;AAEA,KAAI,eAAe,IAAI,MAAM,cAAV,EAAnB;AACA,cAAa,YAAb,CAA2B,UAA3B,EAAuC,IAAI,MAAM,sBAAV,CAAkC,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAAlC,EAAwD,CAAxD,CAAvC;;AAEA,KAAI,iBAAiB,UAAW,MAAX,EAAmB,GAAnB,EAAyB;;AAE7C,MAAI,WAAW,IAAI,MAAM,cAAV,EAAf;AACA,MAAI,WAAW,EAAf;;AAEA,OAAM,IAAI,IAAI,CAAd,EAAiB,KAAK,KAAK,GAA3B,EAAgC,EAAG,CAAnC,EAAuC;;AAEtC,YAAS,IAAT,CAAe,CAAf,EAAkB,KAAK,GAAL,CAAU,IAAI,EAAJ,GAAS,KAAK,EAAxB,IAA+B,MAAjD,EAAyD,KAAK,GAAL,CAAU,IAAI,EAAJ,GAAS,KAAK,EAAxB,IAA+B,MAAxF;AAEA;;AAED,WAAS,YAAT,CAAuB,UAAvB,EAAmC,IAAI,MAAM,sBAAV,CAAkC,QAAlC,EAA4C,CAA5C,CAAnC;;AAEA,SAAO,QAAP;AAEA,EAfD;;AAiBA;;AAEA,KAAI,0BAA0B,YAAY;;AAEzC,MAAI,WAAW,IAAI,MAAM,cAAV,EAAf;;AAEA,WAAS,YAAT,CAAuB,UAAvB,EAAmC,IAAI,MAAM,sBAAV,CAAkC,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAAlC,EAAwD,CAAxD,CAAnC;;AAEA,SAAO,QAAP;AAEA,EARD;;AAUA;;AAEA,KAAI,iBAAiB;AACpB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,aAAhB,EAA+B,MAA/B,CAAF,EAA2C,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA3C,EAAwD,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,KAAK,EAAP,GAAY,CAApB,CAAxD,EAAiF,IAAjF,EAAuF,KAAvF,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,aAAhB,EAA+B,MAA/B,CAAF,EAA2C,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA3C,EAAwD,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAxD,EAA+E,IAA/E,EAAqF,KAArF,CAFE,EAGF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAA9B,CAAF,CAHE,CADiB;AAMpB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,aAAhB,EAA+B,QAA/B,CAAF,EAA6C,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA7C,EAA0D,IAA1D,EAAgE,IAAhE,EAAsE,KAAtE,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,aAAhB,EAA+B,QAA/B,CAAF,EAA6C,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA7C,EAA0D,CAAE,KAAK,EAAP,EAAW,CAAX,EAAc,CAAd,CAA1D,EAA6E,IAA7E,EAAmF,KAAnF,CAFE,EAGF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,YAA9B,CAAF,EAAgD,IAAhD,EAAsD,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAtD,CAHE,CANiB;AAWpB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,aAAhB,EAA+B,OAA/B,CAAF,EAA4C,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA5C,EAAyD,CAAE,KAAK,EAAL,GAAU,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAzD,EAAgF,IAAhF,EAAsF,KAAtF,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,aAAhB,EAA+B,OAA/B,CAAF,EAA4C,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA5C,EAAyD,CAAE,CAAE,KAAK,EAAP,GAAY,CAAd,EAAiB,CAAjB,EAAoB,CAApB,CAAzD,EAAkF,IAAlF,EAAwF,KAAxF,CAFE,EAGF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,WAA9B,CAAF,EAA+C,IAA/C,EAAqD,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAApB,CAArD,CAHE,CAXiB;AAgBpB,OAAK,CACJ,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,wBAAV,CAAoC,GAApC,EAAyC,CAAzC,CAAhB,EAA8D,oBAAoB,KAApB,EAA9D,CAAF,EAA+F,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA/F,EAA4G,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA5G,CADI,CAhBe;AAmBpB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,KAA/B,EAAsC,KAAtC,CAAhB,EAA+D,qBAAqB,KAArB,EAA/D,CAAF,EAAiG,CAAE,IAAF,EAAQ,IAAR,EAAc,CAAd,CAAjG,CADG,EAEH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,aAA9B,CAAF,EAAiD,CAAE,IAAF,EAAQ,GAAR,EAAa,CAAb,CAAjD,EAAmE,IAAnE,EAAyE,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAAzE,CAFG,EAGH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,aAA9B,CAAF,EAAiD,CAAE,GAAF,EAAO,IAAP,EAAa,CAAb,CAAjD,EAAmE,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAnE,EAA0F,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA1F,CAHG,CAnBgB;AAwBpB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,KAA/B,EAAsC,KAAtC,CAAhB,EAA+D,mBAAmB,KAAnB,EAA/D,CAAF,EAA+F,CAAE,CAAF,EAAK,IAAL,EAAW,IAAX,CAA/F,EAAkH,CAAE,CAAF,EAAK,KAAK,EAAL,GAAU,CAAf,EAAkB,CAAlB,CAAlH,CADG,EAEH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,WAA9B,CAAF,EAA+C,CAAE,CAAF,EAAK,IAAL,EAAW,GAAX,CAA/C,EAAiE,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAjE,EAAwF,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAAxF,CAFG,EAGH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,WAA9B,CAAF,EAA+C,CAAE,CAAF,EAAK,GAAL,EAAU,IAAV,CAA/C,EAAiE,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAApB,CAAjE,EAA0F,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA1F,CAHG,CAxBgB;AA6BpB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,KAA/B,EAAsC,KAAtC,CAAhB,EAA+D,sBAAsB,KAAtB,EAA/D,CAAF,EAAkG,CAAE,IAAF,EAAQ,CAAR,EAAW,IAAX,CAAlG,EAAqH,CAAE,CAAE,KAAK,EAAP,GAAY,CAAd,EAAiB,CAAjB,EAAoB,CAApB,CAArH,CADG,EAEH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,cAA9B,CAAF,EAAkD,CAAE,IAAF,EAAQ,CAAR,EAAW,GAAX,CAAlD,EAAoE,IAApE,EAA0E,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA1E,CAFG,EAGH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,cAA9B,CAAF,EAAkD,CAAE,GAAF,EAAO,CAAP,EAAU,IAAV,CAAlD,EAAoE,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAApB,CAApE,EAA6F,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA7F,CAHG;AA7BgB,EAArB;;AAoCA,KAAI,kBAAkB;AACrB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,GAAlC,EAAuC,CAAvC,EAA0C,CAA1C,EAA6C,CAA7C,EAAgD,CAAhD,EAAmD,KAAnD,CAAhB,EAA4E,YAA5E,CAAF,EAA8F,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA9F,EAA6G,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,KAAK,EAAP,GAAY,CAApB,CAA7G,CADE,CADkB;AAIrB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,GAAlC,EAAuC,CAAvC,EAA0C,CAA1C,EAA6C,CAA7C,EAAgD,CAAhD,EAAmD,KAAnD,CAAhB,EAA4E,YAA5E,CAAF,EAA8F,CAAE,CAAF,EAAK,GAAL,EAAU,CAAV,CAA9F,CADE,CAJkB;AAOrB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,GAAlC,EAAuC,CAAvC,EAA0C,CAA1C,EAA6C,CAA7C,EAAgD,CAAhD,EAAmD,KAAnD,CAAhB,EAA4E,YAA5E,CAAF,EAA8F,CAAE,CAAF,EAAK,CAAL,EAAQ,GAAR,CAA9F,EAA6G,CAAE,KAAK,EAAL,GAAU,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA7G,CADE,CAPkB;AAUrB,OAAK,CACJ,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,wBAAV,CAAoC,GAApC,EAAyC,CAAzC,CAAhB,EAA8D,YAA9D,CAAF,CADI,CAVgB;AAarB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,GAA/B,EAAoC,GAApC,CAAhB,EAA2D,YAA3D,CAAF,EAA6E,CAAE,GAAF,EAAO,GAAP,EAAY,CAAZ,CAA7E,CADG,CAbiB;AAgBrB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,GAA/B,EAAoC,GAApC,CAAhB,EAA2D,YAA3D,CAAF,EAA6E,CAAE,CAAF,EAAK,GAAL,EAAU,GAAV,CAA7E,EAA8F,CAAE,CAAF,EAAK,KAAK,EAAL,GAAU,CAAf,EAAkB,CAAlB,CAA9F,CADG,CAhBiB;AAmBrB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,GAA/B,EAAoC,GAApC,CAAhB,EAA2D,YAA3D,CAAF,EAA6E,CAAE,GAAF,EAAO,CAAP,EAAU,GAAV,CAA7E,EAA8F,CAAE,CAAE,KAAK,EAAP,GAAY,CAAd,EAAiB,CAAjB,EAAoB,CAApB,CAA9F,CADG;AAnBiB,EAAtB;;AAwBA,KAAI,kBAAkB;AACrB,SAAO,CACN,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,wBAAV,CAAoC,IAApC,EAA0C,CAA1C,CAAhB,EAA+D,SAA/D,CAAF,EAA8E,IAA9E,EAAoF,IAApF,EAA0F,IAA1F,EAAgG,QAAhG,CADM,CADc;AAIrB,OAAK,CACJ,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,wBAAV,CAAoC,IAApC,EAA0C,CAA1C,CAAhB,EAA+D,SAA/D,CAAF,EAA8E,IAA9E,EAAoF,IAApF,EAA0F,IAA1F,EAAgG,QAAhG,CADI,CAJgB;AAOrB,SAAO,CACN,CAAE,IAAI,MAAM,IAAV,CAAgB,yBAAhB,EAA2C,SAA3C,CAAF,EAA0D,IAA1D,EAAgE,IAAhE,EAAsE,IAAtE,EAA4E,QAA5E,CADM,CAPc;AAUrB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAAU,KAAV,EAA9B,CAAF,EAAqD,CAAE,CAAE,GAAJ,EAAS,CAAT,EAAY,CAAZ,CAArD,EAAsE,IAAtE,EAA4E,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA5E,EAA2F,QAA3F,CADE,CAVkB;AAarB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAAU,KAAV,EAA9B,CAAF,EAAqD,CAAE,CAAF,EAAK,CAAE,GAAP,EAAY,CAAZ,CAArD,EAAsE,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAtE,EAA6F,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA7F,EAA4G,QAA5G,CADE,CAbkB;AAgBrB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAAU,KAAV,EAA9B,CAAF,EAAqD,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,GAAV,CAArD,EAAsE,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAApB,CAAtE,EAA+F,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA/F,EAA8G,QAA9G,CADE;AAhBkB,EAAtB;;AAqBA,KAAI,cAAc;AACjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,eAAgB,CAAhB,EAAmB,GAAnB,CAAhB,EAA0C,UAA1C,CAAF,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,wBAAV,CAAoC,IAApC,EAA0C,CAA1C,CAAhB,EAA+D,MAA/D,CAAF,EAA2E,CAAE,CAAF,EAAK,CAAL,EAAQ,IAAR,CAA3E,EAA2F,IAA3F,EAAiG,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAAjG,CAFE,CADc;AAKjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,eAAgB,CAAhB,EAAmB,GAAnB,CAAhB,EAA0C,YAA1C,CAAF,EAA4D,IAA5D,EAAkE,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,KAAK,EAAP,GAAY,CAApB,CAAlE,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,wBAAV,CAAoC,IAApC,EAA0C,CAA1C,CAAhB,EAA+D,QAA/D,CAAF,EAA6E,CAAE,CAAF,EAAK,CAAL,EAAQ,IAAR,CAA7E,EAA6F,IAA7F,EAAmG,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAAnG,CAFE,CALc;AASjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,eAAgB,CAAhB,EAAmB,GAAnB,CAAhB,EAA0C,WAA1C,CAAF,EAA2D,IAA3D,EAAiE,CAAE,CAAF,EAAK,KAAK,EAAL,GAAU,CAAf,EAAkB,CAAlB,CAAjE,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,wBAAV,CAAoC,IAApC,EAA0C,CAA1C,CAAhB,EAA+D,OAA/D,CAAF,EAA4E,CAAE,IAAF,EAAQ,CAAR,EAAW,CAAX,CAA5E,EAA4F,IAA5F,EAAkG,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAAlG,CAFE,CATc;AAajB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,eAAgB,IAAhB,EAAsB,CAAtB,CAAhB,EAA2C,wBAA3C,CAAF,EAAyE,IAAzE,EAA+E,CAAE,CAAF,EAAK,KAAK,EAAL,GAAU,CAAf,EAAkB,CAAlB,CAA/E,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,IAAlC,EAAwC,CAAxC,EAA2C,IAA3C,EAAiD,CAAjD,EAAoD,CAApD,EAAuD,KAAvD,CAAhB,EAAgF,wBAAhF,CAAF,EAA8G,CAAE,IAAF,EAAQ,CAAR,EAAW,CAAX,CAA9G,EAA8H,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,KAAK,EAAP,GAAY,CAApB,CAA9H,EAAuJ,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAR,CAAvJ,CAFE,EAGF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,IAAlC,EAAwC,CAAxC,EAA2C,IAA3C,EAAiD,CAAjD,EAAoD,CAApD,EAAuD,KAAvD,CAAhB,EAAgF,wBAAhF,CAAF,EAA8G,CAAE,CAAE,IAAJ,EAAU,CAAV,EAAa,CAAb,CAA9G,EAAgI,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAhI,EAAuJ,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAR,CAAvJ,CAHE,EAIF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,IAAlC,EAAwC,CAAxC,EAA2C,IAA3C,EAAiD,CAAjD,EAAoD,CAApD,EAAuD,KAAvD,CAAhB,EAAgF,wBAAhF,CAAF,EAA8G,CAAE,CAAF,EAAK,CAAE,IAAP,EAAa,CAAb,CAA9G,EAAgI,CAAE,KAAK,EAAP,EAAW,CAAX,EAAc,CAAd,CAAhI,EAAmJ,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAR,CAAnJ,CAJE,EAKF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,IAAlC,EAAwC,CAAxC,EAA2C,IAA3C,EAAiD,CAAjD,EAAoD,CAApD,EAAuD,KAAvD,CAAhB,EAAgF,wBAAhF,CAAF,EAA8G,CAAE,CAAF,EAAK,IAAL,EAAW,CAAX,CAA9G,EAA8H,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA9H,EAA2I,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAR,CAA3I,CALE,CAbc;AAoBjB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,eAAgB,CAAhB,EAAmB,CAAnB,CAAhB,EAAwC,WAAxC,CAAF,EAAyD,IAAzD,EAA+D,CAAE,CAAF,EAAK,KAAK,EAAL,GAAU,CAAf,EAAkB,CAAlB,CAA/D,CADK;AApBW,EAAlB;;AAyBA,KAAI,eAAe;AAClB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAAU,KAAV,EAA9B,CAAF,EAAqD,CAAE,CAAE,GAAJ,EAAS,CAAT,EAAY,CAAZ,CAArD,EAAsE,IAAtE,EAA4E,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA5E,EAA2F,QAA3F,CADK;AADY,EAAnB;;AAMA,KAAI,eAAe;AAClB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,CAA/B,EAAkC,GAAlC,EAAuC,CAAvC,EAA0C,EAA1C,CAAhB,EAAgE,YAAhE,CAAF,EAAkF,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAAlF,EAA+F,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAAE,KAAK,EAAP,GAAY,CAAhC,CAA/F,CADE,CADe;AAIlB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,CAA/B,EAAkC,GAAlC,EAAuC,CAAvC,EAA0C,EAA1C,CAAhB,EAAgE,YAAhE,CAAF,EAAkF,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAAlF,EAA+F,CAAE,KAAK,EAAL,GAAU,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA/F,CADE,CAJe;AAOlB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,CAA/B,EAAkC,GAAlC,EAAuC,CAAvC,EAA0C,EAA1C,CAAhB,EAAgE,YAAhE,CAAF,EAAkF,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,CAAlF,EAA+F,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,KAAK,EAAP,GAAY,CAApB,CAA/F,CADE,CAPe;AAUlB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,mBAAV,CAA+B,IAA/B,EAAqC,GAArC,EAA0C,CAA1C,EAA6C,EAA7C,CAAhB,EAAmE,YAAnE,CAAF,CADE,CAVe;AAalB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,oBAAV,CAAgC,GAAhC,EAAqC,EAArC,EAAyC,CAAzC,CAAhB,EAA8D,YAA9D,CAAF,CADK;AAbY,EAAnB;;AAkBA,KAAI,aAAa;AAChB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,MAArC,CAAF,EAAiD,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAAjD,EAAgE,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,KAAK,EAAP,GAAY,CAApB,CAAhE,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAA9B,CAAF,EAA8C,IAA9C,EAAoD,IAApD,EAA0D,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA1D,CAFE,CADa;AAKhB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,QAArC,CAAF,EAAmD,CAAE,CAAF,EAAK,GAAL,EAAU,CAAV,CAAnD,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,YAA9B,CAAF,EAAgD,IAAhD,EAAsD,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAtD,EAA6E,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA7E,CAFE,CALa;AAShB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,OAArC,CAAF,EAAkD,CAAE,CAAF,EAAK,CAAL,EAAQ,GAAR,CAAlD,EAAiE,CAAE,KAAK,EAAL,GAAU,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAjE,CADE,EAEF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,WAA9B,CAAF,EAA+C,IAA/C,EAAqD,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAApB,CAArD,EAA8E,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA9E,CAFE,CATa;AAahB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,oBAArC,CAAF,EAA+D,CAAE,IAAF,EAAQ,IAAR,EAAc,CAAd,CAA/D,EAAkF,IAAlF,EAAwF,CAAE,CAAF,EAAK,CAAL,EAAQ,GAAR,CAAxF,CADG,EAEH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,aAA9B,CAAF,EAAiD,CAAE,KAAF,EAAS,IAAT,EAAe,CAAf,CAAjD,EAAqE,IAArE,EAA2E,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA3E,CAFG,EAGH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,aAA9B,CAAF,EAAiD,CAAE,IAAF,EAAQ,KAAR,EAAe,CAAf,CAAjD,EAAqE,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAArE,EAA4F,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA5F,CAHG,CAbY;AAkBhB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,kBAArC,CAAF,EAA6D,CAAE,CAAF,EAAK,IAAL,EAAW,IAAX,CAA7D,EAAgF,IAAhF,EAAsF,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAAtF,CADG,EAEH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,WAA9B,CAAF,EAA+C,CAAE,CAAF,EAAK,KAAL,EAAY,IAAZ,CAA/C,EAAmE,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAnE,EAA0F,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA1F,CAFG,EAGH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,WAA9B,CAAF,EAA+C,CAAE,CAAF,EAAK,IAAL,EAAW,KAAX,CAA/C,EAAmE,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAApB,CAAnE,EAA4F,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA5F,CAHG,CAlBY;AAuBhB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,qBAArC,CAAF,EAAgE,CAAE,IAAF,EAAQ,CAAR,EAAW,IAAX,CAAhE,EAAmF,IAAnF,EAAyF,CAAE,CAAF,EAAK,GAAL,EAAU,CAAV,CAAzF,CADG,EAEH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,cAA9B,CAAF,EAAkD,CAAE,KAAF,EAAS,CAAT,EAAY,IAAZ,CAAlD,EAAsE,IAAtE,EAA4E,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA5E,CAFG,EAGH,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,cAA9B,CAAF,EAAkD,CAAE,IAAF,EAAQ,CAAR,EAAW,KAAX,CAAlD,EAAsE,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAApB,CAAtE,EAA+F,CAAE,KAAF,EAAS,CAAT,EAAY,CAAZ,CAA/F,CAHG,CAvBY;AA4BhB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,iBAAV,CAA6B,KAA7B,EAAoC,KAApC,EAA2C,KAA3C,CAAhB,EAAoE,oBAAoB,KAApB,EAApE,CAAF,EAAqG,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAArG,CADK,CA5BU;AA+BhB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,iBAAV,CAA6B,KAA7B,EAAoC,KAApC,EAA2C,KAA3C,CAAhB,EAAoE,oBAAoB,KAApB,EAApE,CAAF,EAAqG,CAAE,CAAF,EAAK,GAAL,EAAU,CAAV,CAArG,CADK,CA/BU;AAkChB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,iBAAV,CAA6B,KAA7B,EAAoC,KAApC,EAA2C,KAA3C,CAAhB,EAAoE,oBAAoB,KAApB,EAApE,CAAF,EAAqG,CAAE,CAAF,EAAK,CAAL,EAAQ,GAAR,CAArG,CADK;AAlCU,EAAjB;;AAuCA,KAAI,cAAc;AACjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,GAAlC,EAAuC,CAAvC,EAA0C,GAA1C,EAA+C,CAA/C,EAAkD,CAAlD,EAAqD,KAArD,CAAhB,EAA8E,YAA9E,CAAF,EAAgG,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAAhG,EAA+G,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,KAAK,EAAP,GAAY,CAApB,CAA/G,CADE,CADc;AAIjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,GAAlC,EAAuC,CAAvC,EAA0C,GAA1C,EAA+C,CAA/C,EAAkD,CAAlD,EAAqD,KAArD,CAAhB,EAA8E,YAA9E,CAAF,EAAgG,CAAE,CAAF,EAAK,GAAL,EAAU,CAAV,CAAhG,CADE,CAJc;AAOjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,sBAAV,CAAkC,GAAlC,EAAuC,CAAvC,EAA0C,GAA1C,EAA+C,CAA/C,EAAkD,CAAlD,EAAqD,KAArD,CAAhB,EAA8E,YAA9E,CAAF,EAAgG,CAAE,CAAF,EAAK,CAAL,EAAQ,GAAR,CAAhG,EAA+G,CAAE,KAAK,EAAL,GAAU,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA/G,CADE,CAPc;AAUjB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,YAArC,CAAF,EAAuD,CAAE,IAAF,EAAQ,IAAR,EAAc,CAAd,CAAvD,EAA0E,IAA1E,EAAgF,CAAE,CAAF,EAAK,CAAL,EAAQ,GAAR,CAAhF,CADG,CAVa;AAajB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,YAArC,CAAF,EAAuD,CAAE,CAAF,EAAK,IAAL,EAAW,IAAX,CAAvD,EAA0E,IAA1E,EAAgF,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAAhF,CADG,CAba;AAgBjB,MAAI,CACH,CAAE,IAAI,MAAM,IAAV,CAAgB,mBAAhB,EAAqC,YAArC,CAAF,EAAuD,CAAE,IAAF,EAAQ,CAAR,EAAW,IAAX,CAAvD,EAA0E,IAA1E,EAAgF,CAAE,CAAF,EAAK,GAAL,EAAU,CAAV,CAAhF,CADG,CAhBa;AAmBjB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,iBAAV,CAA6B,GAA7B,EAAkC,GAAlC,EAAuC,GAAvC,CAAhB,EAA8D,YAA9D,CAAF,EAAgF,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAAhF,CADK,CAnBW;AAsBjB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,iBAAV,CAA6B,GAA7B,EAAkC,GAAlC,EAAuC,GAAvC,CAAhB,EAA8D,YAA9D,CAAF,EAAgF,CAAE,CAAF,EAAK,GAAL,EAAU,CAAV,CAAhF,CADK,CAtBW;AAyBjB,QAAM,CACL,CAAE,IAAI,MAAM,IAAV,CAAgB,IAAI,MAAM,iBAAV,CAA6B,GAA7B,EAAkC,GAAlC,EAAuC,GAAvC,CAAhB,EAA8D,YAA9D,CAAF,EAAgF,CAAE,CAAF,EAAK,CAAL,EAAQ,GAAR,CAAhF,CADK;AAzBW,EAAlB;;AA8BA,KAAI,cAAc;AACjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAAU,KAAV,EAA9B,CAAF,EAAqD,CAAE,CAAE,GAAJ,EAAS,CAAT,EAAY,CAAZ,CAArD,EAAsE,IAAtE,EAA4E,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA5E,EAA2F,QAA3F,CADE,CADc;AAIjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAAU,KAAV,EAA9B,CAAF,EAAqD,CAAE,CAAF,EAAK,CAAE,GAAP,EAAY,CAAZ,CAArD,EAAsE,CAAE,CAAF,EAAK,CAAL,EAAQ,KAAK,EAAL,GAAU,CAAlB,CAAtE,EAA6F,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA7F,EAA4G,QAA5G,CADE,CAJc;AAOjB,KAAG,CACF,CAAE,IAAI,MAAM,IAAV,CAAgB,YAAhB,EAA8B,UAAU,KAAV,EAA9B,CAAF,EAAqD,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAE,GAAV,CAArD,EAAsE,CAAE,CAAF,EAAK,CAAE,KAAK,EAAP,GAAY,CAAjB,EAAoB,CAApB,CAAtE,EAA+F,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,CAA/F,EAA8G,QAA9G,CADE;AAPc,EAAlB;;AAYA;;AAEA,KAAI,aAAa,UAAW,QAAX,EAAsB;;AAEtC,MAAI,QAAQ,IAAI,MAAM,QAAV,EAAZ;;AAEA,OAAM,IAAI,IAAV,IAAkB,QAAlB,EAA6B;;AAE5B,QAAM,IAAI,IAAI,SAAU,IAAV,EAAiB,MAA/B,EAAuC,GAAvC,GAA+C;;AAE9C,QAAI,SAAS,SAAU,IAAV,EAAkB,CAAlB,EAAuB,CAAvB,EAA2B,KAA3B,EAAb;AACA,QAAI,WAAW,SAAU,IAAV,EAAkB,CAAlB,EAAuB,CAAvB,CAAf;AACA,QAAI,WAAW,SAAU,IAAV,EAAkB,CAAlB,EAAuB,CAAvB,CAAf;AACA,QAAI,QAAQ,SAAU,IAAV,EAAkB,CAAlB,EAAuB,CAAvB,CAAZ;AACA,QAAI,MAAM,SAAU,IAAV,EAAkB,CAAlB,EAAuB,CAAvB,CAAV;;AAEA;AACA,WAAO,IAAP,GAAc,IAAd;AACA,WAAO,GAAP,GAAa,GAAb;;AAEA,QAAK,QAAL,EAAgB;;AAEf,YAAO,QAAP,CAAgB,GAAhB,CAAqB,SAAU,CAAV,CAArB,EAAoC,SAAU,CAAV,CAApC,EAAmD,SAAU,CAAV,CAAnD;AAEA;;AAED,QAAK,QAAL,EAAgB;;AAEf,YAAO,QAAP,CAAgB,GAAhB,CAAqB,SAAU,CAAV,CAArB,EAAoC,SAAU,CAAV,CAApC,EAAmD,SAAU,CAAV,CAAnD;AAEA;;AAED,QAAK,KAAL,EAAa;;AAEZ,YAAO,KAAP,CAAa,GAAb,CAAkB,MAAO,CAAP,CAAlB,EAA8B,MAAO,CAAP,CAA9B,EAA0C,MAAO,CAAP,CAA1C;AAEA;;AAED,WAAO,YAAP;;AAEA,QAAI,eAAe,OAAO,QAAP,CAAgB,KAAhB,EAAnB;AACA,iBAAa,YAAb,CAA2B,OAAO,MAAlC;AACA,WAAO,QAAP,GAAkB,YAAlB;AACA,WAAO,WAAP,GAAqB,QAArB;;AAEA,WAAO,QAAP,CAAgB,GAAhB,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B;AACA,WAAO,QAAP,CAAgB,GAAhB,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B;AACA,WAAO,KAAP,CAAa,GAAb,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB;;AAEA,UAAM,GAAN,CAAW,MAAX;AAEA;AAED;;AAED,SAAO,KAAP;AAEA,EAvDD;;AAyDA;;AAEA,KAAI,aAAa,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAjB;AACA,KAAI,YAAY,IAAI,MAAM,KAAV,EAAhB;AACA,KAAI,cAAc,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAlB;AACA,KAAI,aAAa,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAjB;AACA,KAAI,eAAe,IAAI,MAAM,OAAV,EAAnB;AACA,KAAI,iBAAiB,IAAI,MAAM,UAAV,EAArB;AACA,KAAI,kBAAkB,IAAI,MAAM,UAAV,EAAtB;AACA,KAAI,qBAAqB,IAAI,MAAM,UAAV,EAAzB;;AAEA,KAAI,QAAQ,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAZ;AACA,KAAI,QAAQ,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAZ;AACA,KAAI,QAAQ,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAZ;;AAEA;;AAEA,MAAK,KAAL,GAAa,EAAb;AACA,MAAK,MAAL,GAAc,EAAd;AACA,MAAK,MAAL,GAAc,EAAd;;AAEA,MAAK,GAAL,CAAU,KAAK,KAAL,CAAY,WAAZ,IAA4B,WAAY,cAAZ,CAAtC;AACA,MAAK,GAAL,CAAU,KAAK,KAAL,CAAY,QAAZ,IAAyB,WAAY,WAAZ,CAAnC;AACA,MAAK,GAAL,CAAU,KAAK,KAAL,CAAY,OAAZ,IAAwB,WAAY,UAAZ,CAAlC;AACA,MAAK,GAAL,CAAU,KAAK,MAAL,CAAa,WAAb,IAA6B,WAAY,eAAZ,CAAvC;AACA,MAAK,GAAL,CAAU,KAAK,MAAL,CAAa,QAAb,IAA0B,WAAY,YAAZ,CAApC;AACA,MAAK,GAAL,CAAU,KAAK,MAAL,CAAa,OAAb,IAAyB,WAAY,WAAZ,CAAnC;AACA,MAAK,GAAL,CAAU,KAAK,MAAL,CAAa,WAAb,IAA6B,WAAY,eAAZ,CAAvC;AACA,MAAK,GAAL,CAAU,KAAK,MAAL,CAAa,QAAb,IAA0B,WAAY,YAAZ,CAApC;AACA,MAAK,GAAL,CAAU,KAAK,MAAL,CAAa,OAAb,IAAyB,WAAY,WAAZ,CAAnC;;AAEA;;AAEA,MAAK,MAAL,CAAa,WAAb,EAA2B,OAA3B,GAAqC,KAArC;AACA,MAAK,MAAL,CAAa,QAAb,EAAwB,OAAxB,GAAkC,KAAlC;AACA,MAAK,MAAL,CAAa,OAAb,EAAuB,OAAvB,GAAiC,KAAjC;;AAEA;;AAEA,MAAK,iBAAL,GAAyB,YAAY;;AAEpC,MAAI,QAAQ,KAAK,KAAjB;;AAEA,MAAK,KAAK,IAAL,KAAc,OAAnB,EAA6B,QAAQ,OAAR,CAJO,CAIU;;AAE9C,MAAI,aAAa,UAAU,OAAV,GAAoB,KAAK,eAAzB,GAA2C,kBAA5D;;AAEA;;AAEA,OAAK,KAAL,CAAY,WAAZ,EAA0B,OAA1B,GAAoC,KAAK,IAAL,KAAc,WAAlD;AACA,OAAK,KAAL,CAAY,QAAZ,EAAuB,OAAvB,GAAiC,KAAK,IAAL,KAAc,QAA/C;AACA,OAAK,KAAL,CAAY,OAAZ,EAAsB,OAAtB,GAAgC,KAAK,IAAL,KAAc,OAA9C;;AAEA,OAAK,MAAL,CAAa,WAAb,EAA2B,OAA3B,GAAqC,KAAK,IAAL,KAAc,WAAnD;AACA,OAAK,MAAL,CAAa,QAAb,EAAwB,OAAxB,GAAkC,KAAK,IAAL,KAAc,QAAhD;AACA,OAAK,MAAL,CAAa,OAAb,EAAuB,OAAvB,GAAiC,KAAK,IAAL,KAAc,OAA/C;;AAGA,MAAI,UAAU,EAAd;AACA,YAAU,QAAQ,MAAR,CAAgB,KAAK,MAAL,CAAa,KAAK,IAAlB,EAAyB,QAAzC,CAAV;AACA,YAAU,QAAQ,MAAR,CAAgB,KAAK,KAAL,CAAY,KAAK,IAAjB,EAAwB,QAAxC,CAAV;AACA,YAAU,QAAQ,MAAR,CAAgB,KAAK,MAAL,CAAa,KAAK,IAAlB,EAAyB,QAAzC,CAAV;;AAEA,OAAM,IAAI,IAAI,CAAd,EAAiB,IAAI,QAAQ,MAA7B,EAAqC,GAArC,EAA4C;;AAE3C,OAAI,SAAS,QAAS,CAAT,CAAb;;AAEA;;AAEA,UAAO,OAAP,GAAiB,IAAjB;AACA,UAAO,QAAP,CAAgB,GAAhB,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B;AACA,UAAO,QAAP,CAAgB,IAAhB,CAAsB,KAAK,aAA3B;;AAEA,OAAI,MAAJ;;AAEA,OAAK,KAAK,MAAL,CAAY,oBAAjB,EAAwC;;AAEvC,aAAS,CAAE,KAAK,MAAL,CAAY,GAAZ,GAAkB,KAAK,MAAL,CAAY,MAAhC,IAA2C,KAAK,MAAL,CAAY,IAAhE;AAEA,IAJD,MAIO;;AAEN,aAAS,KAAK,aAAL,CAAmB,UAAnB,CAA+B,KAAK,cAApC,IAAuD,KAAK,GAAL,CAAU,MAAM,KAAK,GAAL,CAAU,KAAK,EAAL,GAAU,KAAK,MAAL,CAAY,GAAtB,GAA4B,GAAtC,CAAN,GAAoD,KAAK,MAAL,CAAY,IAA1E,EAAgF,CAAhF,CAAhE;AAEA;;AAED,UAAO,KAAP,CAAa,GAAb,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,EAA4B,cAA5B,CAA4C,SAAS,KAAK,IAAd,GAAqB,CAAjE;;AAEA;;AAEA,OAAK,OAAO,GAAP,KAAe,QAApB,EAA+B;;AAE9B,WAAO,OAAP,GAAiB,KAAjB;;AAEA,QAAK,OAAO,IAAP,KAAgB,MAArB,EAA8B;;AAE7B,YAAO,QAAP,CAAgB,IAAhB,CAAsB,KAAK,kBAA3B;AACA,YAAO,OAAP,GAAiB,CAAC,CAAE,KAAK,IAAzB;;AAEA,SAAK,KAAK,IAAL,KAAc,GAAnB,EAAyB;;AAExB,qBAAe,YAAf,CAA6B,UAAU,GAAV,CAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB,CAA7B;AACA,aAAO,UAAP,CAAkB,IAAlB,CAAwB,UAAxB,EAAqC,QAArC,CAA+C,cAA/C;;AAEA,UAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,GAA3F,EAAiG;;AAEhG,cAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,SAAK,KAAK,IAAL,KAAc,GAAnB,EAAyB;;AAExB,qBAAe,YAAf,CAA6B,UAAU,GAAV,CAAe,CAAf,EAAkB,CAAlB,EAAqB,KAAK,EAAL,GAAU,CAA/B,CAA7B;AACA,aAAO,UAAP,CAAkB,IAAlB,CAAwB,UAAxB,EAAqC,QAArC,CAA+C,cAA/C;;AAEA,UAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,GAA3F,EAAiG;;AAEhG,cAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,SAAK,KAAK,IAAL,KAAc,GAAnB,EAAyB;;AAExB,qBAAe,YAAf,CAA6B,UAAU,GAAV,CAAe,CAAf,EAAkB,KAAK,EAAL,GAAU,CAA5B,EAA+B,CAA/B,CAA7B;AACA,aAAO,UAAP,CAAkB,IAAlB,CAAwB,UAAxB,EAAqC,QAArC,CAA+C,cAA/C;;AAEA,UAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,GAA3F,EAAiG;;AAEhG,cAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,SAAK,KAAK,IAAL,KAAc,MAAnB,EAA4B;;AAE3B,qBAAe,YAAf,CAA6B,UAAU,GAAV,CAAe,CAAf,EAAkB,KAAK,EAAL,GAAU,CAA5B,EAA+B,CAA/B,CAA7B;AACA,kBAAY,IAAZ,CAAkB,KAAK,YAAvB;AACA,aAAO,UAAP,CAAkB,qBAAlB,CAAyC,aAAa,MAAb,CAAqB,UAArB,EAAiC,WAAjC,EAA8C,KAA9C,CAAzC;AACA,aAAO,UAAP,CAAkB,QAAlB,CAA4B,cAA5B;AACA,aAAO,OAAP,GAAiB,KAAK,QAAtB;AAEA;;AAED,SAAK,KAAK,IAAL,KAAc,GAAnB,EAAyB;;AAExB,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAGD,KA7DD,MA6DO,IAAK,OAAO,IAAP,KAAgB,OAArB,EAA+B;;AAErC,YAAO,QAAP,CAAgB,IAAhB,CAAsB,KAAK,kBAA3B;AACA,YAAO,OAAP,GAAiB,KAAK,QAAtB;AAEA,KALM,MAKA,IAAK,OAAO,IAAP,KAAgB,KAArB,EAA6B;;AAEnC,YAAO,QAAP,CAAgB,IAAhB,CAAsB,KAAK,aAA3B;AACA,YAAO,OAAP,GAAiB,KAAK,QAAtB;AAEA,KALM,MAKA,IAAK,OAAO,IAAP,KAAgB,OAArB,EAA+B;;AAErC,YAAO,QAAP,CAAgB,IAAhB,CAAsB,KAAK,kBAA3B;AACA,YAAO,UAAP,CAAkB,IAAlB,CAAwB,KAAK,oBAA7B;AACA,gBAAW,GAAX,CAAgB,KAAhB,EAAuB,KAAvB,EAA8B,KAA9B,EAAsC,GAAtC,CAA2C,KAAK,kBAAhD,EAAqE,GAArE,CAA0E,KAAK,aAA/E,EAA+F,cAA/F,CAA+G,CAAE,CAAjH;AACA,gBAAW,eAAX,CAA4B,KAAK,oBAAL,CAA0B,KAA1B,GAAkC,OAAlC,EAA5B;AACA,YAAO,KAAP,CAAa,IAAb,CAAmB,UAAnB;AACA,YAAO,OAAP,GAAiB,KAAK,QAAtB;AAEA,KATM,MASA;;AAEN,YAAO,UAAP,CAAkB,IAAlB,CAAwB,UAAxB;;AAEA,SAAK,KAAK,QAAV,EAAqB;;AAEpB,aAAO,QAAP,CAAgB,IAAhB,CAAsB,KAAK,kBAA3B;AAEA,MAJD,MAIO;;AAEN,aAAO,QAAP,CAAgB,IAAhB,CAAsB,KAAK,aAA3B;AAEA;;AAED,SAAK,KAAK,IAAV,EAAiB;;AAEhB,aAAO,OAAP,GAAiB,KAAK,IAAL,CAAU,MAAV,CAAkB,OAAO,IAAzB,MAAoC,CAAE,CAAvD;AAEA;AAED;;AAED;AACA;AAEA;;AAED;;AAEA,UAAO,UAAP,CAAkB,IAAlB,CAAwB,UAAxB;;AAEA,OAAK,KAAK,IAAL,KAAc,WAAd,IAA6B,KAAK,IAAL,KAAc,OAAhD,EAA0D;;AAEzD;;AAEA,QAAI,qBAAqB,IAAzB;AACA,QAAI,sBAAsB,GAA1B;AACA,QAAI,qBAAqB,GAAzB;;AAGA,QAAK,OAAO,IAAP,KAAgB,GAAhB,IAAuB,OAAO,IAAP,KAAgB,MAA5C,EAAqD;;AAEpD,SAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,kBAA3F,EAAgH;;AAE/G,aAAO,KAAP,CAAa,GAAb,CAAkB,KAAlB,EAAyB,KAAzB,EAAgC,KAAhC;AACA,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,QAAK,OAAO,IAAP,KAAgB,GAAhB,IAAuB,OAAO,IAAP,KAAgB,MAA5C,EAAqD;;AAEpD,SAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,kBAA3F,EAAgH;;AAE/G,aAAO,KAAP,CAAa,GAAb,CAAkB,KAAlB,EAAyB,KAAzB,EAAgC,KAAhC;AACA,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,QAAK,OAAO,IAAP,KAAgB,GAAhB,IAAuB,OAAO,IAAP,KAAgB,MAA5C,EAAqD;;AAEpD,SAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,kBAA3F,EAAgH;;AAE/G,aAAO,KAAP,CAAa,GAAb,CAAkB,KAAlB,EAAyB,KAAzB,EAAgC,KAAhC;AACA,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,QAAK,OAAO,IAAP,KAAgB,IAArB,EAA4B;;AAE3B,SAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,mBAA3F,EAAiH;;AAEhH,aAAO,KAAP,CAAa,GAAb,CAAkB,KAAlB,EAAyB,KAAzB,EAAgC,KAAhC;AACA,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,QAAK,OAAO,IAAP,KAAgB,IAArB,EAA4B;;AAE3B,SAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,mBAA3F,EAAiH;;AAEhH,aAAO,KAAP,CAAa,GAAb,CAAkB,KAAlB,EAAyB,KAAzB,EAAgC,KAAhC;AACA,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,QAAK,OAAO,IAAP,KAAgB,IAArB,EAA4B;;AAE3B,SAAK,KAAK,GAAL,CAAU,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,CAAV,IAAsF,mBAA3F,EAAiH;;AAEhH,aAAO,KAAP,CAAa,GAAb,CAAkB,KAAlB,EAAyB,KAAzB,EAAgC,KAAhC;AACA,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED;;AAEA,QAAK,OAAO,IAAP,CAAY,MAAZ,CAAoB,GAApB,MAA8B,CAAE,CAArC,EAAyC;;AAExC,SAAK,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,IAA0E,kBAA/E,EAAoG;;AAEnG,UAAK,OAAO,GAAP,KAAe,KAApB,EAA4B;;AAE3B,cAAO,OAAP,GAAiB,KAAjB;AAEA,OAJD,MAIO;;AAEN,cAAO,KAAP,CAAa,CAAb,IAAkB,CAAE,CAApB;AAEA;AAED,MAZD,MAYO,IAAK,OAAO,GAAP,KAAe,KAApB,EAA4B;;AAElC,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,QAAK,OAAO,IAAP,CAAY,MAAZ,CAAoB,GAApB,MAA8B,CAAE,CAArC,EAAyC;;AAExC,SAAK,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,IAA0E,kBAA/E,EAAoG;;AAEnG,UAAK,OAAO,GAAP,KAAe,KAApB,EAA4B;;AAE3B,cAAO,OAAP,GAAiB,KAAjB;AAEA,OAJD,MAIO;;AAEN,cAAO,KAAP,CAAa,CAAb,IAAkB,CAAE,CAApB;AAEA;AAED,MAZD,MAYO,IAAK,OAAO,GAAP,KAAe,KAApB,EAA4B;;AAElC,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;;AAED,QAAK,OAAO,IAAP,CAAY,MAAZ,CAAoB,GAApB,MAA8B,CAAE,CAArC,EAAyC;;AAExC,SAAK,YAAY,IAAZ,CAAkB,KAAlB,EAA0B,eAA1B,CAA2C,UAA3C,EAAwD,GAAxD,CAA6D,KAAK,GAAlE,IAA0E,kBAA/E,EAAoG;;AAEnG,UAAK,OAAO,GAAP,KAAe,KAApB,EAA4B;;AAE3B,cAAO,OAAP,GAAiB,KAAjB;AAEA,OAJD,MAIO;;AAEN,cAAO,KAAP,CAAa,CAAb,IAAkB,CAAE,CAApB;AAEA;AAED,MAZD,MAYO,IAAK,OAAO,GAAP,KAAe,KAApB,EAA4B;;AAElC,aAAO,OAAP,GAAiB,KAAjB;AAEA;AAED;AAED,IA/ID,MA+IO,IAAK,KAAK,IAAL,KAAc,QAAnB,EAA8B;;AAEpC;;AAEA,oBAAgB,IAAhB,CAAsB,UAAtB;AACA,gBAAY,IAAZ,CAAkB,KAAK,GAAvB,EAA6B,eAA7B,CAA8C,eAAe,IAAf,CAAqB,UAArB,EAAkC,OAAlC,EAA9C;;AAEA,QAAK,OAAO,IAAP,CAAY,MAAZ,CAAoB,GAApB,MAA8B,CAAE,CAArC,EAAyC;;AAExC,YAAO,UAAP,CAAkB,qBAAlB,CAAyC,aAAa,MAAb,CAAqB,KAAK,GAA1B,EAA+B,UAA/B,EAA2C,KAA3C,CAAzC;AAEA;;AAED,QAAK,OAAO,IAAP,KAAgB,GAArB,EAA2B;;AAE1B,oBAAe,gBAAf,CAAiC,KAAjC,EAAwC,KAAK,KAAL,CAAY,CAAE,YAAY,CAA1B,EAA6B,YAAY,CAAzC,CAAxC;AACA,oBAAe,mBAAf,CAAoC,eAApC,EAAqD,cAArD;AACA,YAAO,UAAP,CAAkB,IAAlB,CAAwB,cAAxB;AAEA;;AAED,QAAK,OAAO,IAAP,KAAgB,GAArB,EAA2B;;AAE1B,oBAAe,gBAAf,CAAiC,KAAjC,EAAwC,KAAK,KAAL,CAAY,YAAY,CAAxB,EAA2B,YAAY,CAAvC,CAAxC;AACA,oBAAe,mBAAf,CAAoC,eAApC,EAAqD,cAArD;AACA,YAAO,UAAP,CAAkB,IAAlB,CAAwB,cAAxB;AAEA;;AAED,QAAK,OAAO,IAAP,KAAgB,GAArB,EAA2B;;AAE1B,oBAAe,gBAAf,CAAiC,KAAjC,EAAwC,KAAK,KAAL,CAAY,YAAY,CAAxB,EAA2B,YAAY,CAAvC,CAAxC;AACA,oBAAe,mBAAf,CAAoC,eAApC,EAAqD,cAArD;AACA,YAAO,UAAP,CAAkB,IAAlB,CAAwB,cAAxB;AAEA;AAED;;AAED;AACA,UAAO,OAAP,GAAiB,OAAO,OAAP,KAAoB,OAAO,IAAP,CAAY,OAAZ,CAAqB,GAArB,MAA+B,CAAE,CAAjC,IAAsC,KAAK,KAA/D,CAAjB;AACA,UAAO,OAAP,GAAiB,OAAO,OAAP,KAAoB,OAAO,IAAP,CAAY,OAAZ,CAAqB,GAArB,MAA+B,CAAE,CAAjC,IAAsC,KAAK,KAA/D,CAAjB;AACA,UAAO,OAAP,GAAiB,OAAO,OAAP,KAAoB,OAAO,IAAP,CAAY,OAAZ,CAAqB,GAArB,MAA+B,CAAE,CAAjC,IAAsC,KAAK,KAA/D,CAAjB;AACA,UAAO,OAAP,GAAiB,OAAO,OAAP,KAAoB,OAAO,IAAP,CAAY,OAAZ,CAAqB,GAArB,MAA+B,CAAE,CAAjC,IAAwC,KAAK,KAAL,IAAc,KAAK,KAAnB,IAA4B,KAAK,KAA7F,CAAjB;;AAEA;;AAEA,UAAO,QAAP,CAAgB,QAAhB,GAA2B,OAAO,QAAP,CAAgB,QAAhB,IAA4B,OAAO,QAAP,CAAgB,OAAvE;AACA,UAAO,QAAP,CAAgB,MAAhB,GAAyB,OAAO,QAAP,CAAgB,MAAhB,IAA0B,OAAO,QAAP,CAAgB,KAAhB,CAAsB,KAAtB,EAAnD;;AAEA,UAAO,QAAP,CAAgB,KAAhB,CAAsB,IAAtB,CAA4B,OAAO,QAAP,CAAgB,MAA5C;AACA,UAAO,QAAP,CAAgB,OAAhB,GAA0B,OAAO,QAAP,CAAgB,QAA1C;;AAEA,OAAK,CAAE,KAAK,OAAZ,EAAsB;;AAErB,WAAO,QAAP,CAAgB,OAAhB,IAA2B,GAA3B;AACA,WAAO,QAAP,CAAgB,KAAhB,CAAsB,IAAtB,CAA4B,IAAI,MAAM,KAAV,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,CAA5B,EAAwD,GAAxD;AAEA,IALD,MAKO,IAAK,KAAK,IAAV,EAAiB;;AAEvB,QAAK,OAAO,IAAP,KAAgB,KAAK,IAA1B,EAAiC;;AAEhC,YAAO,QAAP,CAAgB,OAAhB,GAA0B,GAA1B;AACA,YAAO,QAAP,CAAgB,KAAhB,CAAsB,IAAtB,CAA4B,IAAI,MAAM,KAAV,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,CAA5B,EAAwD,GAAxD;AAEA,KALD,MAKO,IAAK,KAAK,IAAL,CAAU,KAAV,CAAiB,EAAjB,EAAsB,IAAtB,CAA4B,UAAW,CAAX,EAAe;;AAEtD,YAAO,OAAO,IAAP,KAAgB,CAAvB;AAEA,KAJW,CAAL,EAID;;AAEL,YAAO,QAAP,CAAgB,OAAhB,GAA0B,GAA1B;AACA,YAAO,QAAP,CAAgB,KAAhB,CAAsB,IAAtB,CAA4B,IAAI,MAAM,KAAV,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,CAA5B,EAAwD,GAAxD;AAEA,KATM,MASA;;AAEN,YAAO,QAAP,CAAgB,OAAhB,IAA2B,IAA3B;AACA,YAAO,QAAP,CAAgB,KAAhB,CAAsB,IAAtB,CAA4B,IAAI,MAAM,KAAV,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,CAA5B,EAAwD,GAAxD;AAEA;AAED;AAED;;AAED,QAAM,QAAN,CAAe,SAAf,CAAyB,iBAAzB,CAA2C,IAA3C,CAAiD,IAAjD;AAEA,EA3YD;AA6YA,CA9zBD;;AAg0BA,MAAM,sBAAN,CAA6B,SAA7B,GAAyC,OAAO,MAAP,CAAe,OAAO,MAAP,CAAe,MAAM,QAAN,CAAe,SAA9B,CAAf,EAA0D;;AAElG,cAAa,MAAM,sBAF+E;;AAIlG,2BAA0B;;AAJwE,CAA1D,CAAzC;;AASA,MAAM,sBAAN,GAA+B,YAAY;;AAE1C;;AAEA,OAAM,IAAN,CAAW,IAAX,CAAiB,IAAjB,EACC,IAAI,MAAM,mBAAV,CAA+B,MAA/B,EAAuC,MAAvC,EAA+C,CAA/C,EAAkD,CAAlD,CADD,EAEC,IAAI,MAAM,iBAAV,CAA6B,EAAE,SAAS,KAAX,EAAkB,WAAW,IAA7B,EAAmC,MAAM,MAAM,UAA/C,EAA2D,aAAa,IAAxE,EAA8E,SAAS,GAAvF,EAA4F,YAAY,KAAxG,EAA7B,CAFD;;AAKA,MAAK,IAAL,GAAY,wBAAZ;;AAEA,KAAI,QAAQ,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAZ;AACA,KAAI,QAAQ,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAZ;AACA,KAAI,QAAQ,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAZ;;AAEA,KAAI,aAAa,IAAI,MAAM,OAAV,EAAjB;AACA,KAAI,YAAY,IAAI,MAAM,OAAV,EAAhB;AACA,KAAI,cAAc,IAAI,MAAM,OAAV,EAAlB;AACA,KAAI,aAAa,IAAI,MAAM,OAAV,EAAjB;AACA,KAAI,qBAAqB,IAAI,MAAM,UAAV,EAAzB;;AAEA,MAAK,iBAAL,GAAyB,YAAY;;AAEpC,MAAI,QAAQ,KAAK,KAAjB;;AAEA,OAAK,QAAL,CAAc,IAAd,CAAoB,KAAK,aAAzB;;AAEA,MAAK,KAAK,IAAL,KAAc,OAAnB,EAA6B,QAAQ,OAAR,CANO,CAMU;;AAE9C,QAAM,GAAN,CAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAqB,eAArB,CAAsC,UAAU,OAAV,GAAoB,KAAK,eAAzB,GAA2C,kBAAjF;AACA,QAAM,GAAN,CAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAqB,eAArB,CAAsC,UAAU,OAAV,GAAoB,KAAK,eAAzB,GAA2C,kBAAjF;AACA,QAAM,GAAN,CAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAqB,eAArB,CAAsC,UAAU,OAAV,GAAoB,KAAK,eAAzB,GAA2C,kBAAjF;;AAEA;;AAEA,cAAY,IAAZ,CAAkB,KAAlB;;AAEA,UAAS,KAAK,IAAd;;AAEC,QAAK,WAAL;AACA,QAAK,OAAL;AACC,YAAS,KAAK,IAAd;;AAEC,UAAK,GAAL;AACC,kBAAY,IAAZ,CAAkB,KAAK,GAAvB,EAA6B,KAA7B,CAAoC,KAApC;AACA,gBAAU,IAAV,CAAgB,KAAhB,EAAwB,KAAxB,CAA+B,WAA/B;AACA;AACD,UAAK,GAAL;AACC,kBAAY,IAAZ,CAAkB,KAAK,GAAvB,EAA6B,KAA7B,CAAoC,KAApC;AACA,gBAAU,IAAV,CAAgB,KAAhB,EAAwB,KAAxB,CAA+B,WAA/B;AACA;AACD,UAAK,GAAL;AACC,kBAAY,IAAZ,CAAkB,KAAK,GAAvB,EAA6B,KAA7B,CAAoC,KAApC;AACA,gBAAU,IAAV,CAAgB,KAAhB,EAAwB,KAAxB,CAA+B,WAA/B;AACA;AACD,UAAK,IAAL;AACC,gBAAU,IAAV,CAAgB,KAAhB;AACA;AACD,UAAK,IAAL;AACC,gBAAU,IAAV,CAAgB,KAAhB;AACA;AACD,UAAK,IAAL;AACC,kBAAY,IAAZ,CAAkB,KAAlB;AACA,gBAAU,IAAV,CAAgB,KAAhB;AACA;AACD,UAAK,KAAL;AACA,UAAK,GAAL;AACC,gBAAU,GAAV,CAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB;AACA;;AA3BF;;AA+BA;AACD,QAAK,QAAL;AACA;AACC;AACA,cAAU,GAAV,CAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB;;AAvCF;;AA2CA,MAAK,UAAU,MAAV,OAAuB,CAA5B,EAAgC;;AAE/B;AACA,QAAK,UAAL,CAAgB,IAAhB,CAAsB,KAAK,gBAA3B;AAEA,GALD,MAKO;;AAEN,cAAW,MAAX,CAAmB,WAAW,GAAX,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,CAAnB,EAA8C,SAA9C,EAAyD,WAAzD;;AAEA,QAAK,UAAL,CAAgB,qBAAhB,CAAuC,UAAvC;AAEA;;AAED,QAAM,QAAN,CAAe,SAAf,CAAyB,iBAAzB,CAA2C,IAA3C,CAAiD,IAAjD;AAEA,EA1ED;AA4EA,CAjGD;;AAmGA,MAAM,sBAAN,CAA6B,SAA7B,GAAyC,OAAO,MAAP,CAAe,OAAO,MAAP,CAAe,MAAM,IAAN,CAAW,SAA1B,CAAf,EAAsD;;AAE9F,cAAa,MAAM,sBAF2E;;AAI9F,2BAA0B;;AAJoE,CAAtD,CAAzC","file":"TransformControls-compiled.js","sourcesContent":["console.warn( \"THREE.TransformControls: As part of the transition to ES6 Modules, the files in 'examples/js' were deprecated in May 2020 (r117) and will be deleted in December 2020 (r124). You can find more information about developing using ES6 Modules in https://threejs.org/docs/#manual/en/introduction/Installation.\" );\n\nTHREE.TransformControls = function ( camera, domElement ) {\n\n\tif ( domElement === undefined ) {\n\n\t\tconsole.warn( 'THREE.TransformControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tdomElement = document;\n\n\t}\n\n\tTHREE.Object3D.call( this );\n\n\tthis.visible = false;\n\tthis.domElement = domElement;\n\n\tvar _gizmo = new THREE.TransformControlsGizmo();\n\tthis.add( _gizmo );\n\n\tvar _plane = new THREE.TransformControlsPlane();\n\tthis.add( _plane );\n\n\tvar scope = this;\n\n\t// Define properties with getters/setter\n\t// Setting the defined property will automatically trigger change event\n\t// Defined properties are passed down to gizmo and plane\n\n\tdefineProperty( \"camera\", camera );\n\tdefineProperty( \"object\", undefined );\n\tdefineProperty( \"enabled\", true );\n\tdefineProperty( \"axis\", null );\n\tdefineProperty( \"mode\", \"translate\" );\n\tdefineProperty( \"translationSnap\", null );\n\tdefineProperty( \"rotationSnap\", null );\n\tdefineProperty( \"scaleSnap\", null );\n\tdefineProperty( \"space\", \"world\" );\n\tdefineProperty( \"size\", 1 );\n\tdefineProperty( \"dragging\", false );\n\tdefineProperty( \"showX\", true );\n\tdefineProperty( \"showY\", true );\n\tdefineProperty( \"showZ\", true );\n\n\tvar changeEvent = { type: \"change\" };\n\tvar mouseDownEvent = { type: \"mouseDown\" };\n\tvar mouseUpEvent = { type: \"mouseUp\", mode: scope.mode };\n\tvar objectChangeEvent = { type: \"objectChange\" };\n\n\t// Reusable utility variables\n\n\tvar raycaster = new THREE.Raycaster();\n\n\tfunction intersectObjectWithRay( object, raycaster, includeInvisible ) {\n\n\t\tvar allIntersections = raycaster.intersectObject( object, true );\n\n\t\tfor ( var i = 0; i < allIntersections.length; i ++ ) {\n\n\t\t\tif ( allIntersections[ i ].object.visible || includeInvisible ) {\n\n\t\t\t\treturn allIntersections[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tvar _tempVector = new THREE.Vector3();\n\tvar _tempVector2 = new THREE.Vector3();\n\tvar _tempQuaternion = new THREE.Quaternion();\n\tvar _unit = {\n\t\tX: new THREE.Vector3( 1, 0, 0 ),\n\t\tY: new THREE.Vector3( 0, 1, 0 ),\n\t\tZ: new THREE.Vector3( 0, 0, 1 )\n\t};\n\n\tvar pointStart = new THREE.Vector3();\n\tvar pointEnd = new THREE.Vector3();\n\tvar offset = new THREE.Vector3();\n\tvar rotationAxis = new THREE.Vector3();\n\tvar startNorm = new THREE.Vector3();\n\tvar endNorm = new THREE.Vector3();\n\tvar rotationAngle = 0;\n\n\tvar cameraPosition = new THREE.Vector3();\n\tvar cameraQuaternion = new THREE.Quaternion();\n\tvar cameraScale = new THREE.Vector3();\n\n\tvar parentPosition = new THREE.Vector3();\n\tvar parentQuaternion = new THREE.Quaternion();\n\tvar parentQuaternionInv = new THREE.Quaternion();\n\tvar parentScale = new THREE.Vector3();\n\n\tvar worldPositionStart = new THREE.Vector3();\n\tvar worldQuaternionStart = new THREE.Quaternion();\n\tvar worldScaleStart = new THREE.Vector3();\n\n\tvar worldPosition = new THREE.Vector3();\n\tvar worldQuaternion = new THREE.Quaternion();\n\tvar worldQuaternionInv = new THREE.Quaternion();\n\tvar worldScale = new THREE.Vector3();\n\n\tvar eye = new THREE.Vector3();\n\n\tvar positionStart = new THREE.Vector3();\n\tvar quaternionStart = new THREE.Quaternion();\n\tvar scaleStart = new THREE.Vector3();\n\n\t// TODO: remove properties unused in plane and gizmo\n\n\tdefineProperty( \"worldPosition\", worldPosition );\n\tdefineProperty( \"worldPositionStart\", worldPositionStart );\n\tdefineProperty( \"worldQuaternion\", worldQuaternion );\n\tdefineProperty( \"worldQuaternionStart\", worldQuaternionStart );\n\tdefineProperty( \"cameraPosition\", cameraPosition );\n\tdefineProperty( \"cameraQuaternion\", cameraQuaternion );\n\tdefineProperty( \"pointStart\", pointStart );\n\tdefineProperty( \"pointEnd\", pointEnd );\n\tdefineProperty( \"rotationAxis\", rotationAxis );\n\tdefineProperty( \"rotationAngle\", rotationAngle );\n\tdefineProperty( \"eye\", eye );\n\n\t{\n\n\t\tdomElement.addEventListener( \"pointerdown\", onPointerDown, false );\n\t\tdomElement.addEventListener( \"pointermove\", onPointerHover, false );\n\t\tscope.domElement.ownerDocument.addEventListener( \"pointerup\", onPointerUp, false );\n\n\t}\n\n\tthis.dispose = function () {\n\n\t\tdomElement.removeEventListener( \"pointerdown\", onPointerDown );\n\t\tdomElement.removeEventListener( \"pointermove\", onPointerHover );\n\t\tscope.domElement.ownerDocument.removeEventListener( \"pointermove\", onPointerMove );\n\t\tscope.domElement.ownerDocument.removeEventListener( \"pointerup\", onPointerUp );\n\n\t\tthis.traverse( function ( child ) {\n\n\t\t\tif ( child.geometry ) child.geometry.dispose();\n\t\t\tif ( child.material ) child.material.dispose();\n\n\t\t} );\n\n\t};\n\n\t// Set current object\n\tthis.attach = function ( object ) {\n\n\t\tthis.object = object;\n\t\tthis.visible = true;\n\n\t\treturn this;\n\n\t};\n\n\t// Detatch from object\n\tthis.detach = function () {\n\n\t\tthis.object = undefined;\n\t\tthis.visible = false;\n\t\tthis.axis = null;\n\n\t\treturn this;\n\n\t};\n\n\t// Defined getter, setter and store for a property\n\tfunction defineProperty( propName, defaultValue ) {\n\n\t\tvar propValue = defaultValue;\n\n\t\tObject.defineProperty( scope, propName, {\n\n\t\t\tget: function () {\n\n\t\t\t\treturn propValue !== undefined ? propValue : defaultValue;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tif ( propValue !== value ) {\n\n\t\t\t\t\tpropValue = value;\n\t\t\t\t\t_plane[ propName ] = value;\n\t\t\t\t\t_gizmo[ propName ] = value;\n\n\t\t\t\t\tscope.dispatchEvent( { type: propName + \"-changed\", value: value } );\n\t\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\tscope[ propName ] = defaultValue;\n\t\t_plane[ propName ] = defaultValue;\n\t\t_gizmo[ propName ] = defaultValue;\n\n\t}\n\n\t// updateMatrixWorld  updates key transformation variables\n\tthis.updateMatrixWorld = function () {\n\n\t\tif ( this.object !== undefined ) {\n\n\t\t\tthis.object.updateMatrixWorld();\n\n\t\t\tif ( this.object.parent === null ) {\n\n\t\t\t\tconsole.error( 'TransformControls: The attached 3D object must be a part of the scene graph.' );\n\n\t\t\t} else {\n\n\t\t\t\tthis.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\n\n\t\t\t}\n\n\t\t\tthis.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\n\n\t\t\tparentQuaternionInv.copy( parentQuaternion ).inverse();\n\t\t\tworldQuaternionInv.copy( worldQuaternion ).inverse();\n\n\t\t}\n\n\t\tthis.camera.updateMatrixWorld();\n\t\tthis.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\n\n\t\teye.copy( cameraPosition ).sub( worldPosition ).normalize();\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n\tthis.pointerHover = function ( pointer ) {\n\n\t\tif ( this.object === undefined || this.dragging === true ) return;\n\n\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\tvar intersect = intersectObjectWithRay( _gizmo.picker[ this.mode ], raycaster );\n\n\t\tif ( intersect ) {\n\n\t\t\tthis.axis = intersect.object.name;\n\n\t\t} else {\n\n\t\t\tthis.axis = null;\n\n\t\t}\n\n\t};\n\n\tthis.pointerDown = function ( pointer ) {\n\n\t\tif ( this.object === undefined || this.dragging === true || pointer.button !== 0 ) return;\n\n\t\tif ( this.axis !== null ) {\n\n\t\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\t\tvar planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\n\n\t\t\tif ( planeIntersect ) {\n\n\t\t\t\tvar space = this.space;\n\n\t\t\t\tif ( this.mode === 'scale' ) {\n\n\t\t\t\t\tspace = 'local';\n\n\t\t\t\t} else if ( this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ' ) {\n\n\t\t\t\t\tspace = 'world';\n\n\t\t\t\t}\n\n\t\t\t\tif ( space === 'local' && this.mode === 'rotate' ) {\n\n\t\t\t\t\tvar snap = this.rotationSnap;\n\n\t\t\t\t\tif ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\n\t\t\t\t\tif ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\n\t\t\t\t\tif ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\n\n\t\t\t\t}\n\n\t\t\t\tthis.object.updateMatrixWorld();\n\t\t\t\tthis.object.parent.updateMatrixWorld();\n\n\t\t\t\tpositionStart.copy( this.object.position );\n\t\t\t\tquaternionStart.copy( this.object.quaternion );\n\t\t\t\tscaleStart.copy( this.object.scale );\n\n\t\t\t\tthis.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\n\n\t\t\t\tpointStart.copy( planeIntersect.point ).sub( worldPositionStart );\n\n\t\t\t}\n\n\t\t\tthis.dragging = true;\n\t\t\tmouseDownEvent.mode = this.mode;\n\t\t\tthis.dispatchEvent( mouseDownEvent );\n\n\t\t}\n\n\t};\n\n\tthis.pointerMove = function ( pointer ) {\n\n\t\tvar axis = this.axis;\n\t\tvar mode = this.mode;\n\t\tvar object = this.object;\n\t\tvar space = this.space;\n\n\t\tif ( mode === 'scale' ) {\n\n\t\t\tspace = 'local';\n\n\t\t} else if ( axis === 'E' || axis === 'XYZE' || axis === 'XYZ' ) {\n\n\t\t\tspace = 'world';\n\n\t\t}\n\n\t\tif ( object === undefined || axis === null || this.dragging === false || pointer.button !== - 1 ) return;\n\n\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\tvar planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\n\n\t\tif ( ! planeIntersect ) return;\n\n\t\tpointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\n\n\t\tif ( mode === 'translate' ) {\n\n\t\t\t// Apply translate\n\n\t\t\toffset.copy( pointEnd ).sub( pointStart );\n\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\n\n\t\t\t\toffset.applyQuaternion( worldQuaternionInv );\n\n\t\t\t}\n\n\t\t\tif ( axis.indexOf( 'X' ) === - 1 ) offset.x = 0;\n\t\t\tif ( axis.indexOf( 'Y' ) === - 1 ) offset.y = 0;\n\t\t\tif ( axis.indexOf( 'Z' ) === - 1 ) offset.z = 0;\n\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\n\n\t\t\t\toffset.applyQuaternion( quaternionStart ).divide( parentScale );\n\n\t\t\t} else {\n\n\t\t\t\toffset.applyQuaternion( parentQuaternionInv ).divide( parentScale );\n\n\t\t\t}\n\n\t\t\tobject.position.copy( offset ).add( positionStart );\n\n\t\t\t// Apply translation snap\n\n\t\t\tif ( this.translationSnap ) {\n\n\t\t\t\tif ( space === 'local' ) {\n\n\t\t\t\t\tobject.position.applyQuaternion( _tempQuaternion.copy( quaternionStart ).inverse() );\n\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobject.position.applyQuaternion( quaternionStart );\n\n\t\t\t\t}\n\n\t\t\t\tif ( space === 'world' ) {\n\n\t\t\t\t\tif ( object.parent ) {\n\n\t\t\t\t\t\tobject.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( object.parent ) {\n\n\t\t\t\t\t\tobject.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( mode === 'scale' ) {\n\n\t\t\tif ( axis.search( 'XYZ' ) !== - 1 ) {\n\n\t\t\t\tvar d = pointEnd.length() / pointStart.length();\n\n\t\t\t\tif ( pointEnd.dot( pointStart ) < 0 ) d *= - 1;\n\n\t\t\t\t_tempVector2.set( d, d, d );\n\n\t\t\t} else {\n\n\t\t\t\t_tempVector.copy( pointStart );\n\t\t\t\t_tempVector2.copy( pointEnd );\n\n\t\t\t\t_tempVector.applyQuaternion( worldQuaternionInv );\n\t\t\t\t_tempVector2.applyQuaternion( worldQuaternionInv );\n\n\t\t\t\t_tempVector2.divide( _tempVector );\n\n\t\t\t\tif ( axis.search( 'X' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.x = 1;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Y' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.y = 1;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Z' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.z = 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Apply scale\n\n\t\t\tobject.scale.copy( scaleStart ).multiply( _tempVector2 );\n\n\t\t\tif ( this.scaleSnap ) {\n\n\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.x = Math.round( object.scale.x / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.y = Math.round( object.scale.y / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.z = Math.round( object.scale.z / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( mode === 'rotate' ) {\n\n\t\t\toffset.copy( pointEnd ).sub( pointStart );\n\n\t\t\tvar ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\n\n\t\t\tif ( axis === 'E' ) {\n\n\t\t\t\trotationAxis.copy( eye );\n\t\t\t\trotationAngle = pointEnd.angleTo( pointStart );\n\n\t\t\t\tstartNorm.copy( pointStart ).normalize();\n\t\t\t\tendNorm.copy( pointEnd ).normalize();\n\n\t\t\t\trotationAngle *= ( endNorm.cross( startNorm ).dot( eye ) < 0 ? 1 : - 1 );\n\n\t\t\t} else if ( axis === 'XYZE' ) {\n\n\t\t\t\trotationAxis.copy( offset ).cross( eye ).normalize();\n\t\t\t\trotationAngle = offset.dot( _tempVector.copy( rotationAxis ).cross( this.eye ) ) * ROTATION_SPEED;\n\n\t\t\t} else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\n\n\t\t\t\trotationAxis.copy( _unit[ axis ] );\n\n\t\t\t\t_tempVector.copy( _unit[ axis ] );\n\n\t\t\t\tif ( space === 'local' ) {\n\n\t\t\t\t\t_tempVector.applyQuaternion( worldQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\trotationAngle = offset.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\n\n\t\t\t}\n\n\t\t\t// Apply rotation snap\n\n\t\t\tif ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\n\n\t\t\tthis.rotationAngle = rotationAngle;\n\n\t\t\t// Apply rotate\n\t\t\tif ( space === 'local' && axis !== 'E' && axis !== 'XYZE' ) {\n\n\t\t\t\tobject.quaternion.copy( quaternionStart );\n\t\t\t\tobject.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) ).normalize();\n\n\t\t\t} else {\n\n\t\t\t\trotationAxis.applyQuaternion( parentQuaternionInv );\n\t\t\t\tobject.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n\t\t\t\tobject.quaternion.multiply( quaternionStart ).normalize();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.dispatchEvent( changeEvent );\n\t\tthis.dispatchEvent( objectChangeEvent );\n\n\t};\n\n\tthis.pointerUp = function ( pointer ) {\n\n\t\tif ( pointer.button !== 0 ) return;\n\n\t\tif ( this.dragging && ( this.axis !== null ) ) {\n\n\t\t\tmouseUpEvent.mode = this.mode;\n\t\t\tthis.dispatchEvent( mouseUpEvent );\n\n\t\t}\n\n\t\tthis.dragging = false;\n\t\tthis.axis = null;\n\n\t};\n\n\t// normalize mouse / touch pointer and remap {x,y} to view space.\n\n\tfunction getPointer( event ) {\n\n\t\tif ( scope.domElement.ownerDocument.pointerLockElement ) {\n\n\t\t\treturn {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t\tbutton: event.button\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tvar pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\n\n\t\t\tvar rect = domElement.getBoundingClientRect();\n\n\t\t\treturn {\n\t\t\t\tx: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\n\t\t\t\ty: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\n\t\t\t\tbutton: event.button\n\t\t\t};\n\n\t\t}\n\n\t}\n\n\t// mouse / touch event handlers\n\n\tfunction onPointerHover( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tswitch ( event.pointerType ) {\n\n\t\t\tcase 'mouse':\n\t\t\tcase 'pen':\n\t\t\t\tscope.pointerHover( getPointer( event ) );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onPointerDown( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tscope.domElement.style.touchAction = 'none'; // disable touch scroll\n\t\tscope.domElement.ownerDocument.addEventListener( \"pointermove\", onPointerMove, false );\n\n\t\tscope.pointerHover( getPointer( event ) );\n\t\tscope.pointerDown( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerMove( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tscope.pointerMove( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerUp( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tscope.domElement.style.touchAction = '';\n\t\tscope.domElement.ownerDocument.removeEventListener( \"pointermove\", onPointerMove, false );\n\n\t\tscope.pointerUp( getPointer( event ) );\n\n\t}\n\n\t// TODO: deprecate\n\n\tthis.getMode = function () {\n\n\t\treturn scope.mode;\n\n\t};\n\n\tthis.setMode = function ( mode ) {\n\n\t\tscope.mode = mode;\n\n\t};\n\n\tthis.setTranslationSnap = function ( translationSnap ) {\n\n\t\tscope.translationSnap = translationSnap;\n\n\t};\n\n\tthis.setRotationSnap = function ( rotationSnap ) {\n\n\t\tscope.rotationSnap = rotationSnap;\n\n\t};\n\n\tthis.setScaleSnap = function ( scaleSnap ) {\n\n\t\tscope.scaleSnap = scaleSnap;\n\n\t};\n\n\tthis.setSize = function ( size ) {\n\n\t\tscope.size = size;\n\n\t};\n\n\tthis.setSpace = function ( space ) {\n\n\t\tscope.space = space;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tconsole.warn( 'THREE.TransformControls: update function has no more functionality and therefore has been deprecated.' );\n\n\t};\n\n};\n\nTHREE.TransformControls.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n\tconstructor: THREE.TransformControls,\n\n\tisTransformControls: true\n\n} );\n\n\nTHREE.TransformControlsGizmo = function () {\n\n\t'use strict';\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'TransformControlsGizmo';\n\n\t// shared materials\n\n\tvar gizmoMaterial = new THREE.MeshBasicMaterial( {\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true,\n\t\tside: THREE.DoubleSide,\n\t\tfog: false,\n\t\ttoneMapped: false\n\t} );\n\n\tvar gizmoLineMaterial = new THREE.LineBasicMaterial( {\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true,\n\t\tlinewidth: 1,\n\t\tfog: false,\n\t\ttoneMapped: false\n\t} );\n\n\t// Make unique material for each axis/color\n\n\tvar matInvisible = gizmoMaterial.clone();\n\tmatInvisible.opacity = 0.15;\n\n\tvar matHelper = gizmoMaterial.clone();\n\tmatHelper.opacity = 0.33;\n\n\tvar matRed = gizmoMaterial.clone();\n\tmatRed.color.set( 0xff0000 );\n\n\tvar matGreen = gizmoMaterial.clone();\n\tmatGreen.color.set( 0x00ff00 );\n\n\tvar matBlue = gizmoMaterial.clone();\n\tmatBlue.color.set( 0x0000ff );\n\n\tvar matWhiteTransparent = gizmoMaterial.clone();\n\tmatWhiteTransparent.opacity = 0.25;\n\n\tvar matYellowTransparent = matWhiteTransparent.clone();\n\tmatYellowTransparent.color.set( 0xffff00 );\n\n\tvar matCyanTransparent = matWhiteTransparent.clone();\n\tmatCyanTransparent.color.set( 0x00ffff );\n\n\tvar matMagentaTransparent = matWhiteTransparent.clone();\n\tmatMagentaTransparent.color.set( 0xff00ff );\n\n\tvar matYellow = gizmoMaterial.clone();\n\tmatYellow.color.set( 0xffff00 );\n\n\tvar matLineRed = gizmoLineMaterial.clone();\n\tmatLineRed.color.set( 0xff0000 );\n\n\tvar matLineGreen = gizmoLineMaterial.clone();\n\tmatLineGreen.color.set( 0x00ff00 );\n\n\tvar matLineBlue = gizmoLineMaterial.clone();\n\tmatLineBlue.color.set( 0x0000ff );\n\n\tvar matLineCyan = gizmoLineMaterial.clone();\n\tmatLineCyan.color.set( 0x00ffff );\n\n\tvar matLineMagenta = gizmoLineMaterial.clone();\n\tmatLineMagenta.color.set( 0xff00ff );\n\n\tvar matLineYellow = gizmoLineMaterial.clone();\n\tmatLineYellow.color.set( 0xffff00 );\n\n\tvar matLineGray = gizmoLineMaterial.clone();\n\tmatLineGray.color.set( 0x787878 );\n\n\tvar matLineYellowTransparent = matLineYellow.clone();\n\tmatLineYellowTransparent.opacity = 0.25;\n\n\t// reusable geometry\n\n\tvar arrowGeometry = new THREE.CylinderBufferGeometry( 0, 0.05, 0.2, 12, 1, false );\n\n\tvar scaleHandleGeometry = new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 );\n\n\tvar lineGeometry = new THREE.BufferGeometry();\n\tlineGeometry.setAttribute( 'position', new THREE.Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\n\n\tvar CircleGeometry = function ( radius, arc ) {\n\n\t\tvar geometry = new THREE.BufferGeometry( );\n\t\tvar vertices = [];\n\n\t\tfor ( var i = 0; i <= 64 * arc; ++ i ) {\n\n\t\t\tvertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new THREE.Float32BufferAttribute( vertices, 3 ) );\n\n\t\treturn geometry;\n\n\t};\n\n\t// Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n\tvar TranslateHelperGeometry = function () {\n\n\t\tvar geometry = new THREE.BufferGeometry();\n\n\t\tgeometry.setAttribute( 'position', new THREE.Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\n\n\t\treturn geometry;\n\n\t};\n\n\t// Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n\tvar gizmoTranslate = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, - Math.PI / 2 ], null, 'fwd' ],\n\t\t\t[ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineRed ) ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\n\t\t\t[ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\n\t\t\t[ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ - Math.PI / 2, 0, 0 ], null, 'bwd' ],\n\t\t\t[ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ]]\n\t\t],\n\t\tXYZ: [\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransparent.clone() ), [ 0, 0, 0 ], [ 0, 0, 0 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matYellowTransparent.clone() ), [ 0.15, 0.15, 0 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent.clone() ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent.clone() ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t]\n\t};\n\n\tvar pickerTranslate = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ]]\n\t\t],\n\t\tXYZ: [\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]\n\t\t],\n\t\tXY: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ - Math.PI / 2, 0, 0 ]]\n\t\t]\n\t};\n\n\tvar helperTranslate = {\n\t\tSTART: [\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tEND: [\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tDELTA: [\n\t\t\t[ new THREE.Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tX: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\tvar gizmoRotate = {\n\t\tX: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ]],\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, - Math.PI / 2 ]],\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ]],\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ]],\n\t\t],\n\t\tE: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, - Math.PI / 2 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ - 1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, - 1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\n\t\t],\n\t\tXYZE: [\n\t\t\t[ new THREE.Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ]]\n\t\t]\n\t};\n\n\tvar helperRotate = {\n\t\tAXIS: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\tvar pickerRotate = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, - Math.PI / 2, - Math.PI / 2 ]],\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ]],\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\n\t\t],\n\t\tE: [\n\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\n\t\t],\n\t\tXYZE: [\n\t\t\t[ new THREE.Mesh( new THREE.SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]\n\t\t]\n\t};\n\n\tvar gizmoScale = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ], [ 0.8, 1, 1 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXYZX: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 1.1, 0, 0 ]],\n\t\t],\n\t\tXYZY: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 1.1, 0 ]],\n\t\t],\n\t\tXYZZ: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 0, 1.1 ]],\n\t\t]\n\t};\n\n\tvar pickerScale = {\n\t\tX: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ]],\n\t\t],\n\t\tYZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ]],\n\t\t],\n\t\tXZ: [\n\t\t\t[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ]],\n\t\t],\n\t\tXYZX: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ]],\n\t\t],\n\t\tXYZY: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ]],\n\t\t],\n\t\tXYZZ: [\n\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ]],\n\t\t]\n\t};\n\n\tvar helperScale = {\n\t\tX: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tY: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\t// Creates an Object3D with gizmos described in custom hierarchy definition.\n\n\tvar setupGizmo = function ( gizmoMap ) {\n\n\t\tvar gizmo = new THREE.Object3D();\n\n\t\tfor ( var name in gizmoMap ) {\n\n\t\t\tfor ( var i = gizmoMap[ name ].length; i --; ) {\n\n\t\t\t\tvar object = gizmoMap[ name ][ i ][ 0 ].clone();\n\t\t\t\tvar position = gizmoMap[ name ][ i ][ 1 ];\n\t\t\t\tvar rotation = gizmoMap[ name ][ i ][ 2 ];\n\t\t\t\tvar scale = gizmoMap[ name ][ i ][ 3 ];\n\t\t\t\tvar tag = gizmoMap[ name ][ i ][ 4 ];\n\n\t\t\t\t// name and tag properties are essential for picking and updating logic.\n\t\t\t\tobject.name = name;\n\t\t\t\tobject.tag = tag;\n\n\t\t\t\tif ( position ) {\n\n\t\t\t\t\tobject.position.set( position[ 0 ], position[ 1 ], position[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( rotation ) {\n\n\t\t\t\t\tobject.rotation.set( rotation[ 0 ], rotation[ 1 ], rotation[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scale ) {\n\n\t\t\t\t\tobject.scale.set( scale[ 0 ], scale[ 1 ], scale[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tobject.updateMatrix();\n\n\t\t\t\tvar tempGeometry = object.geometry.clone();\n\t\t\t\ttempGeometry.applyMatrix4( object.matrix );\n\t\t\t\tobject.geometry = tempGeometry;\n\t\t\t\tobject.renderOrder = Infinity;\n\n\t\t\t\tobject.position.set( 0, 0, 0 );\n\t\t\t\tobject.rotation.set( 0, 0, 0 );\n\t\t\t\tobject.scale.set( 1, 1, 1 );\n\n\t\t\t\tgizmo.add( object );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn gizmo;\n\n\t};\n\n\t// Reusable utility variables\n\n\tvar tempVector = new THREE.Vector3( 0, 0, 0 );\n\tvar tempEuler = new THREE.Euler();\n\tvar alignVector = new THREE.Vector3( 0, 1, 0 );\n\tvar zeroVector = new THREE.Vector3( 0, 0, 0 );\n\tvar lookAtMatrix = new THREE.Matrix4();\n\tvar tempQuaternion = new THREE.Quaternion();\n\tvar tempQuaternion2 = new THREE.Quaternion();\n\tvar identityQuaternion = new THREE.Quaternion();\n\n\tvar unitX = new THREE.Vector3( 1, 0, 0 );\n\tvar unitY = new THREE.Vector3( 0, 1, 0 );\n\tvar unitZ = new THREE.Vector3( 0, 0, 1 );\n\n\t// Gizmo creation\n\n\tthis.gizmo = {};\n\tthis.picker = {};\n\tthis.helper = {};\n\n\tthis.add( this.gizmo[ \"translate\" ] = setupGizmo( gizmoTranslate ) );\n\tthis.add( this.gizmo[ \"rotate\" ] = setupGizmo( gizmoRotate ) );\n\tthis.add( this.gizmo[ \"scale\" ] = setupGizmo( gizmoScale ) );\n\tthis.add( this.picker[ \"translate\" ] = setupGizmo( pickerTranslate ) );\n\tthis.add( this.picker[ \"rotate\" ] = setupGizmo( pickerRotate ) );\n\tthis.add( this.picker[ \"scale\" ] = setupGizmo( pickerScale ) );\n\tthis.add( this.helper[ \"translate\" ] = setupGizmo( helperTranslate ) );\n\tthis.add( this.helper[ \"rotate\" ] = setupGizmo( helperRotate ) );\n\tthis.add( this.helper[ \"scale\" ] = setupGizmo( helperScale ) );\n\n\t// Pickers should be hidden always\n\n\tthis.picker[ \"translate\" ].visible = false;\n\tthis.picker[ \"rotate\" ].visible = false;\n\tthis.picker[ \"scale\" ].visible = false;\n\n\t// updateMatrixWorld will update transformations and appearance of individual handles\n\n\tthis.updateMatrixWorld = function () {\n\n\t\tvar space = this.space;\n\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n\t\tvar quaternion = space === \"local\" ? this.worldQuaternion : identityQuaternion;\n\n\t\t// Show only gizmos for current transform mode\n\n\t\tthis.gizmo[ \"translate\" ].visible = this.mode === \"translate\";\n\t\tthis.gizmo[ \"rotate\" ].visible = this.mode === \"rotate\";\n\t\tthis.gizmo[ \"scale\" ].visible = this.mode === \"scale\";\n\n\t\tthis.helper[ \"translate\" ].visible = this.mode === \"translate\";\n\t\tthis.helper[ \"rotate\" ].visible = this.mode === \"rotate\";\n\t\tthis.helper[ \"scale\" ].visible = this.mode === \"scale\";\n\n\n\t\tvar handles = [];\n\t\thandles = handles.concat( this.picker[ this.mode ].children );\n\t\thandles = handles.concat( this.gizmo[ this.mode ].children );\n\t\thandles = handles.concat( this.helper[ this.mode ].children );\n\n\t\tfor ( var i = 0; i < handles.length; i ++ ) {\n\n\t\t\tvar handle = handles[ i ];\n\n\t\t\t// hide aligned to camera\n\n\t\t\thandle.visible = true;\n\t\t\thandle.rotation.set( 0, 0, 0 );\n\t\t\thandle.position.copy( this.worldPosition );\n\n\t\t\tvar factor;\n\n\t\t\tif ( this.camera.isOrthographicCamera ) {\n\n\t\t\t\tfactor = ( this.camera.top - this.camera.bottom ) / this.camera.zoom;\n\n\t\t\t} else {\n\n\t\t\t\tfactor = this.worldPosition.distanceTo( this.cameraPosition ) * Math.min( 1.9 * Math.tan( Math.PI * this.camera.fov / 360 ) / this.camera.zoom, 7 );\n\n\t\t\t}\n\n\t\t\thandle.scale.set( 1, 1, 1 ).multiplyScalar( factor * this.size / 7 );\n\n\t\t\t// TODO: simplify helpers and consider decoupling from gizmo\n\n\t\t\tif ( handle.tag === 'helper' ) {\n\n\t\t\t\thandle.visible = false;\n\n\t\t\t\tif ( handle.name === 'AXIS' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.visible = !! this.axis;\n\n\t\t\t\t\tif ( this.axis === 'X' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'Y' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'Z' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'XYZE' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n\t\t\t\t\t\talignVector.copy( this.rotationAxis );\n\t\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\n\t\t\t\t\t\thandle.quaternion.multiply( tempQuaternion );\n\t\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'E' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\n\t\t\t\t} else if ( handle.name === 'START' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else if ( handle.name === 'END' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPosition );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else if ( handle.name === 'DELTA' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.quaternion.copy( this.worldQuaternionStart );\n\t\t\t\t\ttempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( - 1 );\n\t\t\t\t\ttempVector.applyQuaternion( this.worldQuaternionStart.clone().inverse() );\n\t\t\t\t\thandle.scale.copy( tempVector );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else {\n\n\t\t\t\t\thandle.quaternion.copy( quaternion );\n\n\t\t\t\t\tif ( this.dragging ) {\n\n\t\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\thandle.position.copy( this.worldPosition );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis ) {\n\n\t\t\t\t\t\thandle.visible = this.axis.search( handle.name ) !== - 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// If updating helper, skip rest of the loop\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// Align handles to current local or world rotation\n\n\t\t\thandle.quaternion.copy( quaternion );\n\n\t\t\tif ( this.mode === 'translate' || this.mode === 'scale' ) {\n\n\t\t\t\t// Hide translate and scale axis facing the camera\n\n\t\t\t\tvar AXIS_HIDE_TRESHOLD = 0.99;\n\t\t\t\tvar PLANE_HIDE_TRESHOLD = 0.2;\n\t\t\t\tvar AXIS_FLIP_TRESHOLD = 0.0;\n\n\n\t\t\t\tif ( handle.name === 'X' || handle.name === 'XYZX' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Y' || handle.name === 'XYZY' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'XY' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'YZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'XZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Flip translate and scale axis ocluded behind another axis\n\n\t\t\t\tif ( handle.name.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.x *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.y *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.z *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( this.mode === 'rotate' ) {\n\n\t\t\t\t// Align handles to current local or world rotation\n\n\t\t\t\ttempQuaternion2.copy( quaternion );\n\t\t\t\talignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).inverse() );\n\n\t\t\t\tif ( handle.name.search( \"E\" ) !== - 1 ) {\n\n\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'X' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitX, Math.atan2( - alignVector.y, alignVector.z ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Y' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Z' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Hide disabled axes\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"X\" ) === - 1 || this.showX );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"Y\" ) === - 1 || this.showY );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"Z\" ) === - 1 || this.showZ );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"E\" ) === - 1 || ( this.showX && this.showY && this.showZ ) );\n\n\t\t\t// highlight selected axis\n\n\t\t\thandle.material._opacity = handle.material._opacity || handle.material.opacity;\n\t\t\thandle.material._color = handle.material._color || handle.material.color.clone();\n\n\t\t\thandle.material.color.copy( handle.material._color );\n\t\t\thandle.material.opacity = handle.material._opacity;\n\n\t\t\tif ( ! this.enabled ) {\n\n\t\t\t\thandle.material.opacity *= 0.5;\n\t\t\t\thandle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t} else if ( this.axis ) {\n\n\t\t\t\tif ( handle.name === this.axis ) {\n\n\t\t\t\t\thandle.material.opacity = 1.0;\n\t\t\t\t\thandle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t} else if ( this.axis.split( '' ).some( function ( a ) {\n\n\t\t\t\t\treturn handle.name === a;\n\n\t\t\t\t} ) ) {\n\n\t\t\t\t\thandle.material.opacity = 1.0;\n\t\t\t\t\thandle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\thandle.material.opacity *= 0.25;\n\t\t\t\t\thandle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n};\n\nTHREE.TransformControlsGizmo.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\n\n\tconstructor: THREE.TransformControlsGizmo,\n\n\tisTransformControlsGizmo: true\n\n} );\n\n\nTHREE.TransformControlsPlane = function () {\n\n\t'use strict';\n\n\tTHREE.Mesh.call( this,\n\t\tnew THREE.PlaneBufferGeometry( 100000, 100000, 2, 2 ),\n\t\tnew THREE.MeshBasicMaterial( { visible: false, wireframe: true, side: THREE.DoubleSide, transparent: true, opacity: 0.1, toneMapped: false } )\n\t);\n\n\tthis.type = 'TransformControlsPlane';\n\n\tvar unitX = new THREE.Vector3( 1, 0, 0 );\n\tvar unitY = new THREE.Vector3( 0, 1, 0 );\n\tvar unitZ = new THREE.Vector3( 0, 0, 1 );\n\n\tvar tempVector = new THREE.Vector3();\n\tvar dirVector = new THREE.Vector3();\n\tvar alignVector = new THREE.Vector3();\n\tvar tempMatrix = new THREE.Matrix4();\n\tvar identityQuaternion = new THREE.Quaternion();\n\n\tthis.updateMatrixWorld = function () {\n\n\t\tvar space = this.space;\n\n\t\tthis.position.copy( this.worldPosition );\n\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n\t\tunitX.set( 1, 0, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\t\tunitY.set( 0, 1, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\t\tunitZ.set( 0, 0, 1 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\n\t\t// Align the plane for current transform mode, axis and space.\n\n\t\talignVector.copy( unitY );\n\n\t\tswitch ( this.mode ) {\n\n\t\t\tcase 'translate':\n\t\t\tcase 'scale':\n\t\t\t\tswitch ( this.axis ) {\n\n\t\t\t\t\tcase 'X':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitX );\n\t\t\t\t\t\tdirVector.copy( unitX ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Y':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitY );\n\t\t\t\t\t\tdirVector.copy( unitY ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Z':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitZ );\n\t\t\t\t\t\tdirVector.copy( unitZ ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XY':\n\t\t\t\t\t\tdirVector.copy( unitZ );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'YZ':\n\t\t\t\t\t\tdirVector.copy( unitX );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XZ':\n\t\t\t\t\t\talignVector.copy( unitZ );\n\t\t\t\t\t\tdirVector.copy( unitY );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XYZ':\n\t\t\t\t\tcase 'E':\n\t\t\t\t\t\tdirVector.set( 0, 0, 0 );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'rotate':\n\t\t\tdefault:\n\t\t\t\t// special case for rotate\n\t\t\t\tdirVector.set( 0, 0, 0 );\n\n\t\t}\n\n\t\tif ( dirVector.length() === 0 ) {\n\n\t\t\t// If in rotate mode, make the plane parallel to camera\n\t\t\tthis.quaternion.copy( this.cameraQuaternion );\n\n\t\t} else {\n\n\t\t\ttempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\n\n\t\t\tthis.quaternion.setFromRotationMatrix( tempMatrix );\n\n\t\t}\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n};\n\nTHREE.TransformControlsPlane.prototype = Object.assign( Object.create( THREE.Mesh.prototype ), {\n\n\tconstructor: THREE.TransformControlsPlane,\n\n\tisTransformControlsPlane: true\n\n} );\n"]}