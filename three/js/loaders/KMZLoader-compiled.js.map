{"version":3,"sources":["KMZLoader.js"],"names":[],"mappings":"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","file":"KMZLoader-compiled.js","sourcesContent":["console.warn( \"THREE.KMZLoader: As part of the transition to ES6 Modules, the files in 'examples/js' were deprecated in May 2020 (r117) and will be deleted in December 2020 (r124). You can find more information about developing using ES6 Modules in https://threejs.org/docs/#manual/en/introduction/Installation.\" );\n\nTHREE.KMZLoader = function ( manager ) {\n\n\tTHREE.Loader.call( this, manager );\n\n};\n\nTHREE.KMZLoader.prototype = Object.assign( Object.create( THREE.Loader.prototype ), {\n\n\tconstructor: THREE.KMZLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar loader = new THREE.FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( text ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\tparse: function ( data ) {\n\n\t\tfunction findFile( url ) {\n\n\t\t\tfor ( var path in zip.files ) {\n\n\t\t\t\tif ( path.substr( - url.length ) === url ) {\n\n\t\t\t\t\treturn zip.files[ path ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar manager = new THREE.LoadingManager();\n\t\tmanager.setURLModifier( function ( url ) {\n\n\t\t\tvar image = findFile( url );\n\n\t\t\tif ( image ) {\n\n\t\t\t\tconsole.log( 'Loading', url );\n\n\t\t\t\tvar blob = new Blob( [ image.asArrayBuffer() ], { type: 'application/octet-stream' } );\n\t\t\t\treturn URL.createObjectURL( blob );\n\n\t\t\t}\n\n\t\t\treturn url;\n\n\t\t} );\n\n\t\t//\n\n\t\tvar zip = new JSZip( data ); // eslint-disable-line no-undef\n\n\t\tif ( zip.files[ 'doc.kml' ] ) {\n\n\t\t\tvar xml = new DOMParser().parseFromString( zip.files[ 'doc.kml' ].asText(), 'application/xml' );\n\n\t\t\tvar model = xml.querySelector( 'Placemark Model Link href' );\n\n\t\t\tif ( model ) {\n\n\t\t\t\tvar loader = new THREE.ColladaLoader( manager );\n\t\t\t\treturn loader.parse( zip.files[ model.textContent ].asText() );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'KMZLoader: Missing doc.kml file.' );\n\n\t\t\tfor ( var path in zip.files ) {\n\n\t\t\t\tvar extension = path.split( '.' ).pop().toLowerCase();\n\n\t\t\t\tif ( extension === 'dae' ) {\n\n\t\t\t\t\tvar loader = new THREE.ColladaLoader( manager );\n\t\t\t\t\treturn loader.parse( zip.files[ path ].asText() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconsole.error( 'KMZLoader: Couldn\\'t find .dae file.' );\n\t\treturn { scene: new THREE.Group() };\n\n\t}\n\n} );\n"]}