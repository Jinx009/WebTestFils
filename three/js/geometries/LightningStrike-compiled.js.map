{"version":3,"sources":["LightningStrike.js"],"names":[],"mappings":"AAAA,QAAQ,IAAR,CAAc,gTAAd;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA,MAAM,eAAN,GAAwB,UAAW,aAAX,EAA2B;;AAElD,OAAM,cAAN,CAAqB,IAArB,CAA2B,IAA3B;;AAEA,MAAK,IAAL,GAAY,iBAAZ;;AAEA;AACA,iBAAgB,iBAAiB,EAAjC;AACA,MAAK,IAAL,CAAW,MAAM,eAAN,CAAsB,cAAtB,CAAsC,aAAtC,EAAqD,aAArD,CAAX;;AAEA;AACA,MAAK,UAAL;AAEA,CAbD;;AAeA,MAAM,eAAN,CAAsB,SAAtB,GAAkC,OAAO,MAAP,CAAe,MAAM,cAAN,CAAqB,SAApC,CAAlC;;AAEA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,WAAhC,GAA8C,MAAM,eAApD;;AAEA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,iBAAhC,GAAoD,IAApD;;AAEA;AACA,MAAM,eAAN,CAAsB,eAAtB,GAAwC,CAAxC;AACA,MAAM,eAAN,CAAsB,UAAtB,GAAmC,CAAnC;AACA,MAAM,eAAN,CAAsB,eAAtB,GAAwC,CAAxC;AACA,MAAM,eAAN,CAAsB,UAAtB,GAAmC,CAAnC;AACA,MAAM,eAAN,CAAsB,aAAtB,GAAsC,CAAtC;AACA,MAAM,eAAN,CAAsB,gBAAtB,GAAyC,CAAzC;;AAEA,MAAM,eAAN,CAAsB,QAAtB,GAAiC,KAAK,GAAL,CAAU,KAAK,KAAK,EAAV,GAAe,GAAzB,CAAjC;AACA,MAAM,eAAN,CAAsB,QAAtB,GAAiC,KAAK,GAAL,CAAU,KAAK,KAAK,EAAV,GAAe,GAAzB,CAAjC;;AAEA,MAAM,eAAN,CAAsB,qBAAtB,GAA8C,YAAY;;AAEzD,KAAI,WAAW,IAAf;AACA,KAAI,QAAQ,EAAZ;;AAEA,MAAM,IAAI,IAAI,CAAd,EAAiB,IAAI,QAArB,EAA+B,GAA/B,EAAsC;;AAErC,QAAM,IAAN,CAAY,KAAK,MAAL,EAAZ;AAEA;;AAED,KAAI,YAAY;;AAEf,eAAa,CAFE;;AAIf,UAAQ,YAAY;;AAEnB,OAAI,QAAQ,MAAO,UAAU,WAAjB,CAAZ;;AAEA,aAAU,WAAV,GAAwB,CAAE,UAAU,WAAV,GAAwB,CAA1B,IAAgC,QAAxD;;AAEA,UAAO,KAAP;AAEA,GAZc;;AAcf,WAAS,YAAY;;AAEpB,UAAO,UAAU,WAAV,GAAwB,QAA/B;AAEA,GAlBc;;AAoBf,WAAS,UAAW,IAAX,EAAkB;;AAE1B,aAAU,WAAV,GAAwB,KAAK,KAAL,CAAY,OAAO,QAAnB,IAAgC,QAAxD;AAEA;;AAxBc,EAAhB;;AA4BA,QAAO,SAAP;AAEA,CAzCD;;AA2CA,MAAM,eAAN,CAAsB,cAAtB,GAAuC,UAAW,IAAX,EAAiB,MAAjB,EAA0B;;AAEhE,UAAS,UAAU,EAAnB;AACA,QAAO,QAAQ,EAAf;;AAEA,KAAI,UAAU,UAAW,CAAX,EAAe;;AAE5B,MAAK,WAAW,IAAhB,EAAuB;;AAEtB,UAAO,CAAP;AAEA,GAJD,MAIO;;AAEN,UAAO,EAAE,KAAF,EAAP;AAEA;AAED,EAZD;;AAcA,MAAK,YAAL,GAAoB,OAAO,YAAP,KAAwB,SAAxB,GAAoC,QAAS,OAAO,YAAhB,CAApC,GAAqE,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,GAAtB,EAA2B,CAA3B,CAAzF,EACA,KAAK,UAAL,GAAkB,OAAO,UAAP,KAAsB,SAAtB,GAAkC,QAAS,OAAO,UAAhB,CAAlC,GAAiE,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CADnF,EAGA,KAAK,SAAL,GAAiB,OAAO,SAAP,KAAqB,SAArB,GAAiC,OAAO,SAAxC,GAAoD,CAHrE,EAIA,KAAK,SAAL,GAAiB,OAAO,SAAP,KAAqB,SAArB,GAAiC,OAAO,SAAxC,GAAoD,GAJrE,EAKA,KAAK,YAAL,GAAoB,OAAO,YAAP,KAAwB,SAAxB,GAAoC,OAAO,YAA3C,GAA0D,GAL9E,EAOA,KAAK,GAAL,GAAW,OAAO,GAAP,KAAe,SAAf,GAA2B,QAAS,OAAO,GAAhB,CAA3B,GAAmD,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAP9D;AAQA,MAAK,GAAL,GAAW,OAAO,GAAP,KAAe,SAAf,GAA2B,QAAS,OAAO,GAAhB,CAA3B,GAAmD,IAAI,MAAM,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAA9D,EACA,KAAK,OAAL,GAAe,OAAO,OAAP,KAAmB,SAAnB,GAA+B,OAAO,OAAtC,GAAgD,CAD/D,EAEA,KAAK,OAAL,GAAe,OAAO,OAAP,KAAmB,SAAnB,GAA+B,OAAO,OAAtC,GAAgD,CAF/D,EAGA,KAAK,aAAL,GAAqB,OAAO,aAAP,KAAyB,SAAzB,GAAqC,OAAO,aAA5C,GAA4D,GAHjF,EAIA,KAAK,aAAL,GAAqB,OAAO,aAAP,KAAyB,SAAzB,GAAqC,OAAO,aAA5C,GAA4D,GAJjF,EAKA,KAAK,SAAL,GAAiB,OAAO,SAAP,KAAqB,SAArB,GAAiC,OAAO,SAAxC,GAAoD,GALrE;;AAOA;;AAEA,MAAK,SAAL,GAAiB,OAAO,SAAP,KAAqB,SAArB,GAAiC,OAAO,SAAxC,GAAsD,OAAO,SAAP,KAAqB,SAArB,IAAkC,OAAO,SAAP,KAAqB,SAT9H,EAUA,KAAK,SAAL,GAAiB,OAAO,SAVxB,EAWA,KAAK,SAAL,GAAiB,OAAO,SAXxB,EAYA,KAAK,qBAAL,GAA6B,OAAO,qBAAP,KAAiC,SAAjC,GAA6C,OAAO,qBAApD,GAA4E,GAZzG,EAaA,KAAK,mBAAL,GAA2B,OAAO,mBAAP,KAA+B,SAA/B,GAA2C,OAAO,mBAAlD,GAAwE,GAbnG,EAcA,KAAK,YAAL,GAAoB,OAAO,YAAP,KAAwB,SAAxB,GAAoC,OAAO,YAA3C,GAA0D,CAd9E,EAeA,KAAK,eAAL,GAAuB,OAAO,eAAP,KAA2B,SAA3B,GAAuC,OAAO,eAA9C,GAAgE,GAfvF;;AAiBA;;AAEA,MAAK,aAAL,GAAqB,OAAO,aAAP,KAAyB,SAAzB,GAAqC,OAAO,aAA5C,GAA4D,CAAjF;AACA,MAAK,QAAL,GAAgB,OAAO,QAAP,KAAoB,SAApB,GAAgC,OAAO,QAAvC,GAAkD,KAAlE;AACA,MAAK,YAAL,GAAoB,OAAO,YAAP,KAAwB,SAAxB,GAAoC,OAAO,YAA3C,GAA0D,CAA9E;AACA,MAAK,kBAAL,GAA0B,OAAO,kBAAP,KAA8B,SAA9B,GAA0C,OAAO,kBAAjD,GAAsE,CAAhG;AACA,MAAK,oBAAL,GAA4B,OAAO,oBAAP,KAAgC,SAAhC,GAA4C,OAAO,oBAAnD,GAA0E,GAAtG;AACA,MAAK,WAAL,GAAmB,OAAO,WAAP,KAAuB,SAAvB,GAAmC,OAAO,WAA1C,GAAwD,KAA3E;AACA,MAAK,eAAL,GAAuB,OAAO,eAA9B,EACA,KAAK,SAAL,GAAiB,OAAO,SADxB,EAEA,KAAK,sBAAL,GAA8B,OAAO,sBAFrC,EAGA,KAAK,gBAAL,GAAwB,OAAO,gBAH/B;;AAKA,QAAO,IAAP;AAEA,CA3DD;;AA6DA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,MAAhC,GAAyC,UAAW,IAAX,EAAkB;;AAE1D,KAAK,KAAK,QAAV,EAAqB;;AAErB,KAAK,KAAK,aAAL,CAAmB,SAAnB,IAAkC,KAAK,aAAL,CAAmB,SAAnB,IAAgC,IAAhC,IAAwC,QAAQ,KAAK,aAAL,CAAmB,SAA1G,EAAwH;;AAEvH,OAAK,UAAL,CAAiB,IAAjB;;AAEA,MAAK,OAAO,KAAK,OAAL,CAAc,CAAd,EAAkB,kBAA9B,EAAmD;;AAElD,QAAK,KAAL,GAAa,MAAM,eAAN,CAAsB,eAAnC;AAEA,GAJD,MAIO,IAAK,OAAO,KAAK,OAAL,CAAc,CAAd,EAAkB,kBAA9B,EAAmD;;AAEzD,QAAK,KAAL,GAAa,MAAM,eAAN,CAAsB,aAAnC;AAEA,GAJM,MAIA;;AAEN,QAAK,KAAL,GAAa,MAAM,eAAN,CAAsB,UAAnC;AAEA;;AAED,OAAK,OAAL,GAAe,IAAf;AAEA,EApBD,MAoBO;;AAEN,OAAK,OAAL,GAAe,KAAf;;AAEA,MAAK,OAAO,KAAK,aAAL,CAAmB,SAA/B,EAA2C;;AAE1C,QAAK,KAAL,GAAa,MAAM,eAAN,CAAsB,UAAnC;AAEA,GAJD,MAIO;;AAEN,QAAK,KAAL,GAAa,MAAM,eAAN,CAAsB,gBAAnC;AAEA;AAED;AAED,CAxCD;;AA0CA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,IAAhC,GAAuC,UAAW,aAAX,EAA2B;;AAEjE;;AAEA,MAAK,aAAL,GAAqB,aAArB;;AAEA;;AAEA,MAAK,aAAL,GAAqB,cAAc,aAAd,KAAgC,SAAhC,GAA4C,KAAK,KAAL,CAAY,cAAc,aAA1B,CAA5C,GAAwF,CAA7G;AACA,eAAc,aAAd,GAA8B,KAAK,aAAnC;AACA,MAAK,QAAL,GAAgB,cAAc,QAAd,KAA2B,SAA3B,GAAuC,cAAc,QAArD,GAAgE,KAAhF;AACA,eAAc,QAAd,GAAyB,KAAK,QAA9B;AACA,MAAK,YAAL,GAAoB,cAAc,YAAd,KAA+B,SAA/B,GAA2C,KAAK,KAAL,CAAY,cAAc,YAA1B,CAA3C,GAAsF,CAA1G;AACA,eAAc,YAAd,GAA6B,KAAK,YAAlC;AACA,MAAK,kBAAL,GAA0B,cAAc,kBAAd,KAAqC,SAArC,GAAiD,KAAK,KAAL,CAAY,cAAc,kBAA1B,CAAjD,GAAkG,CAA5H;AACA,eAAc,kBAAd,GAAmC,KAAK,kBAAxC;AACA,MAAK,oBAAL,GAA4B,cAAc,oBAAd,KAAuC,SAAvC,GAAmD,cAAc,oBAAjE,GAAwF,GAApH;AACA,eAAc,oBAAd,GAAqC,KAAK,oBAA1C;AACA,MAAK,WAAL,GAAmB,cAAc,WAAd,KAA8B,SAA9B,GAA0C,cAAc,WAAxD,GAAsE,KAAzF;AACA,eAAc,WAAd,GAA4B,KAAK,WAAjC;;AAEA;AACA,KAAK,cAAc,eAAd,KAAkC,SAAvC,EAAmD;;AAElD,OAAK,eAAL,GAAuB,cAAc,eAArC;AACA,OAAK,aAAL,GAAqB,cAAc,eAAnC;;AAEA,MAAK,cAAc,SAAd,KAA4B,SAAjC,EAA6C;;AAE5C,QAAK,aAAL,CAAmB,OAAnB,CAA4B,cAAc,SAA1C;AAEA;AAED,EAXD,MAWO;;AAEN,OAAK,eAAL,GAAuB,MAAM,eAAN,CAAsB,qBAAtB,EAAvB;AACA,OAAK,aAAL,GAAqB,IAArB;AAEA;;AAED;AACA,KAAK,cAAc,sBAAd,KAAyC,SAA9C,EAA0D;;AAEzD,OAAK,sBAAL,GAA8B,cAAc,sBAA5C;AAEA,EAJD,MAIO;;AAEN,OAAK,oCAAL;;AAEA,MAAK,cAAc,gBAAd,KAAmC,SAAxC,EAAoD;;AAEnD,QAAK,gBAAL,GAAwB,cAAc,gBAAtC;AAEA;AAED;;AAED;;AAEA,MAAK,KAAL,GAAa,MAAM,eAAN,CAAsB,eAAnC;;AAEA,MAAK,UAAL,GAAkB,KAAK,IAAL,CAAW,IAAI,KAAK,GAAL,CAAU,KAAK,YAAf,EAA6B,KAAK,GAAL,CAAU,CAAV,EAAa,KAAK,kBAAL,GAA0B,CAAvC,CAA7B,CAAf,CAAlB;AACA,eAAc,UAAd,GAA2B,KAAK,UAAhC;;AAEA,MAAK,cAAL,GAAsB,KAAM,KAAK,KAAK,aAAhB,CAAtB;;AAEA,MAAK,OAAL,GAAe,EAAf;;AAEA,MAAM,IAAI,IAAI,CAAd,EAAiB,IAAI,KAAK,UAA1B,EAAsC,GAAtC,EAA6C;;AAE5C,OAAK,OAAL,CAAa,IAAb,CAAmB,KAAK,YAAL,EAAnB;AAEA;;AAED,MAAK,WAAL,GAAmB,EAAnB;;AAEA,MAAM,IAAI,IAAI,CAAd,EAAiB,IAAI,KAAK,cAA1B,EAA0C,GAA1C,EAAiD;;AAEhD,OAAK,WAAL,CAAiB,IAAjB,CAAuB,KAAK,aAAL,EAAvB;AAEA;;AAED,MAAK,IAAL,GAAY,CAAZ;AACA,MAAK,YAAL,GAAoB,CAApB;AACA,MAAK,sBAAL,GAA8B,IAA9B;AACA,MAAK,6BAAL,GAAqC,KAAK,WAAL,GAAmB,KAAK,6BAAxB,GAAwD,KAAK,gCAAlG;AACA,MAAK,UAAL,GAAkB,CAAlB;AACA,MAAK,aAAL,GAAqB,IAArB;AACA,MAAK,mBAAL,GAA2B,CAA3B;AACA,MAAK,gBAAL,GAAwB,KAAxB;AACA,MAAK,iBAAL,GAAyB,CAAzB;;AAEA,MAAK,aAAL,GAAqB,CAArB;AACA,MAAK,YAAL,GAAoB,CAApB;AACA,MAAK,iBAAL,GAAyB,CAAzB;AACA,MAAK,mBAAL,GAA2B,CAA3B;AACA,MAAK,QAAL,GAAgB,IAAhB;AACA,MAAK,GAAL,GAAW,IAAX;AACA,MAAK,OAAL,GAAe,IAAf;AACA,MAAK,iBAAL,GAAyB,IAAzB;AACA,MAAK,YAAL,GAAoB,IAApB;;AAEA,MAAK,QAAL,GAAgB,IAAI,MAAM,YAAV,CAAwB,KAAK,aAA7B,CAAhB;AACA,MAAK,QAAL,GAAgB,IAAI,MAAM,YAAV,CAAwB,KAAK,aAA7B,CAAhB;AACA,MAAK,QAAL,GAAgB,IAAI,MAAM,YAAV,CAAwB,KAAK,aAA7B,CAAhB;;AAEA;AACA,MAAK,QAAL,GAAgB,IAAI,MAAM,OAAV,EAAhB;AACA,MAAK,YAAL,GAAoB,IAAI,MAAM,OAAV,EAApB;AACA,MAAK,IAAL,GAAY,IAAI,MAAM,OAAV,EAAZ;AACA,MAAK,IAAL,GAAY,IAAI,MAAM,OAAV,EAAZ;AACA,MAAK,SAAL,GAAiB,IAAI,MAAM,OAAV,EAAjB;AACA,MAAK,YAAL,GAAoB,IAAI,MAAM,OAAV,EAApB;AACA,MAAK,MAAL,GAAc,IAAI,MAAM,OAAV,EAAd;AACA,MAAK,IAAL,GAAY,IAAI,MAAM,OAAV,EAAZ;AACA,MAAK,MAAL,GAAc,IAAI,MAAM,OAAV,EAAd;AAEA,CArHD;;AAuHA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,UAAhC,GAA6C,YAAY;;AAExD,KAAI,+BAA+B,KAAK,KAAK,aAA7C;;AAEA,KAAI,WAAW,KAAM,+BAA+B,CAArC,IAA2C,KAAK,UAA/D;AACA,KAAI,aAAa,KAAK,4BAAL,GAAoC,KAAK,UAA1D;;AAEA,MAAK,QAAL,GAAgB,IAAI,YAAJ,CAAkB,WAAW,CAA7B,CAAhB;AACA,MAAK,OAAL,GAAe,IAAI,WAAJ,CAAiB,UAAjB,CAAf;AACA,KAAK,KAAK,WAAV,EAAwB;;AAEvB,OAAK,GAAL,GAAW,IAAI,YAAJ,CAAkB,WAAW,CAA7B,CAAX;AAEA;;AAED;AACA,MAAK,QAAL,CAAe,CAAf;;AAEA,MAAK,QAAL,CAAe,IAAI,MAAM,qBAAV,CAAiC,KAAK,OAAtC,EAA+C,CAA/C,CAAf;;AAEA,MAAK,iBAAL,GAAyB,IAAI,MAAM,sBAAV,CAAkC,KAAK,QAAvC,EAAiD,CAAjD,CAAzB;AACA,MAAK,YAAL,CAAmB,UAAnB,EAA+B,KAAK,iBAApC;;AAEA,KAAK,KAAK,WAAV,EAAwB;;AAEvB,OAAK,YAAL,GAAoB,IAAI,MAAM,sBAAV,CAAkC,IAAI,YAAJ,CAAkB,KAAK,GAAvB,CAAlC,EAAgE,CAAhE,CAApB;AACA,OAAK,YAAL,CAAmB,IAAnB,EAAyB,KAAK,YAA9B;AAEA;;AAED,KAAK,CAAE,KAAK,QAAZ,EAAuB;;AAEtB,OAAK,KAAL,CAAW,KAAX,GAAmB,MAAM,gBAAzB;AACA,OAAK,iBAAL,CAAuB,KAAvB,GAA+B,MAAM,gBAArC;AACA,MAAK,KAAK,WAAV,EAAwB;;AAEvB,QAAK,YAAL,CAAkB,KAAlB,GAA0B,MAAM,gBAAhC;AAEA;AAED;;AAED;AACA,MAAK,QAAL,GAAgB,KAAK,iBAAL,CAAuB,KAAvC;AACA,MAAK,OAAL,GAAe,KAAK,KAAL,CAAW,KAA1B;AACA,KAAK,KAAK,WAAV,EAAwB;;AAEvB,OAAK,GAAL,GAAW,KAAK,YAAL,CAAkB,KAA7B;AAEA;AAED,CAnDD;;AAqDA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,UAAhC,GAA6C,UAAW,IAAX,EAAkB;;AAE9D,MAAK,QAAL,CAAe,IAAf;;AAEA,MAAK,SAAL,CAAe,KAAf,GAAuB,KAAK,YAA5B;;AAEA,MAAK,KAAL,CAAW,WAAX,GAAyB,IAAzB;;AAEA,MAAK,iBAAL,CAAuB,WAAvB,GAAqC,IAArC;;AAEA,KAAK,KAAK,WAAV,EAAwB;;AAEvB,OAAK,YAAL,CAAkB,WAAlB,GAAgC,IAAhC;AAEA;AAED,CAhBD;;AAkBA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,QAAhC,GAA2C,UAAW,IAAX,EAAkB;;AAE5D,KAAI,QAAQ,IAAZ;;AAEA,MAAK,aAAL,GAAqB,CAArB;AACA,MAAK,YAAL,GAAoB,CAApB;AACA,MAAK,iBAAL,GAAyB,CAAzB;AACA,MAAK,mBAAL,GAA2B,CAA3B;;AAEA,MAAK,UAAL,CAAiB,IAAjB,EAAuB,SAAS,YAAT,CAAuB,OAAvB,EAAiC;;AAEvD,MAAI,SAAS,MAAM,aAAnB;;AAEA,MAAK,OAAO,OAAO,SAAnB,EAA+B;AAAE;;AAEhC;AAEA,GAJD,MAIO,IAAK,KAAK,aAAL,CAAmB,SAAnB,IAAgC,MAAM,aAAN,CAAoB,SAApB,IAAiC,CAAtE,EAA0E;;AAEhF;;AAEA,SAAM,WAAN,CAAmB,OAAnB;;AAEA,SAAM,sBAAN,CAA8B,OAA9B,EAAuC,KAAvC;AAEA,GARM,MAQA,IAAK,OAAO,OAAO,kBAAnB,EAAwC;;AAE9C,OAAK,MAAM,YAAN,IAAsB,QAAQ,SAAR,GAAoB,OAAO,qBAAtD,EAA8E;;AAE7E;;AAEA,UAAM,WAAN,CAAmB,OAAnB;;AAEA,UAAM,sBAAN,CAA8B,OAA9B,EAAuC,KAAvC;AAEA;AAED,GAZM,MAYA,IAAK,OAAO,OAAO,kBAAnB,EAAwC;;AAE9C;;AAEA,SAAM,WAAN,CAAmB,OAAnB;;AAEA,SAAM,sBAAN,CAA8B,OAA9B,EAAuC,KAAvC;AAEA,GARM,MAQA;;AAEN,OAAK,MAAM,YAAN,IAAsB,OAAO,mBAAP,GAA6B,QAAQ,SAAR,IAAsB,IAAI,OAAO,mBAAjC,CAAxD,EAAiH;;AAEhH;;AAEA,UAAM,WAAN,CAAmB,OAAnB;AAEA;;AAED,SAAM,sBAAN,CAA8B,OAA9B,EAAuC,KAAvC;AAEA;AAED,EAlDD;AAoDA,CA7DD;;AA+DA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,YAAhC,GAA+C,YAAW,iBAAoB;;AAE7E,QAAO,KAAK,OAAL,CAAc,KAAK,UAAL,EAAd,CAAP;AAEA,CAJD;;AAMA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,UAAhC,GAA6C,UAAW,MAAX,EAAmB,aAAnB,EAAmC;;AAE/E,QAAO,IAAP,CAAY,IAAZ,CAAkB,cAAc,YAAhC;AACA,QAAO,IAAP,CAAY,IAAZ,CAAkB,cAAc,UAAhC;AACA,QAAO,GAAP,CAAW,IAAX,CAAiB,cAAc,GAA/B;AACA,QAAO,GAAP,CAAW,IAAX,CAAiB,cAAc,GAA/B;AACA,QAAO,OAAP,GAAiB,cAAc,OAA/B;AACA,QAAO,OAAP,GAAiB,cAAc,OAA/B;AACA,QAAO,SAAP,GAAmB,cAAc,SAAjC;AACA,QAAO,SAAP,GAAmB,cAAc,SAAjC;AACA,QAAO,SAAP,GAAmB,cAAc,SAAjC;AACA,QAAO,SAAP,GAAmB,cAAc,SAAjC;AACA,QAAO,YAAP,GAAsB,cAAc,YAApC;AACA,QAAO,qBAAP,GAA+B,cAAc,qBAA7C;AACA,QAAO,mBAAP,GAA6B,cAAc,mBAA3C;;AAEA,QAAO,aAAP,GAAuB,KAAK,aAA5B;AACA,QAAO,IAAP,GAAc,cAAc,SAAd,KAA4B,SAA5B,GAAwC,cAAc,SAAtD,GAAkE,CAAhF;AACA,QAAO,SAAP,GAAmB,CAAnB;AAEA,CApBD;;AAsBA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,UAAhC,GAA6C,UAAW,IAAX,EAAiB,eAAjB,EAAmC;;AAE/E,MAAK,IAAL,GAAY,IAAZ;AACA,MAAK,sBAAL,GAA8B,eAA9B;AACA,MAAK,UAAL,GAAkB,CAAlB;;AAEA;AACA,MAAK,UAAL,CAAiB,KAAK,YAAL,EAAjB,EAAsC,KAAK,aAA3C;;AAEA;AACA,MAAM,IAAI,cAAc,CAAxB,EAA2B,cAAc,KAAK,UAA9C,EAA0D,aAA1D,EAA2E;;AAE1E,MAAI,SAAS,KAAK,OAAL,CAAc,WAAd,CAAb;AACA,OAAK,aAAL,GAAqB,MAArB;;AAEA,OAAK,eAAL,CAAqB,OAArB,CAA8B,OAAO,IAArC;;AAEA,SAAO,kBAAP,GAA4B,MAAM,SAAN,CAAgB,IAAhB,CAAsB,OAAO,SAA7B,EAAwC,OAAO,SAA/C,EAA0D,OAAO,qBAAjE,CAA5B;AACA,SAAO,kBAAP,GAA4B,MAAM,SAAN,CAAgB,IAAhB,CAAsB,OAAO,SAA7B,EAAwC,OAAO,SAA/C,EAA0D,IAAI,OAAO,mBAArE,CAA5B;;AAEA,MAAI,UAAU,KAAK,eAAL,CAAqB,MAAnC;AACA,SAAO,OAAP,CAAe,GAAf,CAAoB,SAApB,EAA+B,SAA/B,EAA0C,SAA1C,EAAsD,cAAtD,CAAsE,IAAtE;AACA,SAAO,OAAP,CAAe,GAAf,CAAoB,SAApB,EAA+B,SAA/B,EAA0C,SAA1C,EAAsD,cAAtD,CAAsE,IAAtE;;AAEA,OAAK,YAAL,GAAoB,CAAE,OAAO,OAAO,SAAhB,KAAgC,OAAO,SAAP,GAAmB,OAAO,SAA1D,CAApB;;AAEA,OAAK,mBAAL,GAA2B,CAA3B;AACA,OAAK,gBAAL,GAAwB,IAAxB;;AAEA,MAAI,UAAU,KAAK,aAAL,EAAd;AACA,UAAQ,SAAR,GAAoB,CAApB;AACA,UAAQ,IAAR,CAAa,IAAb,CAAmB,OAAO,IAA1B;AACA,UAAQ,IAAR,CAAa,IAAb,CAAmB,OAAO,IAA1B;AACA,UAAQ,OAAR,CAAgB,IAAhB,CAAsB,OAAO,OAA7B;AACA,UAAQ,OAAR,CAAgB,IAAhB,CAAsB,OAAO,OAA7B;AACA,UAAQ,GAAR,CAAY,IAAZ,CAAkB,OAAO,GAAzB;AACA,UAAQ,GAAR,CAAY,IAAZ,CAAkB,OAAO,GAAzB;AACA,UAAQ,OAAR,GAAkB,OAAO,OAAzB;AACA,UAAQ,OAAR,GAAkB,OAAO,OAAzB;AACA,UAAQ,SAAR,GAAoB,CAApB;AACA,UAAQ,SAAR,GAAoB,CAApB;AACA,UAAQ,uBAAR,GAAkC,IAAI,OAAO,YAA7C;;AAEA,OAAK,iBAAL,GAAyB,KAAK,YAAL,GAAoB,KAAK,GAAL,CAAU,KAAK,oBAAf,EAAqC,OAAO,SAA5C,CAApB,IAAgF,KAAK,OAAO,aAA5F,CAAzB;;AAEA,OAAK,mBAAL,CAA0B,OAA1B;AAEA;;AAED,MAAK,sBAAL,GAA8B,IAA9B;AACA,MAAK,aAAL,GAAqB,IAArB;AAEA,CApDD;;AAsDA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,mBAAhC,GAAsD,UAAW,OAAX,EAAqB;;AAE1E;AACA,KAAK,QAAQ,SAAR,IAAqB,KAAK,aAAL,CAAmB,aAA7C,EAA6D;;AAE5D,OAAK,sBAAL,CAA6B,OAA7B;;AAEA;AAEA;;AAED;AACA,MAAK,QAAL,CAAc,UAAd,CAA0B,QAAQ,IAAlC,EAAwC,QAAQ,IAAhD;AACA,KAAI,YAAY,KAAK,QAAL,CAAc,MAAd,EAAhB;;AAEA,KAAK,YAAY,QAAjB,EAA4B;;AAE3B,OAAK,QAAL,CAAc,GAAd,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,IAAzB;AACA,cAAY,KAAK,QAAL,CAAc,MAAd,EAAZ;AAEA;;AAED,KAAI,eAAe,CAAE,QAAQ,OAAR,GAAkB,QAAQ,OAA5B,IAAwC,GAA3D;AACA,KAAI,iBAAiB,CAAE,QAAQ,SAAR,GAAoB,QAAQ,SAA9B,IAA4C,GAAjE;;AAEA,KAAI,gBAAgB,KAAK,IAAL,GAAY,KAAK,aAAL,CAAmB,SAA/B,GAA2C,KAAK,GAAL,CAAU,CAAV,EAAa,QAAQ,SAArB,CAA/D;;AAEA,MAAK,SAAL,CAAe,WAAf,CAA4B,QAAQ,IAApC,EAA0C,QAAQ,IAAlD,EAAwD,GAAxD;AACA,MAAK,YAAL,CAAkB,WAAlB,CAA+B,QAAQ,OAAvC,EAAgD,QAAQ,OAAxD,EAAiE,GAAjE;AACA,KAAI,IAAI,KAAK,YAAb;;AAEA;AACA,MAAK,MAAL,CAAY,GAAZ,CAAiB,KAAK,QAAL,CAAc,OAAd,CAAuB,EAAE,CAAzB,EAA4B,EAAE,CAA9B,EAAiC,EAAE,CAAnC,EAAsC,aAAtC,CAAjB,EACC,KAAK,QAAL,CAAc,OAAd,CAAuB,EAAE,CAAzB,EAA4B,EAAE,CAA9B,EAAiC,EAAE,CAAnC,EAAsC,aAAtC,CADD,EAEC,KAAK,QAAL,CAAc,OAAd,CAAuB,EAAE,CAAzB,EAA4B,EAAE,CAA9B,EAAiC,EAAE,CAAnC,EAAsC,aAAtC,CAFD;;AAIA,MAAK,MAAL,CAAY,cAAZ,CAA4B,QAAQ,uBAAR,GAAkC,SAA9D;AACA,MAAK,MAAL,CAAY,GAAZ,CAAiB,KAAK,SAAtB;;AAEA;;AAEA,KAAI,cAAc,KAAK,aAAL,EAAlB;AACA,aAAY,IAAZ,CAAiB,IAAjB,CAAuB,QAAQ,IAA/B;AACA,aAAY,IAAZ,CAAiB,IAAjB,CAAuB,KAAK,MAA5B;AACA,aAAY,OAAZ,CAAoB,IAApB,CAA0B,QAAQ,OAAlC;AACA,aAAY,OAAZ,CAAoB,IAApB,CAA0B,KAAK,YAA/B;AACA,aAAY,GAAZ,CAAgB,IAAhB,CAAsB,QAAQ,GAA9B;AACA,aAAY,GAAZ,CAAgB,IAAhB,CAAsB,QAAQ,GAA9B;AACA,aAAY,OAAZ,GAAsB,QAAQ,OAA9B;AACA,aAAY,OAAZ,GAAsB,YAAtB;AACA,aAAY,SAAZ,GAAwB,QAAQ,SAAhC;AACA,aAAY,SAAZ,GAAwB,cAAxB;AACA,aAAY,uBAAZ,GAAsC,QAAQ,uBAAR,GAAkC,KAAK,aAAL,CAAmB,SAA3F;AACA,aAAY,SAAZ,GAAwB,QAAQ,SAAR,GAAoB,CAA5C;;AAEA,KAAI,cAAc,KAAK,aAAL,EAAlB;AACA,aAAY,IAAZ,CAAiB,IAAjB,CAAuB,KAAK,MAA5B;AACA,aAAY,IAAZ,CAAiB,IAAjB,CAAuB,QAAQ,IAA/B;AACA,aAAY,OAAZ,CAAoB,IAApB,CAA0B,KAAK,YAA/B;AACA,aAAY,OAAZ,CAAoB,IAApB,CAA0B,QAAQ,OAAlC;AACA,MAAK,MAAL,CAAY,YAAZ,CAA0B,QAAQ,GAAlC,EAAuC,KAAK,QAAL,CAAc,SAAd,EAAvC;AACA,aAAY,GAAZ,CAAgB,YAAhB,CAA8B,KAAK,QAAnC,EAA6C,KAAK,MAAlD,EAA2D,SAA3D;AACA,aAAY,GAAZ,CAAgB,IAAhB,CAAsB,QAAQ,GAA9B;AACA,aAAY,OAAZ,GAAsB,YAAtB;AACA,aAAY,OAAZ,GAAsB,QAAQ,OAA9B;AACA,aAAY,SAAZ,GAAwB,cAAxB;AACA,aAAY,SAAZ,GAAwB,QAAQ,SAAhC;AACA,aAAY,uBAAZ,GAAsC,QAAQ,uBAAR,GAAkC,KAAK,aAAL,CAAmB,SAA3F;AACA,aAAY,SAAZ,GAAwB,QAAQ,SAAR,GAAoB,CAA5C;;AAEA,MAAK,mBAAL,CAA0B,WAA1B;;AAEA,MAAK,mBAAL,CAA0B,WAA1B;AAEA,CA1ED;;AA4EA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,WAAhC,GAA8C,UAAW,OAAX,EAAqB;;AAElE;;AAEA,MAAK,YAAL,CAAkB,UAAlB,CAA8B,QAAQ,IAAtC,EAA4C,QAAQ,IAApD,EAA2D,SAA3D;;AAEA,KAAK,KAAK,gBAAV,EAA6B;;AAE5B,OAAK,6BAAL,CAAoC,QAAQ,IAA5C,EAAkD,QAAQ,GAA1D,EAA+D,KAAK,YAApE,EAAkF,QAAQ,OAA1F,EAAmG,CAAnG;;AAEA,OAAK,gBAAL,GAAwB,KAAxB;AAEA;;AAED,MAAK,6BAAL,CAAoC,QAAQ,IAA5C,EAAkD,QAAQ,GAA1D,EAA+D,KAAK,YAApE,EAAkF,QAAQ,OAA1F,EAAmG,QAAQ,SAA3G;;AAEA,MAAK,gBAAL;AAEA,CAlBD;;AAoBA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,gCAAhC,GAAmE,UAAW,GAAX,EAAgB,EAAhB,EAAoB,QAApB,EAA8B,MAA9B,EAAuC;;AAEzG;;AAEA,MAAK,IAAL,CAAU,YAAV,CAAwB,EAAxB,EAA4B,QAA5B,EAAuC,cAAvC,CAAuD,SAAS,MAAM,eAAN,CAAsB,QAAtF;AACA,MAAK,IAAL,CAAU,IAAV,CAAgB,EAAhB,EAAqB,cAArB,CAAqC,CAAE,MAAF,GAAW,MAAM,eAAN,CAAsB,QAAtE;;AAEA,KAAI,IAAI,KAAK,IAAb;AACA,KAAI,IAAI,KAAK,QAAb;;AAEA,GAAE,IAAF,CAAQ,GAAR,EAAc,GAAd,CAAmB,KAAK,IAAxB,EAA+B,GAA/B,CAAoC,KAAK,IAAzC;;AAEA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;;AAEA,GAAE,IAAF,CAAQ,GAAR,EAAc,GAAd,CAAmB,KAAK,IAAxB,EAA+B,GAA/B,CAAoC,KAAK,IAAzC;;AAEA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;;AAEA,GAAE,IAAF,CAAQ,EAAR,EAAa,cAAb,CAA6B,MAA7B,EAAsC,GAAtC,CAA2C,GAA3C;;AAEA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;;AAEA,MAAK,aAAL,IAAsB,CAAtB;AAEA,CA9BD;;AAgCA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,6BAAhC,GAAgE,UAAW,GAAX,EAAgB,EAAhB,EAAoB,QAApB,EAA8B,MAA9B,EAAsC,CAAtC,EAA0C;;AAEzG;;AAEA,MAAK,IAAL,CAAU,YAAV,CAAwB,EAAxB,EAA4B,QAA5B,EAAuC,cAAvC,CAAuD,SAAS,MAAM,eAAN,CAAsB,QAAtF;AACA,MAAK,IAAL,CAAU,IAAV,CAAgB,EAAhB,EAAqB,cAArB,CAAqC,CAAE,MAAF,GAAW,MAAM,eAAN,CAAsB,QAAtE;;AAEA,KAAI,IAAI,KAAK,IAAb;AACA,KAAI,IAAI,KAAK,QAAb;AACA,KAAI,KAAK,KAAK,GAAd;;AAEA,GAAE,IAAF,CAAQ,GAAR,EAAc,GAAd,CAAmB,KAAK,IAAxB,EAA+B,GAA/B,CAAoC,KAAK,IAAzC;;AAEA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;;AAEA,IAAI,KAAK,mBAAL,EAAJ,IAAoC,CAApC;AACA,IAAI,KAAK,mBAAL,EAAJ,IAAoC,CAApC;;AAEA,GAAE,IAAF,CAAQ,GAAR,EAAc,GAAd,CAAmB,KAAK,IAAxB,EAA+B,GAA/B,CAAoC,KAAK,IAAzC;;AAEA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;;AAEA,IAAI,KAAK,mBAAL,EAAJ,IAAoC,CAApC;AACA,IAAI,KAAK,mBAAL,EAAJ,IAAoC,GAApC;;AAEA,GAAE,IAAF,CAAQ,EAAR,EAAa,cAAb,CAA6B,MAA7B,EAAsC,GAAtC,CAA2C,GAA3C;;AAEA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;AACA,GAAG,KAAK,iBAAL,EAAH,IAAiC,EAAE,CAAnC;;AAEA,IAAI,KAAK,mBAAL,EAAJ,IAAoC,CAApC;AACA,IAAI,KAAK,mBAAL,EAAJ,IAAoC,CAApC;;AAEA,MAAK,aAAL,IAAsB,CAAtB;AAEA,CAxCD;;AA0CA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,gBAAhC,GAAmD,UAAW,MAAX,CAAiB,WAAjB,EAA+B;;AAEjF,KAAI,UAAU,KAAK,OAAnB;AACA,KAAI,SAAS,KAAK,aAAL,GAAqB,CAAlC;;AAEA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AACA,SAAS,KAAK,YAAL,EAAT,IAAkC,SAAS,CAA3C;AAEA,CAxBD;;AA0BA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,oCAAhC,GAAuE,YAAY;;AAElF,KAAI,UAAU,KAAK,eAAL,CAAqB,MAAnC;;AAEA,MAAK,sBAAL,GAA8B,UAAW,OAAX,EAAoB,eAApB,EAAsC;;AAEnE;;AAEA,MAAI,SAAS,gBAAgB,aAA7B;;AAEA,MAAI,SAAS,gBAAgB,aAAhB,CAA8B,YAA3C;AACA,MAAI,YAAY,gBAAgB,aAAhB,CAA8B,eAA9C;;AAEA,MAAI,SAAW,gBAAgB,aAAhB,CAA8B,SAA9B,IAA2C,OAAO,SAAP,IAAoB,CAAjE,GAAuE,CAAE,SAAF,GAAc,MAArF,GAA8F,MAAM,SAAN,CAAgB,IAAhB,CAAsB,OAAO,SAA7B,EAAwC,OAAO,kBAA/C,EAAmE,QAAQ,SAA3E,IAAyF,YAAY,MAAhN;;AAEA,MAAI,QAAQ,gBAAgB,IAAhB,GAAuB,MAAnC;AACA,MAAI,eAAe,KAAK,KAAL,CAAY,QAAQ,MAApB,CAAnB;;AAEA,MAAI,kBAAkB,aAAc,eAAe,CAA7B,CAAtB;;AAEA,MAAI,WAAW,QAAQ,MAAR,IAAkB,YAAY,MAA7C;;AAEA,MAAI,cAAc,CAAlB;;AAEA,MAAK,QAAL,EAAgB;;AAEf,iBAAc,gBAAgB,iBAA9B;AACA;AAEA;;AAED,MAAK,OAAO,SAAP,GAAmB,gBAAgB,kBAAnC,IAAyD,gBAAgB,UAAhB,GAA6B,gBAAgB,UAAtG,IAAoH,YAAY,WAArI,EAAmJ;;AAElJ,OAAI,cAAc,gBAAgB,YAAhB,EAAlB;;AAEA,OAAI,aAAa,gBAAgB,eAAhB,CAAgC,OAAhC,EAAjB;AACA,eAAY,IAAZ,GAAmB,eAAnB;AACA,mBAAgB,eAAhB,CAAgC,OAAhC,CAAyC,eAAzC;;AAEA,eAAY,SAAZ,GAAwB,OAAO,SAAP,GAAmB,CAA3C;AACA,eAAY,aAAZ,GAA4B,KAAK,GAAL,CAAU,CAAV,EAAa,OAAO,aAAP,GAAuB,CAApC,CAA5B;;AAEA,eAAY,OAAZ,CAAoB,GAApB,CAAyB,SAAzB,EAAoC,SAApC,EAA+C,SAA/C,EAA2D,cAA3D,CAA2E,IAA3E;AACA,eAAY,OAAZ,CAAoB,GAApB,CAAyB,SAAzB,EAAoC,SAApC,EAA+C,SAA/C,EAA2D,cAA3D,CAA2E,IAA3E;AACA,eAAY,GAAZ,CAAgB,IAAhB,CAAsB,OAAO,GAA7B;AACA,eAAY,GAAZ,CAAgB,IAAhB,CAAsB,OAAO,GAA7B;AACA,eAAY,OAAZ,GAAsB,QAAQ,OAAR,GAAkB,gBAAgB,aAAhB,CAA8B,aAAtE;AACA,eAAY,OAAZ,GAAsB,KAAK,GAAL,CAAU,gBAAgB,aAAhB,CAA8B,SAAxC,EAAmD,QAAQ,OAAR,GAAkB,gBAAgB,aAAhB,CAA8B,aAAnG,CAAtB;;AAEA,eAAY,SAAZ,GAAwB,SAAW,YAAF,GAAmB,MAApD;AACA,eAAY,SAAZ,GAAwB,YAAY,SAAZ,GAAwB,SAAS,SAAzD;;AAEA,OAAK,CAAE,gBAAgB,aAAhB,CAA8B,SAAhC,IAA6C,OAAO,SAAP,IAAoB,CAAtE,EAA0E;;AAEzE,gBAAY,SAAZ,GAAwB,KAAK,GAAL,CAAU,YAAY,SAAtB,EAAiC,OAAO,SAAxC,CAAxB;AACA,gBAAY,SAAZ,GAAwB,KAAK,GAAL,CAAU,YAAY,SAAtB,EAAiC,OAAO,SAAxC,CAAxB;AAEA;;AAED,eAAY,SAAZ,GAAwB,OAAO,SAAP,GAAmB,CAA3C;AACA,eAAY,SAAZ,GAAwB,OAAO,SAA/B;AACA,eAAY,YAAZ,GAA2B,OAAO,YAAlC;AACA,eAAY,qBAAZ,GAAoC,OAAO,qBAA3C;AACA,eAAY,mBAAZ,GAAkC,OAAO,mBAAzC;;AAEA,mBAAgB,gBAAhB,CAAkC,OAAlC,EAA2C,MAA3C,EAAmD,WAAnD,EAAgE,eAAhE;;AAEA,mBAAgB,eAAhB,CAAgC,OAAhC,CAAyC,UAAzC;AAEA;AAED,EAnED;;AAqEA,KAAI,UAAU,IAAI,MAAM,OAAV,EAAd;AACA,KAAI,cAAc,IAAI,MAAM,OAAV,EAAlB;AACA,KAAI,WAAW,IAAI,MAAM,OAAV,EAAf;AACA,KAAI,SAAS,IAAI,MAAM,OAAV,EAAb;;AAEA,MAAK,gBAAL,GAAwB,UAAW,OAAX,EAAoB,YAApB,EAAkC,WAAlC,EAA+C,eAA/C,EAAiE;;AAExF;;AAEA;AACA,kBAAgB,sBAAhB,CAAwC,OAAxC,EAAiD,YAAjD,EAA+D,WAA/D,EAA4E,GAA5E,EAAiF,GAAjF,EAAsF,GAAtF;AAEA,EAPD;;AASA,MAAK,kBAAL,GAA0B,UAAW,OAAX,EAAoB,YAApB,EAAkC,WAAlC,EAA+C,YAA/C,EAA6D,eAA7D,EAA8E,kBAA9E,EAAmG;;AAE5H;;AAEA,cAAY,IAAZ,CAAiB,IAAjB,CAAuB,QAAQ,IAA/B;;AAEA,UAAQ,UAAR,CAAoB,aAAa,IAAjC,EAAuC,aAAa,IAApD;AACA,cAAY,IAAZ,CAAkB,OAAlB,EAA4B,SAA5B;AACA,UAAQ,cAAR,CAAwB,QAAQ,SAAR,GAAoB,CAAE,IAAI,QAAQ,SAAd,KAA8B,YAAY,YAA1C,CAA5C;AACA,MAAI,SAAS,QAAQ,MAAR,EAAb;AACA,WAAS,YAAT,CAAuB,aAAa,GAApC,EAAyC,WAAzC;AACA,MAAI,QAAQ,IAAI,KAAK,EAAT,GAAc,SAA1B;AACA,WAAS,cAAT,CAAyB,KAAK,GAAL,CAAU,KAAV,CAAzB;AACA,SAAO,IAAP,CAAa,aAAa,GAA1B,EAAgC,cAAhC,CAAgD,KAAK,GAAL,CAAU,KAAV,CAAhD;;AAEA,cAAY,IAAZ,CAAiB,IAAjB,CAAuB,QAAvB,EAAkC,GAAlC,CAAuC,MAAvC,EAAgD,cAAhD,CAAgE,SAAS,eAAT,IAA6B,qBAAqB,aAAc,IAAI,kBAAlB,CAAlD,CAAhE,EAA6J,GAA7J,CAAkK,OAAlK,EAA4K,GAA5K,CAAiL,aAAa,IAA9L;AAEA,EAjBD;;AAmBA,MAAK,sBAAL,GAA8B,UAAW,OAAX,EAAoB,YAApB,EAAkC,WAAlC,EAA+C,YAA/C,EAA6D,eAA7D,EAA8E,kBAA9E,EAAmG;;AAEhI;;AAEA,cAAY,IAAZ,CAAiB,IAAjB,CAAuB,QAAQ,IAA/B;;AAEA,UAAQ,UAAR,CAAoB,aAAa,IAAjC,EAAuC,aAAa,IAApD;AACA,cAAY,IAAZ,CAAkB,OAAlB,EAA4B,SAA5B;AACA,UAAQ,cAAR,CAAwB,QAAQ,SAAR,GAAoB,CAAE,IAAI,QAAQ,SAAd,KAA8B,CAAE,IAAI,SAAJ,GAAgB,CAAlB,IAAwB,YAAtD,CAA5C;AACA,MAAI,SAAS,QAAQ,MAAR,EAAb;AACA,WAAS,YAAT,CAAuB,aAAa,GAApC,EAAyC,WAAzC;AACA,MAAI,QAAQ,IAAI,KAAK,EAAT,GAAc,SAA1B;AACA,WAAS,cAAT,CAAyB,KAAK,GAAL,CAAU,KAAV,CAAzB;AACA,SAAO,IAAP,CAAa,aAAa,GAA1B,EAAgC,cAAhC,CAAgD,KAAK,GAAL,CAAU,KAAV,CAAhD;;AAEA,cAAY,IAAZ,CAAiB,IAAjB,CAAuB,QAAvB,EAAkC,GAAlC,CAAuC,MAAvC,EAAgD,cAAhD,CAAgE,SAAS,eAAT,IAA6B,qBAAqB,aAAc,IAAI,kBAAlB,CAAlD,CAAhE,EAA6J,GAA7J,CAAkK,OAAlK,EAA4K,GAA5K,CAAiL,aAAa,IAA9L;AAEA,EAjBD;AAmBA,CA7HD;;AA+HA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,YAAhC,GAA+C,YAAY;;AAE1D,QAAO;;AAEN,QAAM,CAFA;AAGN,iBAAe,CAHT;AAIN,aAAW,CAJL;AAKN,QAAM,IAAI,MAAM,OAAV,EALA;AAMN,QAAM,IAAI,MAAM,OAAV,EANA;AAON,WAAS,IAAI,MAAM,OAAV,EAPH;AAQN,WAAS,IAAI,MAAM,OAAV,EARH;AASN,OAAK,IAAI,MAAM,OAAV,EATC;AAUN,OAAK,IAAI,MAAM,OAAV,EAVC;AAWN,WAAS,CAXH;AAYN,WAAS,CAZH;AAaN,aAAW,CAbL;AAcN,aAAW,CAdL;AAeN,aAAW,CAfL;AAgBN,aAAW,CAhBL;AAiBN,gBAAc,CAjBR;AAkBN,yBAAuB,CAlBjB;AAmBN,uBAAqB,CAnBf;AAoBN,sBAAoB,CApBd;AAqBN,sBAAoB;;AArBd,EAAP;AAyBA,CA3BD;;AA6BA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,aAAhC,GAAgD,YAAY;;AAE3D,QAAO;AACN,aAAW,CADL;AAEN,QAAM,IAAI,MAAM,OAAV,EAFA;AAGN,QAAM,IAAI,MAAM,OAAV,EAHA;AAIN,WAAS,IAAI,MAAM,OAAV,EAJH;AAKN,WAAS,IAAI,MAAM,OAAV,EALH;AAMN,OAAK,IAAI,MAAM,OAAV,EANC;AAON,OAAK,IAAI,MAAM,OAAV,EAPC;AAQN,WAAS,CARH;AASN,WAAS,CATH;AAUN,aAAW,CAVL;AAWN,aAAW,CAXL;AAYN,2BAAyB;AAZnB,EAAP;AAeA,CAjBD;;AAmBA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,aAAhC,GAAgD,YAAY;;AAE3D,QAAO,KAAK,WAAL,CAAkB,KAAK,mBAAL,EAAlB,CAAP;AAEA,CAJD;;AAMA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,IAAhC,GAAuC,UAAW,MAAX,EAAoB;;AAE1D,OAAM,cAAN,CAAqB,SAArB,CAA+B,IAA/B,CAAoC,IAApC,CAA0C,IAA1C,EAAgD,MAAhD;;AAEA,MAAK,IAAL,CAAW,MAAM,eAAN,CAAsB,cAAtB,CAAsC,EAAtC,EAA0C,OAAO,aAAjD,CAAX;;AAEA,QAAO,IAAP;AAEA,CARD;;AAUA,MAAM,eAAN,CAAsB,SAAtB,CAAgC,KAAhC,GAAwC,YAAY;;AAEnD,QAAO,IAAI,KAAK,WAAT,CAAsB,MAAM,eAAN,CAAsB,cAAtB,CAAsC,EAAtC,EAA0C,KAAK,aAA/C,CAAtB,CAAP;AAEA,CAJD","file":"LightningStrike-compiled.js","sourcesContent":["console.warn( \"THREE.LightningStrike: As part of the transition to ES6 Modules, the files in 'examples/js' were deprecated in May 2020 (r117) and will be deleted in December 2020 (r124). You can find more information about developing using ES6 Modules in https://threejs.org/docs/#manual/en/introduction/Installation.\" );\n/**\n * @fileoverview LightningStrike object for creating lightning strikes and voltaic arcs.\n *\n *\n * Usage\n *\n * var myRay = new THREE.LightningStrike( paramsObject );\n * var myRayMesh = new THREE.Mesh( myRay, myMaterial );\n * scene.add( myRayMesh );\n * ...\n * myRay.update( currentTime );\n *\n * The \"currentTime\" can vary its rate, go forwards, backwards or even jump, but it cannot be negative.\n *\n * You should normally leave the ray position to (0, 0, 0). You should control it by changing the sourceOffset and destOffset parameters.\n *\n *\n * LightningStrike parameters\n *\n * The paramsObject can contain any of the following parameters.\n *\n * Legend:\n * 'LightningStrike' (also called 'ray'): An independent voltaic arc with its ramifications and defined with a set of parameters.\n * 'Subray': A ramification of the ray. It is not a LightningStrike object.\n * 'Segment': A linear segment piece of a subray.\n * 'Leaf segment': A ray segment which cannot be smaller.\n *\n *\n * The following parameters can be changed any time and if they vary smoothly, the ray form will also change smoothly:\n *\n * @param {Vector3} sourceOffset The point where the ray starts.\n *\n * @param {Vector3} destOffset The point where the ray ends.\n *\n * @param {double} timeScale The rate at wich the ray form changes in time. Default: 1\n *\n * @param {double} roughness From 0 to 1. The higher the value, the more wrinkled is the ray. Default: 0.9\n *\n * @param {double} straightness From 0 to 1. The higher the value, the more straight will be a subray path. Default: 0.7\n *\n * @param {Vector3} up0 Ray 'up' direction at the ray starting point. Must be normalized. It should be perpendicular to the ray forward direction but it doesn't matter much.\n *\n * @param {Vector3} up1 Like the up0 parameter but at the end of the ray. Must be normalized.\n *\n * @param {double} radius0 Radius of the main ray trunk at the start point. Default: 1\n *\n * @param {double} radius1 Radius of the main ray trunk at the end point. Default: 1\n *\n * @param {double} radius0Factor The radius0 of a subray is this factor times the radius0 of its parent subray. Default: 0.5\n *\n * @param {double} radius1Factor The radius1 of a subray is this factor times the radius1 of its parent subray. Default: 0.2\n *\n * @param {minRadius} Minimum value a subray radius0 or radius1 can get. Default: 0.1\n *\n *\n * The following parameters should not be changed after lightning creation. They can be changed but the ray will change its form abruptly:\n *\n * @param {boolean} isEternal If true the ray never extinguishes. Otherwise its life is controlled by the 'birthTime' and 'deathTime' parameters. Default: true if any of those two parameters is undefined.\n *\n * @param {double} birthTime The time at which the ray starts its life and begins propagating. Only if isEternal is false. Default: None.\n *\n * @param {double} deathTime The time at which the ray ends vanishing and its life. Only if isEternal is false. Default: None.\n *\n * @param {double} propagationTimeFactor From 0 to 1. Lifetime factor at which the ray ends propagating and enters the steady phase. For example, 0.1 means it is propagating 1/10 of its lifetime. Default: 0.1\n *\n * @param {double} vanishingTimeFactor From 0 to 1. Lifetime factor at which the ray ends the steady phase and begins vanishing. For example, 0.9 means it is vanishing 1/10 of its lifetime. Default: 0.9\n *\n * @param {double} subrayPeriod Subrays cycle periodically. This is their time period. Default: 4\n *\n * @param {double} subrayDutyCycle From 0 to 1. This is the fraction of time a subray is active. Default: 0.6\n *\n *\n * These parameters cannot change after lightning creation:\n *\n * @param {integer} maxIterations: Greater than 0. The number of ray's leaf segments is 2**maxIterations. Default: 9\n *\n * @param {boolean} isStatic Set to true only for rays which won't change over time and are not attached to moving objects (Rare case). It is used to set the vertex buffers non-dynamic. You can omit calling update() for these rays.\n *\n * @param {integer} ramification Greater than 0. Maximum number of child subrays a subray can have. Default: 5\n *\n * @param {integer} maxSubrayRecursion Greater than 0. Maximum level of recursion (subray descendant generations). Default: 3\n *\n * @param {double} recursionProbability From 0 to 1. The lower the value, the less chance each new generation of subrays has to generate new subrays. Default: 0.6\n *\n * @param {boolean} generateUVs If true, the ray geometry will have uv coordinates generated. u runs along the ray, and v across its perimeter. Default: false.\n *\n * @param {Object} randomGenerator Set here your random number generator which will seed the SimplexNoise and other decisions during ray tree creation.\n * It can be used to generate repeatable rays. For that, set also the noiseSeed parameter, and each ray created with that generator and seed pair will be identical in time.\n * The randomGenerator parameter should be an object with a random() function similar to Math.random, but seedable.\n * It must have also a getSeed() method, which returns the current seed, and a setSeed( seed ) method, which accepts as seed a fractional number from 0 to 1, as well as any other number.\n * The default value is an internal generator for some uses and Math.random for others (It is non-repeatable even if noiseSeed is supplied)\n *\n * @param {double} noiseSeed Seed used to make repeatable rays (see the randomGenerator)\n *\n * @param {function} onDecideSubrayCreation Set this to change the callback which decides subray creation. You can look at the default callback in the code (createDefaultSubrayCreationCallbacks)for more info.\n *\n * @param {function} onSubrayCreation This is another callback, more simple than the previous one. It can be used to adapt the form of subrays or other parameters once a subray has been created and initialized. It is used in the examples to adapt subrays to a sphere or to a plane.\n *\n *\n*/\n\nTHREE.LightningStrike = function ( rayParameters ) {\n\n\tTHREE.BufferGeometry.call( this );\n\n\tthis.type = 'LightningStrike';\n\n\t// Set parameters, and set undefined parameters to default values\n\trayParameters = rayParameters || {};\n\tthis.init( THREE.LightningStrike.copyParameters( rayParameters, rayParameters ) );\n\n\t// Creates and populates the mesh\n\tthis.createMesh();\n\n};\n\nTHREE.LightningStrike.prototype = Object.create( THREE.BufferGeometry.prototype );\n\nTHREE.LightningStrike.prototype.constructor = THREE.LightningStrike;\n\nTHREE.LightningStrike.prototype.isLightningStrike = true;\n\n// Ray states\nTHREE.LightningStrike.RAY_INITIALIZED = 0;\nTHREE.LightningStrike.RAY_UNBORN = 1;\nTHREE.LightningStrike.RAY_PROPAGATING = 2;\nTHREE.LightningStrike.RAY_STEADY = 3;\nTHREE.LightningStrike.RAY_VANISHING = 4;\nTHREE.LightningStrike.RAY_EXTINGUISHED = 5;\n\nTHREE.LightningStrike.COS30DEG = Math.cos( 30 * Math.PI / 180 );\nTHREE.LightningStrike.SIN30DEG = Math.sin( 30 * Math.PI / 180 );\n\nTHREE.LightningStrike.createRandomGenerator = function () {\n\n\tvar numSeeds = 2053;\n\tvar seeds = [];\n\n\tfor ( var i = 0; i < numSeeds; i ++ ) {\n\n\t\tseeds.push( Math.random() );\n\n\t}\n\n\tvar generator = {\n\n\t\tcurrentSeed: 0,\n\n\t\trandom: function () {\n\n\t\t\tvar value = seeds[ generator.currentSeed ];\n\n\t\t\tgenerator.currentSeed = ( generator.currentSeed + 1 ) % numSeeds;\n\n\t\t\treturn value;\n\n\t\t},\n\n\t\tgetSeed: function () {\n\n\t\t\treturn generator.currentSeed / numSeeds;\n\n\t\t},\n\n\t\tsetSeed: function ( seed ) {\n\n\t\t\tgenerator.currentSeed = Math.floor( seed * numSeeds ) % numSeeds;\n\n\t\t}\n\n\t};\n\n\treturn generator;\n\n};\n\nTHREE.LightningStrike.copyParameters = function ( dest, source ) {\n\n\tsource = source || {};\n\tdest = dest || {};\n\n\tvar vecCopy = function ( v ) {\n\n\t\tif ( source === dest ) {\n\n\t\t\treturn v;\n\n\t\t} else {\n\n\t\t\treturn v.clone();\n\n\t\t}\n\n\t};\n\n\tdest.sourceOffset = source.sourceOffset !== undefined ? vecCopy( source.sourceOffset ) : new THREE.Vector3( 0, 100, 0 ),\n\tdest.destOffset = source.destOffset !== undefined ? vecCopy( source.destOffset ) : new THREE.Vector3( 0, 0, 0 ),\n\n\tdest.timeScale = source.timeScale !== undefined ? source.timeScale : 1,\n\tdest.roughness = source.roughness !== undefined ? source.roughness : 0.9,\n\tdest.straightness = source.straightness !== undefined ? source.straightness : 0.7,\n\n\tdest.up0 = source.up0 !== undefined ? vecCopy( source.up0 ) : new THREE.Vector3( 0, 0, 1 );\n\tdest.up1 = source.up1 !== undefined ? vecCopy( source.up1 ) : new THREE.Vector3( 0, 0, 1 ),\n\tdest.radius0 = source.radius0 !== undefined ? source.radius0 : 1,\n\tdest.radius1 = source.radius1 !== undefined ? source.radius1 : 1,\n\tdest.radius0Factor = source.radius0Factor !== undefined ? source.radius0Factor : 0.5,\n\tdest.radius1Factor = source.radius1Factor !== undefined ? source.radius1Factor : 0.2,\n\tdest.minRadius = source.minRadius !== undefined ? source.minRadius : 0.2,\n\n\t// These parameters should not be changed after lightning creation. They can be changed but the ray will change its form abruptly:\n\n\tdest.isEternal = source.isEternal !== undefined ? source.isEternal : ( source.birthTime === undefined || source.deathTime === undefined ),\n\tdest.birthTime = source.birthTime,\n\tdest.deathTime = source.deathTime,\n\tdest.propagationTimeFactor = source.propagationTimeFactor !== undefined ? source.propagationTimeFactor : 0.1,\n\tdest.vanishingTimeFactor = source.vanishingTimeFactor !== undefined ? source.vanishingTimeFactor : 0.9,\n\tdest.subrayPeriod = source.subrayPeriod !== undefined ? source.subrayPeriod : 4,\n\tdest.subrayDutyCycle = source.subrayDutyCycle !== undefined ? source.subrayDutyCycle : 0.6;\n\n\t// These parameters cannot change after lightning creation:\n\n\tdest.maxIterations = source.maxIterations !== undefined ? source.maxIterations : 9;\n\tdest.isStatic = source.isStatic !== undefined ? source.isStatic : false;\n\tdest.ramification = source.ramification !== undefined ? source.ramification : 5;\n\tdest.maxSubrayRecursion = source.maxSubrayRecursion !== undefined ? source.maxSubrayRecursion : 3;\n\tdest.recursionProbability = source.recursionProbability !== undefined ? source.recursionProbability : 0.6;\n\tdest.generateUVs = source.generateUVs !== undefined ? source.generateUVs : false;\n\tdest.randomGenerator = source.randomGenerator,\n\tdest.noiseSeed = source.noiseSeed,\n\tdest.onDecideSubrayCreation = source.onDecideSubrayCreation,\n\tdest.onSubrayCreation = source.onSubrayCreation;\n\n\treturn dest;\n\n};\n\nTHREE.LightningStrike.prototype.update = function ( time ) {\n\n\tif ( this.isStatic ) return;\n\n\tif ( this.rayParameters.isEternal || ( this.rayParameters.birthTime <= time && time <= this.rayParameters.deathTime ) ) {\n\n\t\tthis.updateMesh( time );\n\n\t\tif ( time < this.subrays[ 0 ].endPropagationTime ) {\n\n\t\t\tthis.state = THREE.LightningStrike.RAY_PROPAGATING;\n\n\t\t} else if ( time > this.subrays[ 0 ].beginVanishingTime ) {\n\n\t\t\tthis.state = THREE.LightningStrike.RAY_VANISHING;\n\n\t\t} else {\n\n\t\t\tthis.state = THREE.LightningStrike.RAY_STEADY;\n\n\t\t}\n\n\t\tthis.visible = true;\n\n\t} else {\n\n\t\tthis.visible = false;\n\n\t\tif ( time < this.rayParameters.birthTime ) {\n\n\t\t\tthis.state = THREE.LightningStrike.RAY_UNBORN;\n\n\t\t} else {\n\n\t\t\tthis.state = THREE.LightningStrike.RAY_EXTINGUISHED;\n\n\t\t}\n\n\t}\n\n};\n\nTHREE.LightningStrike.prototype.init = function ( rayParameters ) {\n\n\t// Init all the state from the parameters\n\n\tthis.rayParameters = rayParameters;\n\n\t// These parameters cannot change after lightning creation:\n\n\tthis.maxIterations = rayParameters.maxIterations !== undefined ? Math.floor( rayParameters.maxIterations ) : 9;\n\trayParameters.maxIterations = this.maxIterations;\n\tthis.isStatic = rayParameters.isStatic !== undefined ? rayParameters.isStatic : false;\n\trayParameters.isStatic = this.isStatic;\n\tthis.ramification = rayParameters.ramification !== undefined ? Math.floor( rayParameters.ramification ) : 5;\n\trayParameters.ramification = this.ramification;\n\tthis.maxSubrayRecursion = rayParameters.maxSubrayRecursion !== undefined ? Math.floor( rayParameters.maxSubrayRecursion ) : 3;\n\trayParameters.maxSubrayRecursion = this.maxSubrayRecursion;\n\tthis.recursionProbability = rayParameters.recursionProbability !== undefined ? rayParameters.recursionProbability : 0.6;\n\trayParameters.recursionProbability = this.recursionProbability;\n\tthis.generateUVs = rayParameters.generateUVs !== undefined ? rayParameters.generateUVs : false;\n\trayParameters.generateUVs = this.generateUVs;\n\n\t// Random generator\n\tif ( rayParameters.randomGenerator !== undefined ) {\n\n\t\tthis.randomGenerator = rayParameters.randomGenerator;\n\t\tthis.seedGenerator = rayParameters.randomGenerator;\n\n\t\tif ( rayParameters.noiseSeed !== undefined ) {\n\n\t\t\tthis.seedGenerator.setSeed( rayParameters.noiseSeed );\n\n\t\t}\n\n\t} else {\n\n\t\tthis.randomGenerator = THREE.LightningStrike.createRandomGenerator();\n\t\tthis.seedGenerator = Math;\n\n\t}\n\n\t// Ray creation callbacks\n\tif ( rayParameters.onDecideSubrayCreation !== undefined ) {\n\n\t\tthis.onDecideSubrayCreation = rayParameters.onDecideSubrayCreation;\n\n\t} else {\n\n\t\tthis.createDefaultSubrayCreationCallbacks();\n\n\t\tif ( rayParameters.onSubrayCreation !== undefined ) {\n\n\t\t\tthis.onSubrayCreation = rayParameters.onSubrayCreation;\n\n\t\t}\n\n\t}\n\n\t// Internal state\n\n\tthis.state = THREE.LightningStrike.RAY_INITIALIZED;\n\n\tthis.maxSubrays = Math.ceil( 1 + Math.pow( this.ramification, Math.max( 0, this.maxSubrayRecursion - 1 ) ) );\n\trayParameters.maxSubrays = this.maxSubrays;\n\n\tthis.maxRaySegments = 2 * ( 1 << this.maxIterations );\n\n\tthis.subrays = [];\n\n\tfor ( var i = 0; i < this.maxSubrays; i ++ ) {\n\n\t\tthis.subrays.push( this.createSubray() );\n\n\t}\n\n\tthis.raySegments = [];\n\n\tfor ( var i = 0; i < this.maxRaySegments; i ++ ) {\n\n\t\tthis.raySegments.push( this.createSegment() );\n\n\t}\n\n\tthis.time = 0;\n\tthis.timeFraction = 0;\n\tthis.currentSegmentCallback = null;\n\tthis.currentCreateTriangleVertices = this.generateUVs ? this.createTriangleVerticesWithUVs : this.createTriangleVerticesWithoutUVs;\n\tthis.numSubrays = 0;\n\tthis.currentSubray = null;\n\tthis.currentSegmentIndex = 0;\n\tthis.isInitialSegment = false;\n\tthis.subrayProbability = 0;\n\n\tthis.currentVertex = 0;\n\tthis.currentIndex = 0;\n\tthis.currentCoordinate = 0;\n\tthis.currentUVCoordinate = 0;\n\tthis.vertices = null;\n\tthis.uvs = null;\n\tthis.indices = null;\n\tthis.positionAttribute = null;\n\tthis.uvsAttribute = null;\n\n\tthis.simplexX = new THREE.SimplexNoise( this.seedGenerator );\n\tthis.simplexY = new THREE.SimplexNoise( this.seedGenerator );\n\tthis.simplexZ = new THREE.SimplexNoise( this.seedGenerator );\n\n\t// Temp vectors\n\tthis.forwards = new THREE.Vector3();\n\tthis.forwardsFill = new THREE.Vector3();\n\tthis.side = new THREE.Vector3();\n\tthis.down = new THREE.Vector3();\n\tthis.middlePos = new THREE.Vector3();\n\tthis.middleLinPos = new THREE.Vector3();\n\tthis.newPos = new THREE.Vector3();\n\tthis.vPos = new THREE.Vector3();\n\tthis.cross1 = new THREE.Vector3();\n\n};\n\nTHREE.LightningStrike.prototype.createMesh = function () {\n\n\tvar maxDrawableSegmentsPerSubRay = 1 << this.maxIterations;\n\n\tvar maxVerts = 3 * ( maxDrawableSegmentsPerSubRay + 1 ) * this.maxSubrays;\n\tvar maxIndices = 18 * maxDrawableSegmentsPerSubRay * this.maxSubrays;\n\n\tthis.vertices = new Float32Array( maxVerts * 3 );\n\tthis.indices = new Uint32Array( maxIndices );\n\tif ( this.generateUVs ) {\n\n\t\tthis.uvs = new Float32Array( maxVerts * 2 );\n\n\t}\n\n\t// Populate the mesh\n\tthis.fillMesh( 0 );\n\n\tthis.setIndex( new THREE.Uint32BufferAttribute( this.indices, 1 ) );\n\n\tthis.positionAttribute = new THREE.Float32BufferAttribute( this.vertices, 3 );\n\tthis.setAttribute( 'position', this.positionAttribute );\n\n\tif ( this.generateUVs ) {\n\n\t\tthis.uvsAttribute = new THREE.Float32BufferAttribute( new Float32Array( this.uvs ), 2 );\n\t\tthis.setAttribute( 'uv', this.uvsAttribute );\n\n\t}\n\n\tif ( ! this.isStatic ) {\n\n\t\tthis.index.usage = THREE.DynamicDrawUsage;\n\t\tthis.positionAttribute.usage = THREE.DynamicDrawUsage;\n\t\tif ( this.generateUVs ) {\n\n\t\t\tthis.uvsAttribute.usage = THREE.DynamicDrawUsage;\n\n\t\t}\n\n\t}\n\n\t// Store buffers for later modification\n\tthis.vertices = this.positionAttribute.array;\n\tthis.indices = this.index.array;\n\tif ( this.generateUVs ) {\n\n\t\tthis.uvs = this.uvsAttribute.array;\n\n\t}\n\n};\n\nTHREE.LightningStrike.prototype.updateMesh = function ( time ) {\n\n\tthis.fillMesh( time );\n\n\tthis.drawRange.count = this.currentIndex;\n\n\tthis.index.needsUpdate = true;\n\n\tthis.positionAttribute.needsUpdate = true;\n\n\tif ( this.generateUVs ) {\n\n\t\tthis.uvsAttribute.needsUpdate = true;\n\n\t}\n\n};\n\nTHREE.LightningStrike.prototype.fillMesh = function ( time ) {\n\n\tvar scope = this;\n\n\tthis.currentVertex = 0;\n\tthis.currentIndex = 0;\n\tthis.currentCoordinate = 0;\n\tthis.currentUVCoordinate = 0;\n\n\tthis.fractalRay( time, function fillVertices( segment ) {\n\n\t\tvar subray = scope.currentSubray;\n\n\t\tif ( time < subray.birthTime ) { //&& ( ! this.rayParameters.isEternal || scope.currentSubray.recursion > 0 ) ) {\n\n\t\t\treturn;\n\n\t\t} else if ( this.rayParameters.isEternal && scope.currentSubray.recursion == 0 ) {\n\n\t\t\t// Eternal rays don't propagate nor vanish, but its subrays do\n\n\t\t\tscope.createPrism( segment );\n\n\t\t\tscope.onDecideSubrayCreation( segment, scope );\n\n\t\t} else if ( time < subray.endPropagationTime ) {\n\n\t\t\tif ( scope.timeFraction >= segment.fraction0 * subray.propagationTimeFactor ) {\n\n\t\t\t\t// Ray propagation has arrived to this segment\n\n\t\t\t\tscope.createPrism( segment );\n\n\t\t\t\tscope.onDecideSubrayCreation( segment, scope );\n\n\t\t\t}\n\n\t\t} else if ( time < subray.beginVanishingTime ) {\n\n\t\t\t// Ray is steady (nor propagating nor vanishing)\n\n\t\t\tscope.createPrism( segment );\n\n\t\t\tscope.onDecideSubrayCreation( segment, scope );\n\n\t\t} else {\n\n\t\t\tif ( scope.timeFraction <= subray.vanishingTimeFactor + segment.fraction1 * ( 1 - subray.vanishingTimeFactor ) ) {\n\n\t\t\t\t// Segment has not yet vanished\n\n\t\t\t\tscope.createPrism( segment );\n\n\t\t\t}\n\n\t\t\tscope.onDecideSubrayCreation( segment, scope );\n\n\t\t}\n\n\t} );\n\n};\n\nTHREE.LightningStrike.prototype.addNewSubray = function ( /*rayParameters*/ ) {\n\n\treturn this.subrays[ this.numSubrays ++ ];\n\n};\n\nTHREE.LightningStrike.prototype.initSubray = function ( subray, rayParameters ) {\n\n\tsubray.pos0.copy( rayParameters.sourceOffset );\n\tsubray.pos1.copy( rayParameters.destOffset );\n\tsubray.up0.copy( rayParameters.up0 );\n\tsubray.up1.copy( rayParameters.up1 );\n\tsubray.radius0 = rayParameters.radius0;\n\tsubray.radius1 = rayParameters.radius1;\n\tsubray.birthTime = rayParameters.birthTime;\n\tsubray.deathTime = rayParameters.deathTime;\n\tsubray.timeScale = rayParameters.timeScale;\n\tsubray.roughness = rayParameters.roughness;\n\tsubray.straightness = rayParameters.straightness;\n\tsubray.propagationTimeFactor = rayParameters.propagationTimeFactor;\n\tsubray.vanishingTimeFactor = rayParameters.vanishingTimeFactor;\n\n\tsubray.maxIterations = this.maxIterations;\n\tsubray.seed = rayParameters.noiseSeed !== undefined ? rayParameters.noiseSeed : 0;\n\tsubray.recursion = 0;\n\n};\n\nTHREE.LightningStrike.prototype.fractalRay = function ( time, segmentCallback ) {\n\n\tthis.time = time;\n\tthis.currentSegmentCallback = segmentCallback;\n\tthis.numSubrays = 0;\n\n\t// Add the top level subray\n\tthis.initSubray( this.addNewSubray(), this.rayParameters );\n\n\t// Process all subrays that are being generated until consuming all of them\n\tfor ( var subrayIndex = 0; subrayIndex < this.numSubrays; subrayIndex ++ ) {\n\n\t\tvar subray = this.subrays[ subrayIndex ];\n\t\tthis.currentSubray = subray;\n\n\t\tthis.randomGenerator.setSeed( subray.seed );\n\n\t\tsubray.endPropagationTime = THREE.MathUtils.lerp( subray.birthTime, subray.deathTime, subray.propagationTimeFactor );\n\t\tsubray.beginVanishingTime = THREE.MathUtils.lerp( subray.deathTime, subray.birthTime, 1 - subray.vanishingTimeFactor );\n\n\t\tvar random1 = this.randomGenerator.random;\n\t\tsubray.linPos0.set( random1(), random1(), random1() ).multiplyScalar( 1000 );\n\t\tsubray.linPos1.set( random1(), random1(), random1() ).multiplyScalar( 1000 );\n\n\t\tthis.timeFraction = ( time - subray.birthTime ) / ( subray.deathTime - subray.birthTime );\n\n\t\tthis.currentSegmentIndex = 0;\n\t\tthis.isInitialSegment = true;\n\n\t\tvar segment = this.getNewSegment();\n\t\tsegment.iteration = 0;\n\t\tsegment.pos0.copy( subray.pos0 );\n\t\tsegment.pos1.copy( subray.pos1 );\n\t\tsegment.linPos0.copy( subray.linPos0 );\n\t\tsegment.linPos1.copy( subray.linPos1 );\n\t\tsegment.up0.copy( subray.up0 );\n\t\tsegment.up1.copy( subray.up1 );\n\t\tsegment.radius0 = subray.radius0;\n\t\tsegment.radius1 = subray.radius1;\n\t\tsegment.fraction0 = 0;\n\t\tsegment.fraction1 = 1;\n\t\tsegment.positionVariationFactor = 1 - subray.straightness;\n\n\t\tthis.subrayProbability = this.ramification * Math.pow( this.recursionProbability, subray.recursion ) / ( 1 << subray.maxIterations );\n\n\t\tthis.fractalRayRecursive( segment );\n\n\t}\n\n\tthis.currentSegmentCallback = null;\n\tthis.currentSubray = null;\n\n};\n\nTHREE.LightningStrike.prototype.fractalRayRecursive = function ( segment ) {\n\n\t// Leave recursion condition\n\tif ( segment.iteration >= this.currentSubray.maxIterations ) {\n\n\t\tthis.currentSegmentCallback( segment );\n\n\t\treturn;\n\n\t}\n\n\t// Interpolation\n\tthis.forwards.subVectors( segment.pos1, segment.pos0 );\n\tvar lForwards = this.forwards.length();\n\n\tif ( lForwards < 0.000001 ) {\n\n\t\tthis.forwards.set( 0, 0, 0.01 );\n\t\tlForwards = this.forwards.length();\n\n\t}\n\n\tvar middleRadius = ( segment.radius0 + segment.radius1 ) * 0.5;\n\tvar middleFraction = ( segment.fraction0 + segment.fraction1 ) * 0.5;\n\n\tvar timeDimension = this.time * this.currentSubray.timeScale * Math.pow( 2, segment.iteration );\n\n\tthis.middlePos.lerpVectors( segment.pos0, segment.pos1, 0.5 );\n\tthis.middleLinPos.lerpVectors( segment.linPos0, segment.linPos1, 0.5 );\n\tvar p = this.middleLinPos;\n\n\t// Noise\n\tthis.newPos.set( this.simplexX.noise4d( p.x, p.y, p.z, timeDimension ),\n\t\tthis.simplexY.noise4d( p.x, p.y, p.z, timeDimension ),\n\t\tthis.simplexZ.noise4d( p.x, p.y, p.z, timeDimension ) );\n\n\tthis.newPos.multiplyScalar( segment.positionVariationFactor * lForwards );\n\tthis.newPos.add( this.middlePos );\n\n\t// Recursion\n\n\tvar newSegment1 = this.getNewSegment();\n\tnewSegment1.pos0.copy( segment.pos0 );\n\tnewSegment1.pos1.copy( this.newPos );\n\tnewSegment1.linPos0.copy( segment.linPos0 );\n\tnewSegment1.linPos1.copy( this.middleLinPos );\n\tnewSegment1.up0.copy( segment.up0 );\n\tnewSegment1.up1.copy( segment.up1 );\n\tnewSegment1.radius0 = segment.radius0;\n\tnewSegment1.radius1 = middleRadius;\n\tnewSegment1.fraction0 = segment.fraction0;\n\tnewSegment1.fraction1 = middleFraction;\n\tnewSegment1.positionVariationFactor = segment.positionVariationFactor * this.currentSubray.roughness;\n\tnewSegment1.iteration = segment.iteration + 1;\n\n\tvar newSegment2 = this.getNewSegment();\n\tnewSegment2.pos0.copy( this.newPos );\n\tnewSegment2.pos1.copy( segment.pos1 );\n\tnewSegment2.linPos0.copy( this.middleLinPos );\n\tnewSegment2.linPos1.copy( segment.linPos1 );\n\tthis.cross1.crossVectors( segment.up0, this.forwards.normalize() );\n\tnewSegment2.up0.crossVectors( this.forwards, this.cross1 ).normalize();\n\tnewSegment2.up1.copy( segment.up1 );\n\tnewSegment2.radius0 = middleRadius;\n\tnewSegment2.radius1 = segment.radius1;\n\tnewSegment2.fraction0 = middleFraction;\n\tnewSegment2.fraction1 = segment.fraction1;\n\tnewSegment2.positionVariationFactor = segment.positionVariationFactor * this.currentSubray.roughness;\n\tnewSegment2.iteration = segment.iteration + 1;\n\n\tthis.fractalRayRecursive( newSegment1 );\n\n\tthis.fractalRayRecursive( newSegment2 );\n\n};\n\nTHREE.LightningStrike.prototype.createPrism = function ( segment ) {\n\n\t// Creates one triangular prism and its vertices at the segment\n\n\tthis.forwardsFill.subVectors( segment.pos1, segment.pos0 ).normalize();\n\n\tif ( this.isInitialSegment ) {\n\n\t\tthis.currentCreateTriangleVertices( segment.pos0, segment.up0, this.forwardsFill, segment.radius0, 0 );\n\n\t\tthis.isInitialSegment = false;\n\n\t}\n\n\tthis.currentCreateTriangleVertices( segment.pos1, segment.up0, this.forwardsFill, segment.radius1, segment.fraction1 );\n\n\tthis.createPrismFaces();\n\n};\n\nTHREE.LightningStrike.prototype.createTriangleVerticesWithoutUVs = function ( pos, up, forwards, radius ) {\n\n\t// Create an equilateral triangle (only vertices)\n\n\tthis.side.crossVectors( up, forwards ).multiplyScalar( radius * THREE.LightningStrike.COS30DEG );\n\tthis.down.copy( up ).multiplyScalar( - radius * THREE.LightningStrike.SIN30DEG );\n\n\tvar p = this.vPos;\n\tvar v = this.vertices;\n\n\tp.copy( pos ).sub( this.side ).add( this.down );\n\n\tv[ this.currentCoordinate ++ ] = p.x;\n\tv[ this.currentCoordinate ++ ] = p.y;\n\tv[ this.currentCoordinate ++ ] = p.z;\n\n\tp.copy( pos ).add( this.side ).add( this.down );\n\n\tv[ this.currentCoordinate ++ ] = p.x;\n\tv[ this.currentCoordinate ++ ] = p.y;\n\tv[ this.currentCoordinate ++ ] = p.z;\n\n\tp.copy( up ).multiplyScalar( radius ).add( pos );\n\n\tv[ this.currentCoordinate ++ ] = p.x;\n\tv[ this.currentCoordinate ++ ] = p.y;\n\tv[ this.currentCoordinate ++ ] = p.z;\n\n\tthis.currentVertex += 3;\n\n};\n\nTHREE.LightningStrike.prototype.createTriangleVerticesWithUVs = function ( pos, up, forwards, radius, u ) {\n\n\t// Create an equilateral triangle (only vertices)\n\n\tthis.side.crossVectors( up, forwards ).multiplyScalar( radius * THREE.LightningStrike.COS30DEG );\n\tthis.down.copy( up ).multiplyScalar( - radius * THREE.LightningStrike.SIN30DEG );\n\n\tvar p = this.vPos;\n\tvar v = this.vertices;\n\tvar uv = this.uvs;\n\n\tp.copy( pos ).sub( this.side ).add( this.down );\n\n\tv[ this.currentCoordinate ++ ] = p.x;\n\tv[ this.currentCoordinate ++ ] = p.y;\n\tv[ this.currentCoordinate ++ ] = p.z;\n\n\tuv[ this.currentUVCoordinate ++ ] = u;\n\tuv[ this.currentUVCoordinate ++ ] = 0;\n\n\tp.copy( pos ).add( this.side ).add( this.down );\n\n\tv[ this.currentCoordinate ++ ] = p.x;\n\tv[ this.currentCoordinate ++ ] = p.y;\n\tv[ this.currentCoordinate ++ ] = p.z;\n\n\tuv[ this.currentUVCoordinate ++ ] = u;\n\tuv[ this.currentUVCoordinate ++ ] = 0.5;\n\n\tp.copy( up ).multiplyScalar( radius ).add( pos );\n\n\tv[ this.currentCoordinate ++ ] = p.x;\n\tv[ this.currentCoordinate ++ ] = p.y;\n\tv[ this.currentCoordinate ++ ] = p.z;\n\n\tuv[ this.currentUVCoordinate ++ ] = u;\n\tuv[ this.currentUVCoordinate ++ ] = 1;\n\n\tthis.currentVertex += 3;\n\n};\n\nTHREE.LightningStrike.prototype.createPrismFaces = function ( vertex/*, index*/ ) {\n\n\tvar indices = this.indices;\n\tvar vertex = this.currentVertex - 6;\n\n\tindices[ this.currentIndex ++ ] = vertex + 1;\n\tindices[ this.currentIndex ++ ] = vertex + 2;\n\tindices[ this.currentIndex ++ ] = vertex + 5;\n\tindices[ this.currentIndex ++ ] = vertex + 1;\n\tindices[ this.currentIndex ++ ] = vertex + 5;\n\tindices[ this.currentIndex ++ ] = vertex + 4;\n\tindices[ this.currentIndex ++ ] = vertex + 0;\n\tindices[ this.currentIndex ++ ] = vertex + 1;\n\tindices[ this.currentIndex ++ ] = vertex + 4;\n\tindices[ this.currentIndex ++ ] = vertex + 0;\n\tindices[ this.currentIndex ++ ] = vertex + 4;\n\tindices[ this.currentIndex ++ ] = vertex + 3;\n\tindices[ this.currentIndex ++ ] = vertex + 2;\n\tindices[ this.currentIndex ++ ] = vertex + 0;\n\tindices[ this.currentIndex ++ ] = vertex + 3;\n\tindices[ this.currentIndex ++ ] = vertex + 2;\n\tindices[ this.currentIndex ++ ] = vertex + 3;\n\tindices[ this.currentIndex ++ ] = vertex + 5;\n\n};\n\nTHREE.LightningStrike.prototype.createDefaultSubrayCreationCallbacks = function () {\n\n\tvar random1 = this.randomGenerator.random;\n\n\tthis.onDecideSubrayCreation = function ( segment, lightningStrike ) {\n\n\t\t// Decide subrays creation at parent (sub)ray segment\n\n\t\tvar subray = lightningStrike.currentSubray;\n\n\t\tvar period = lightningStrike.rayParameters.subrayPeriod;\n\t\tvar dutyCycle = lightningStrike.rayParameters.subrayDutyCycle;\n\n\t\tvar phase0 = ( lightningStrike.rayParameters.isEternal && subray.recursion == 0 ) ? - random1() * period : THREE.MathUtils.lerp( subray.birthTime, subray.endPropagationTime, segment.fraction0 ) - random1() * period;\n\n\t\tvar phase = lightningStrike.time - phase0;\n\t\tvar currentCycle = Math.floor( phase / period );\n\n\t\tvar childSubraySeed = random1() * ( currentCycle + 1 );\n\n\t\tvar isActive = phase % period <= dutyCycle * period;\n\n\t\tvar probability = 0;\n\n\t\tif ( isActive ) {\n\n\t\t\tprobability = lightningStrike.subrayProbability;\n\t\t\t// Distribution test: probability *= segment.fraction0 > 0.5 && segment.fraction0 < 0.9 ? 1 / 0.4 : 0;\n\n\t\t}\n\n\t\tif ( subray.recursion < lightningStrike.maxSubrayRecursion && lightningStrike.numSubrays < lightningStrike.maxSubrays && random1() < probability ) {\n\n\t\t\tvar childSubray = lightningStrike.addNewSubray();\n\n\t\t\tvar parentSeed = lightningStrike.randomGenerator.getSeed();\n\t\t\tchildSubray.seed = childSubraySeed;\n\t\t\tlightningStrike.randomGenerator.setSeed( childSubraySeed );\n\n\t\t\tchildSubray.recursion = subray.recursion + 1;\n\t\t\tchildSubray.maxIterations = Math.max( 1, subray.maxIterations - 1 );\n\n\t\t\tchildSubray.linPos0.set( random1(), random1(), random1() ).multiplyScalar( 1000 );\n\t\t\tchildSubray.linPos1.set( random1(), random1(), random1() ).multiplyScalar( 1000 );\n\t\t\tchildSubray.up0.copy( subray.up0 );\n\t\t\tchildSubray.up1.copy( subray.up1 );\n\t\t\tchildSubray.radius0 = segment.radius0 * lightningStrike.rayParameters.radius0Factor;\n\t\t\tchildSubray.radius1 = Math.min( lightningStrike.rayParameters.minRadius, segment.radius1 * lightningStrike.rayParameters.radius1Factor );\n\n\t\t\tchildSubray.birthTime = phase0 + ( currentCycle ) * period;\n\t\t\tchildSubray.deathTime = childSubray.birthTime + period * dutyCycle;\n\n\t\t\tif ( ! lightningStrike.rayParameters.isEternal && subray.recursion == 0 ) {\n\n\t\t\t\tchildSubray.birthTime = Math.max( childSubray.birthTime, subray.birthTime );\n\t\t\t\tchildSubray.deathTime = Math.min( childSubray.deathTime, subray.deathTime );\n\n\t\t\t}\n\n\t\t\tchildSubray.timeScale = subray.timeScale * 2;\n\t\t\tchildSubray.roughness = subray.roughness;\n\t\t\tchildSubray.straightness = subray.straightness;\n\t\t\tchildSubray.propagationTimeFactor = subray.propagationTimeFactor;\n\t\t\tchildSubray.vanishingTimeFactor = subray.vanishingTimeFactor;\n\n\t\t\tlightningStrike.onSubrayCreation( segment, subray, childSubray, lightningStrike );\n\n\t\t\tlightningStrike.randomGenerator.setSeed( parentSeed );\n\n\t\t}\n\n\t};\n\n\tvar vec1Pos = new THREE.Vector3();\n\tvar vec2Forward = new THREE.Vector3();\n\tvar vec3Side = new THREE.Vector3();\n\tvar vec4Up = new THREE.Vector3();\n\n\tthis.onSubrayCreation = function ( segment, parentSubray, childSubray, lightningStrike ) {\n\n\t\t// Decide childSubray origin and destination positions (pos0 and pos1) and possibly other properties of childSubray\n\n\t\t// Just use the default cone position generator\n\t\tlightningStrike.subrayCylinderPosition( segment, parentSubray, childSubray, 0.5, 0.6, 0.2 );\n\n\t};\n\n\tthis.subrayConePosition = function ( segment, parentSubray, childSubray, heightFactor, sideWidthFactor, minSideWidthFactor ) {\n\n\t\t// Sets childSubray pos0 and pos1 in a cone\n\n\t\tchildSubray.pos0.copy( segment.pos0 );\n\n\t\tvec1Pos.subVectors( parentSubray.pos1, parentSubray.pos0 );\n\t\tvec2Forward.copy( vec1Pos ).normalize();\n\t\tvec1Pos.multiplyScalar( segment.fraction0 + ( 1 - segment.fraction0 ) * ( random1() * heightFactor ) );\n\t\tvar length = vec1Pos.length();\n\t\tvec3Side.crossVectors( parentSubray.up0, vec2Forward );\n\t\tvar angle = 2 * Math.PI * random1();\n\t\tvec3Side.multiplyScalar( Math.cos( angle ) );\n\t\tvec4Up.copy( parentSubray.up0 ).multiplyScalar( Math.sin( angle ) );\n\n\t\tchildSubray.pos1.copy( vec3Side ).add( vec4Up ).multiplyScalar( length * sideWidthFactor * ( minSideWidthFactor + random1() * ( 1 - minSideWidthFactor ) ) ).add( vec1Pos ).add( parentSubray.pos0 );\n\n\t};\n\n\tthis.subrayCylinderPosition = function ( segment, parentSubray, childSubray, heightFactor, sideWidthFactor, minSideWidthFactor ) {\n\n\t\t// Sets childSubray pos0 and pos1 in a cylinder\n\n\t\tchildSubray.pos0.copy( segment.pos0 );\n\n\t\tvec1Pos.subVectors( parentSubray.pos1, parentSubray.pos0 );\n\t\tvec2Forward.copy( vec1Pos ).normalize();\n\t\tvec1Pos.multiplyScalar( segment.fraction0 + ( 1 - segment.fraction0 ) * ( ( 2 * random1() - 1 ) * heightFactor ) );\n\t\tvar length = vec1Pos.length();\n\t\tvec3Side.crossVectors( parentSubray.up0, vec2Forward );\n\t\tvar angle = 2 * Math.PI * random1();\n\t\tvec3Side.multiplyScalar( Math.cos( angle ) );\n\t\tvec4Up.copy( parentSubray.up0 ).multiplyScalar( Math.sin( angle ) );\n\n\t\tchildSubray.pos1.copy( vec3Side ).add( vec4Up ).multiplyScalar( length * sideWidthFactor * ( minSideWidthFactor + random1() * ( 1 - minSideWidthFactor ) ) ).add( vec1Pos ).add( parentSubray.pos0 );\n\n\t};\n\n};\n\nTHREE.LightningStrike.prototype.createSubray = function () {\n\n\treturn {\n\n\t\tseed: 0,\n\t\tmaxIterations: 0,\n\t\trecursion: 0,\n\t\tpos0: new THREE.Vector3(),\n\t\tpos1: new THREE.Vector3(),\n\t\tlinPos0: new THREE.Vector3(),\n\t\tlinPos1: new THREE.Vector3(),\n\t\tup0: new THREE.Vector3(),\n\t\tup1: new THREE.Vector3(),\n\t\tradius0: 0,\n\t\tradius1: 0,\n\t\tbirthTime: 0,\n\t\tdeathTime: 0,\n\t\ttimeScale: 0,\n\t\troughness: 0,\n\t\tstraightness: 0,\n\t\tpropagationTimeFactor: 0,\n\t\tvanishingTimeFactor: 0,\n\t\tendPropagationTime: 0,\n\t\tbeginVanishingTime: 0\n\n\t};\n\n};\n\nTHREE.LightningStrike.prototype.createSegment = function () {\n\n\treturn {\n\t\titeration: 0,\n\t\tpos0: new THREE.Vector3(),\n\t\tpos1: new THREE.Vector3(),\n\t\tlinPos0: new THREE.Vector3(),\n\t\tlinPos1: new THREE.Vector3(),\n\t\tup0: new THREE.Vector3(),\n\t\tup1: new THREE.Vector3(),\n\t\tradius0: 0,\n\t\tradius1: 0,\n\t\tfraction0: 0,\n\t\tfraction1: 0,\n\t\tpositionVariationFactor: 0\n\t};\n\n};\n\nTHREE.LightningStrike.prototype.getNewSegment = function () {\n\n\treturn this.raySegments[ this.currentSegmentIndex ++ ];\n\n};\n\nTHREE.LightningStrike.prototype.copy = function ( source ) {\n\n\tTHREE.BufferGeometry.prototype.copy.call( this, source );\n\n\tthis.init( THREE.LightningStrike.copyParameters( {}, source.rayParameters ) );\n\n\treturn this;\n\n};\n\nTHREE.LightningStrike.prototype.clone = function () {\n\n\treturn new this.constructor( THREE.LightningStrike.copyParameters( {}, this.rayParameters ) );\n\n};\n"]}