{"version":3,"sources":["AnaglyphEffect.js"],"names":[],"mappings":"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","file":"AnaglyphEffect-compiled.js","sourcesContent":["console.warn( \"THREE.AnaglyphEffect: As part of the transition to ES6 Modules, the files in 'examples/js' were deprecated in May 2020 (r117) and will be deleted in December 2020 (r124). You can find more information about developing using ES6 Modules in https://threejs.org/docs/#manual/en/introduction/Installation.\" );\n\nTHREE.AnaglyphEffect = function ( renderer, width, height ) {\n\n\t// Matrices generated with angler.js https://github.com/tschw/angler.js/\n\t// (in column-major element order, as accepted by WebGL)\n\n\tthis.colorMatrixLeft = new THREE.Matrix3().fromArray( [\n\n\t\t1.0671679973602295, - 0.0016435992438346148, 0.0001777536963345483, // r out\n\t\t- 0.028107794001698494, - 0.00019593400065787137, - 0.0002875397040043026, // g out\n\t\t- 0.04279090091586113, 0.000015809757314855233, - 0.00024287120322696865 // b out\n\n\t] );\n\n\t//\t\tred\t\t\t\t\t\tgreen \t\t\t\t\t\tblue  \t\t\t\t\t\tin\n\n\tthis.colorMatrixRight = new THREE.Matrix3().fromArray( [\n\n\t\t- 0.0355340838432312, - 0.06440307199954987, 0.018319187685847282, // r out\n\t\t- 0.10269022732973099, 0.8079727292060852, - 0.04835830628871918, // g out\n\t\t0.0001224992738571018, - 0.009558862075209618, 0.567823588848114 // b out\n\n\t] );\n\n\tvar _camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n\tvar _scene = new THREE.Scene();\n\n\tvar _stereo = new THREE.StereoCamera();\n\n\tvar _params = { minFilter: THREE.LinearFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat };\n\n\tif ( width === undefined ) width = 512;\n\tif ( height === undefined ) height = 512;\n\n\tvar _renderTargetL = new THREE.WebGLRenderTarget( width, height, _params );\n\tvar _renderTargetR = new THREE.WebGLRenderTarget( width, height, _params );\n\n\tvar _material = new THREE.ShaderMaterial( {\n\n\t\tuniforms: {\n\n\t\t\t\"mapLeft\": { value: _renderTargetL.texture },\n\t\t\t\"mapRight\": { value: _renderTargetR.texture },\n\n\t\t\t\"colorMatrixLeft\": { value: this.colorMatrixLeft },\n\t\t\t\"colorMatrixRight\": { value: this.colorMatrixRight }\n\n\t\t},\n\n\t\tvertexShader: [\n\n\t\t\t\"varying vec2 vUv;\",\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvUv = vec2( uv.x, uv.y );\",\n\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform sampler2D mapLeft;\",\n\t\t\t\"uniform sampler2D mapRight;\",\n\t\t\t\"varying vec2 vUv;\",\n\n\t\t\t\"uniform mat3 colorMatrixLeft;\",\n\t\t\t\"uniform mat3 colorMatrixRight;\",\n\n\t\t\t// These functions implement sRGB linearization and gamma correction\n\n\t\t\t\"float lin( float c ) {\",\n\t\t\t\"\treturn c <= 0.04045 ? c * 0.0773993808 :\",\n\t\t\t\"\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );\",\n\t\t\t\"}\",\n\n\t\t\t\"vec4 lin( vec4 c ) {\",\n\t\t\t\"\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );\",\n\t\t\t\"}\",\n\n\t\t\t\"float dev( float c ) {\",\n\t\t\t\"\treturn c <= 0.0031308 ? c * 12.92\",\n\t\t\t\"\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;\",\n\t\t\t\"}\",\n\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvec2 uv = vUv;\",\n\n\t\t\t\"\tvec4 colorL = lin( texture2D( mapLeft, uv ) );\",\n\t\t\t\"\tvec4 colorR = lin( texture2D( mapRight, uv ) );\",\n\n\t\t\t\"\tvec3 color = clamp(\",\n\t\t\t\"\t\t\tcolorMatrixLeft * colorL.rgb +\",\n\t\t\t\"\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );\",\n\n\t\t\t\"\tgl_FragColor = vec4(\",\n\t\t\t\"\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),\",\n\t\t\t\"\t\t\tmax( colorL.a, colorR.a ) );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t} );\n\n\tvar _mesh = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), _material );\n\t_scene.add( _mesh );\n\n\tthis.setSize = function ( width, height ) {\n\n\t\trenderer.setSize( width, height );\n\n\t\tvar pixelRatio = renderer.getPixelRatio();\n\n\t\t_renderTargetL.setSize( width * pixelRatio, height * pixelRatio );\n\t\t_renderTargetR.setSize( width * pixelRatio, height * pixelRatio );\n\n\t};\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tvar currentRenderTarget = renderer.getRenderTarget();\n\n\t\tscene.updateMatrixWorld();\n\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\t_stereo.update( camera );\n\n\t\trenderer.setRenderTarget( _renderTargetL );\n\t\trenderer.clear();\n\t\trenderer.render( scene, _stereo.cameraL );\n\n\t\trenderer.setRenderTarget( _renderTargetR );\n\t\trenderer.clear();\n\t\trenderer.render( scene, _stereo.cameraR );\n\n\t\trenderer.setRenderTarget( null );\n\t\trenderer.render( _scene, _camera );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t};\n\n\tthis.dispose = function () {\n\n\t\tif ( _renderTargetL ) _renderTargetL.dispose();\n\t\tif ( _renderTargetR ) _renderTargetR.dispose();\n\t\tif ( _mesh ) _mesh.geometry.dispose();\n\t\tif ( _material ) _material.dispose();\n\n\t};\n\n};\n"]}