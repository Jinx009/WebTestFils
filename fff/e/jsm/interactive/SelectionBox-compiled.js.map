{"version":3,"sources":["SelectionBox.js"],"names":[],"mappings":"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","file":"SelectionBox-compiled.js","sourcesContent":["/**\n * @author HypnosNova / https://www.threejs.org.cn/gallery\n * This is a class to check whether objects are in a selection area in 3D space\n */\n\nimport {\n\tFrustum,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar SelectionBox = ( function () {\n\n\tvar frustum = new Frustum();\n\tvar center = new Vector3();\n\n\tvar tmpPoint = new Vector3();\n\n\tvar vecNear = new Vector3();\n\tvar vecTopLeft = new Vector3();\n\tvar vecTopRight = new Vector3();\n\tvar vecDownRight = new Vector3();\n\tvar vecDownLeft = new Vector3();\n\n\tvar vectemp1 = new Vector3();\n\tvar vectemp2 = new Vector3();\n\tvar vectemp3 = new Vector3();\n\n\tfunction SelectionBox( camera, scene, deep ) {\n\n\t\tthis.camera = camera;\n\t\tthis.scene = scene;\n\t\tthis.startPoint = new Vector3();\n\t\tthis.endPoint = new Vector3();\n\t\tthis.collection = [];\n\t\tthis.deep = deep || Number.MAX_VALUE;\n\n\t}\n\n\tSelectionBox.prototype.select = function ( startPoint, endPoint ) {\n\n\t\tthis.startPoint = startPoint || this.startPoint;\n\t\tthis.endPoint = endPoint || this.endPoint;\n\t\tthis.collection = [];\n\n\t\tthis.updateFrustum( this.startPoint, this.endPoint );\n\t\tthis.searchChildInFrustum( frustum, this.scene );\n\n\t\treturn this.collection;\n\n\t};\n\n\tSelectionBox.prototype.updateFrustum = function ( startPoint, endPoint ) {\n\n\t\tstartPoint = startPoint || this.startPoint;\n\t\tendPoint = endPoint || this.endPoint;\n\n\t\tthis.camera.updateProjectionMatrix();\n\t\tthis.camera.updateMatrixWorld();\n\n\t\ttmpPoint.copy( startPoint );\n\t\ttmpPoint.x = Math.min( startPoint.x, endPoint.x );\n\t\ttmpPoint.y = Math.max( startPoint.y, endPoint.y );\n\t\tendPoint.x = Math.max( startPoint.x, endPoint.x );\n\t\tendPoint.y = Math.min( startPoint.y, endPoint.y );\n\n\t\tvecNear.copy( this.camera.position );\n\t\tvecTopLeft.copy( tmpPoint );\n\t\tvecTopRight.set( endPoint.x, tmpPoint.y, 0 );\n\t\tvecDownRight.copy( endPoint );\n\t\tvecDownLeft.set( tmpPoint.x, endPoint.y, 0 );\n\n\t\tvecTopLeft.unproject( this.camera );\n\t\tvecTopRight.unproject( this.camera );\n\t\tvecDownRight.unproject( this.camera );\n\t\tvecDownLeft.unproject( this.camera );\n\n\t\tvectemp1.copy( vecTopLeft ).sub( vecNear );\n\t\tvectemp2.copy( vecTopRight ).sub( vecNear );\n\t\tvectemp3.copy( vecDownRight ).sub( vecNear );\n\t\tvectemp1.normalize();\n\t\tvectemp2.normalize();\n\t\tvectemp3.normalize();\n\n\t\tvectemp1.multiplyScalar( this.deep );\n\t\tvectemp2.multiplyScalar( this.deep );\n\t\tvectemp3.multiplyScalar( this.deep );\n\t\tvectemp1.add( vecNear );\n\t\tvectemp2.add( vecNear );\n\t\tvectemp3.add( vecNear );\n\n\t\tvar planes = frustum.planes;\n\n\t\tplanes[ 0 ].setFromCoplanarPoints( vecNear, vecTopLeft, vecTopRight );\n\t\tplanes[ 1 ].setFromCoplanarPoints( vecNear, vecTopRight, vecDownRight );\n\t\tplanes[ 2 ].setFromCoplanarPoints( vecDownRight, vecDownLeft, vecNear );\n\t\tplanes[ 3 ].setFromCoplanarPoints( vecDownLeft, vecTopLeft, vecNear );\n\t\tplanes[ 4 ].setFromCoplanarPoints( vecTopRight, vecDownRight, vecDownLeft );\n\t\tplanes[ 5 ].setFromCoplanarPoints( vectemp3, vectemp2, vectemp1 );\n\t\tplanes[ 5 ].normal.multiplyScalar( - 1 );\n\n\t};\n\n\tSelectionBox.prototype.searchChildInFrustum = function ( frustum, object ) {\n\n\t\tif ( object.isMesh ) {\n\n\t\t\tif ( object.material !== undefined ) {\n\n\t\t\t\tobject.geometry.computeBoundingSphere();\n\n\t\t\t\tcenter.copy( object.geometry.boundingSphere.center );\n\n\t\t\t\tcenter.applyMatrix4( object.matrixWorld );\n\n\t\t\t\tif ( frustum.containsPoint( center ) ) {\n\n\t\t\t\t\tthis.collection.push( object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( object.children.length > 0 ) {\n\n\t\t\tfor ( var x = 0; x < object.children.length; x ++ ) {\n\n\t\t\t\tthis.searchChildInFrustum( frustum, object.children[ x ] );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\treturn SelectionBox;\n\n} )();\n\nexport { SelectionBox };\n"]}