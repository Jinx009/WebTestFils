{"version":3,"sources":["AWDLoader.js"],"names":[],"mappings":"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","file":"AWDLoader-compiled.js","sourcesContent":["/**\n * Author: Pierre Lepers\n * Date: 09/12/2013 17:21\n */\n\nimport {\n\tBone,\n\tBufferAttribute,\n\tBufferGeometry,\n\tFileLoader,\n\tImageLoader,\n\tLoader,\n\tMatrix4,\n\tMesh,\n\tMeshPhongMaterial,\n\tObject3D,\n\tTexture\n} from \"../../../build/three.module.js\";\n\nvar AWDLoader = ( function () {\n\n\tvar //UNCOMPRESSED = 0,\n\t\t//DEFLATE = 1,\n\t\t//LZMA = 2,\n\n\t\tAWD_FIELD_INT8 = 1,\n\t\tAWD_FIELD_INT16 = 2,\n\t\tAWD_FIELD_INT32 = 3,\n\t\tAWD_FIELD_UINT8 = 4,\n\t\tAWD_FIELD_UINT16 = 5,\n\t\tAWD_FIELD_UINT32 = 6,\n\t\tAWD_FIELD_FLOAT32 = 7,\n\t\tAWD_FIELD_FLOAT64 = 8,\n\t\tAWD_FIELD_BOOL = 21,\n\t\t//AWD_FIELD_COLOR = 22,\n\t\tAWD_FIELD_BADDR = 23,\n\t\t//AWD_FIELD_STRING = 31,\n\t\t//AWD_FIELD_BYTEARRAY = 32,\n\t\tAWD_FIELD_VECTOR2x1 = 41,\n\t\tAWD_FIELD_VECTOR3x1 = 42,\n\t\tAWD_FIELD_VECTOR4x1 = 43,\n\t\tAWD_FIELD_MTX3x2 = 44,\n\t\tAWD_FIELD_MTX3x3 = 45,\n\t\tAWD_FIELD_MTX4x3 = 46,\n\t\tAWD_FIELD_MTX4x4 = 47,\n\n\t\tBOOL = 21,\n\t\t//COLOR = 22,\n\t\tBADDR = 23,\n\n\t\t//INT8 = 1,\n\t\t//INT16 = 2,\n\t\t//INT32 = 3,\n\t\tUINT8 = 4,\n\t\tUINT16 = 5,\n\t\t//UINT32 = 6,\n\t\tFLOAT32 = 7,\n\t\tFLOAT64 = 8;\n\n\tvar littleEndian = true;\n\n\tfunction Block() {\n\n\t\tthis.id = 0;\n\t\tthis.data = null;\n\t\tthis.namespace = 0;\n\t\tthis.flags = 0;\n\n\t}\n\n\tfunction AWDProperties() {}\n\n\tAWDProperties.prototype = {\n\t\tset: function ( key, value ) {\n\n\t\t\tthis[ key ] = value;\n\n\t\t},\n\n\t\tget: function ( key, fallback ) {\n\n\t\t\tif ( this.hasOwnProperty( key ) ) {\n\n\t\t\t\treturn this[ key ];\n\n\t\t\t} else {\n\n\t\t\t\treturn fallback;\n\n\t\t\t}\n\n\t\t}\n\t};\n\n\tvar AWDLoader = function ( manager ) {\n\n\t\tLoader.call( this, manager );\n\n\t\tthis.trunk = new Object3D();\n\n\t\tthis.materialFactory = undefined;\n\n\t\tthis._url = '';\n\t\tthis._baseDir = '';\n\n\t\tthis._data = undefined;\n\t\tthis._ptr = 0;\n\n\t\tthis._version = [];\n\t\tthis._streaming = false;\n\t\tthis._optimized_for_accuracy = false;\n\t\tthis._compression = 0;\n\t\tthis._bodylen = 0xFFFFFFFF;\n\n\t\tthis._blocks = [ new Block() ];\n\n\t\tthis._accuracyMatrix = false;\n\t\tthis._accuracyGeo = false;\n\t\tthis._accuracyProps = false;\n\n\t};\n\n\tAWDLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\t\tconstructor: AWDLoader,\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tthis._url = url;\n\t\t\tthis._baseDir = url.substr( 0, url.lastIndexOf( '/' ) + 1 );\n\n\t\t\tvar loader = new FileLoader( this.manager );\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\t\t\tloader.load( url, function ( text ) {\n\n\t\t\t\tonLoad( scope.parse( text ) );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tparse: function ( data ) {\n\n\t\t\tvar blen = data.byteLength;\n\n\t\t\tthis._ptr = 0;\n\t\t\tthis._data = new DataView( data );\n\n\t\t\tthis._parseHeader( );\n\n\t\t\tif ( this._compression != 0 ) {\n\n\t\t\t\tconsole.error( 'compressed AWD not supported' );\n\n\t\t\t}\n\n\t\t\tif ( ! this._streaming && this._bodylen != data.byteLength - this._ptr ) {\n\n\t\t\t\tconsole.error( 'AWDLoader: body len does not match file length', this._bodylen, blen - this._ptr );\n\n\t\t\t}\n\n\t\t\twhile ( this._ptr < blen ) {\n\n\t\t\t\tthis.parseNextBlock();\n\n\t\t\t}\n\n\t\t\treturn this.trunk;\n\n\t\t},\n\n\t\tparseNextBlock: function () {\n\n\t\t\tvar assetData,\n\t\t\t\tblock,\n\t\t\t\tblockId = this.readU32(),\n\t\t\t\tns = this.readU8(),\n\t\t\t\ttype = this.readU8(),\n\t\t\t\tflags = this.readU8(),\n\t\t\t\tlen = this.readU32();\n\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 1:\n\t\t\t\t\tassetData = this.parseMeshData();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 22:\n\t\t\t\t\tassetData = this.parseContainer();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 23:\n\t\t\t\t\tassetData = this.parseMeshInstance();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 81:\n\t\t\t\t\tassetData = this.parseMaterial();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 82:\n\t\t\t\t\tassetData = this.parseTexture();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 101:\n\t\t\t\t\tassetData = this.parseSkeleton();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 112:\n\t\t\t\t\tassetData = this.parseMeshPoseAnimation( false );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 113:\n\t\t\t\t\tassetData = this.parseVertexAnimationSet();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 102:\n\t\t\t\t\tassetData = this.parseSkeletonPose();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 103:\n\t\t\t\t\tassetData = this.parseSkeletonAnimation();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 122:\n\t\t\t\t\tassetData = this.parseAnimatorSet();\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t//debug('Ignoring block!',type, len);\n\t\t\t\t\tthis._ptr += len;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\n\t\t\t// Store block reference for later use\n\t\t\tthis._blocks[ blockId ] = block = new Block();\n\t\t\tblock.data = assetData;\n\t\t\tblock.id = blockId;\n\t\t\tblock.namespace = ns;\n\t\t\tblock.flags = flags;\n\n\n\t\t},\n\n\t\t_parseHeader: function () {\n\n\t\t\tvar version = this._version,\n\t\t\t\tawdmagic = ( this.readU8() << 16 ) | ( this.readU8() << 8 ) | this.readU8();\n\n\t\t\tif ( awdmagic != 4282180 )\n\t\t\t\tthrow new Error( \"AWDLoader - bad magic\" );\n\n\t\t\tversion[ 0 ] = this.readU8();\n\t\t\tversion[ 1 ] = this.readU8();\n\n\t\t\tvar flags = this.readU16();\n\n\t\t\tthis._streaming = ( flags & 0x1 ) == 0x1;\n\n\t\t\tif ( ( version[ 0 ] === 2 ) && ( version[ 1 ] === 1 ) ) {\n\n\t\t\t\tthis._accuracyMatrix = ( flags & 0x2 ) === 0x2;\n\t\t\t\tthis._accuracyGeo = ( flags & 0x4 ) === 0x4;\n\t\t\t\tthis._accuracyProps = ( flags & 0x8 ) === 0x8;\n\n\t\t\t}\n\n\t\t\tthis._geoNrType = this._accuracyGeo ? FLOAT64 : FLOAT32;\n\t\t\tthis._matrixNrType = this._accuracyMatrix ? FLOAT64 : FLOAT32;\n\t\t\tthis._propsNrType = this._accuracyProps ? FLOAT64 : FLOAT32;\n\n\t\t\tthis._optimized_for_accuracy = ( flags & 0x2 ) === 0x2;\n\n\t\t\tthis._compression = this.readU8();\n\t\t\tthis._bodylen = this.readU32();\n\n\t\t},\n\n\t\tparseContainer: function () {\n\n\t\t\tvar parent,\n\t\t\t\tctr = new Object3D(),\n\t\t\t\tpar_id = this.readU32(),\n\t\t\t\tmtx = this.parseMatrix4();\n\n\t\t\tctr.name = this.readUTF();\n\t\t\tctr.applyMatrix( mtx );\n\n\t\t\tparent = this._blocks[ par_id ].data || this.trunk;\n\t\t\tparent.add( ctr );\n\n\t\t\tthis.parseProperties( {\n\t\t\t\t1: this._matrixNrType,\n\t\t\t\t2: this._matrixNrType,\n\t\t\t\t3: this._matrixNrType,\n\t\t\t\t4: UINT8\n\t\t\t} );\n\n\t\t\tctr.extra = this.parseUserAttributes();\n\n\t\t\treturn ctr;\n\n\t\t},\n\n\t\tparseMeshInstance: function () {\n\n\t\t\tvar name,\n\t\t\t\tmesh, geometries, meshLen, meshes,\n\t\t\t\tpar_id, data_id,\n\t\t\t\tmtx,\n\t\t\t\tmaterials, mat, mat_id,\n\t\t\t\tnum_materials,\n\t\t\t\tparent,\n\t\t\t\ti;\n\n\t\t\tpar_id = this.readU32();\n\t\t\tmtx = this.parseMatrix4();\n\t\t\tname = this.readUTF();\n\t\t\tdata_id = this.readU32();\n\t\t\tnum_materials = this.readU16();\n\n\t\t\tgeometries = this.getBlock( data_id );\n\n\t\t\tmaterials = [];\n\n\t\t\tfor ( i = 0; i < num_materials; i ++ ) {\n\n\t\t\t\tmat_id = this.readU32();\n\t\t\t\tmat = this.getBlock( mat_id );\n\t\t\t\tmaterials.push( mat );\n\n\t\t\t}\n\n\t\t\tmeshLen = geometries.length;\n\t\t\tmeshes = [];\n\n\t\t\t// TODO : BufferGeometry don't support \"geometryGroups\" for now.\n\t\t\t// so we create sub meshes for each groups\n\t\t\tif ( meshLen > 1 ) {\n\n\t\t\t\tmesh = new Object3D();\n\t\t\t\tfor ( i = 0; i < meshLen; i ++ ) {\n\n\t\t\t\t\tvar sm = new Mesh( geometries[ i ] );\n\t\t\t\t\tmeshes.push( sm );\n\t\t\t\t\tmesh.add( sm );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tmesh = new Mesh( geometries[ 0 ] );\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tmesh.applyMatrix( mtx );\n\t\t\tmesh.name = name;\n\n\n\t\t\tparent = this.getBlock( par_id ) || this.trunk;\n\t\t\tparent.add( mesh );\n\n\n\t\t\tvar matLen = materials.length;\n\t\t\tvar maxLen = Math.max( meshLen, matLen );\n\t\t\tfor ( i = 0; i < maxLen; i ++ )\n\t\t\t\tmeshes[ i % meshLen ].material = materials[ i % matLen ];\n\n\n\t\t\t// Ignore for now\n\t\t\tthis.parseProperties( null );\n\t\t\tmesh.extra = this.parseUserAttributes();\n\n\t\t\treturn mesh;\n\n\t\t},\n\n\t\tparseMaterial: function () {\n\n\t\t\tvar name,\n\t\t\t\ttype,\n\t\t\t\tprops,\n\t\t\t\tmat,\n\t\t\t\tattributes,\n\t\t\t\tnum_methods,\n\t\t\t\tmethods_parsed;\n\n\t\t\tname = this.readUTF();\n\t\t\ttype = this.readU8();\n\t\t\tnum_methods = this.readU8();\n\n\t\t\t//log( \"AWDLoader parseMaterial \",name )\n\n\t\t\t// Read material numerical properties\n\t\t\t// (1=color, 2=bitmap url, 11=alpha_blending, 12=alpha_threshold, 13=repeat)\n\t\t\tprops = this.parseProperties( {\n\t\t\t\t1: AWD_FIELD_INT32,\n\t\t\t\t2: AWD_FIELD_BADDR,\n\t\t\t\t11: AWD_FIELD_BOOL,\n\t\t\t\t12: AWD_FIELD_FLOAT32,\n\t\t\t\t13: AWD_FIELD_BOOL\n\t\t\t} );\n\n\t\t\tmethods_parsed = 0;\n\n\t\t\twhile ( methods_parsed < num_methods ) {\n\n\t\t\t\t// read method_type before\n\t\t\t\tthis.readU16();\n\t\t\t\tthis.parseProperties( null );\n\t\t\t\tthis.parseUserAttributes();\n\n\t\t\t}\n\n\t\t\tattributes = this.parseUserAttributes();\n\n\t\t\tif ( this.materialFactory !== undefined ) {\n\n\t\t\t\tmat = this.materialFactory( name );\n\t\t\t\tif ( mat ) return mat;\n\n\t\t\t}\n\n\t\t\tmat = new MeshPhongMaterial();\n\n\t\t\tif ( type === 1 ) {\n\n\t\t\t\t// Color material\n\t\t\t\tmat.color.setHex( props.get( 1, 0xcccccc ) );\n\n\t\t\t} else if ( type === 2 ) {\n\n\t\t\t\t// Bitmap material\n\t\t\t\tvar tex_addr = props.get( 2, 0 );\n\t\t\t\tmat.map = this.getBlock( tex_addr );\n\n\t\t\t}\n\n\t\t\tmat.extra = attributes;\n\t\t\tmat.alphaThreshold = props.get( 12, 0.0 );\n\t\t\tmat.repeat = props.get( 13, false );\n\n\n\t\t\treturn mat;\n\n\t\t},\n\n\t\tparseTexture: function () {\n\n\t\t\tvar name = this.readUTF(),\n\t\t\t\ttype = this.readU8(),\n\t\t\t\tasset,\n\t\t\t\tdata_len;\n\n\t\t\t// External\n\t\t\tif ( type === 0 ) {\n\n\t\t\t\tdata_len = this.readU32();\n\t\t\t\tvar url = this.readUTFBytes( data_len );\n\t\t\t\tconsole.log( url );\n\n\t\t\t\tasset = this.loadTexture( url );\n\t\t\t\tasset.userData = {};\n\t\t\t\tasset.userData.name = name;\n\n\t\t\t} else {\n\t\t\t\t// embed texture not supported\n\t\t\t}\n\t\t\t// Ignore for now\n\t\t\tthis.parseProperties( null );\n\n\t\t\tthis.parseUserAttributes();\n\t\t\treturn asset;\n\n\t\t},\n\n\t\tloadTexture: function ( url ) {\n\n\t\t\tvar tex = new Texture();\n\n\t\t\tvar loader = new ImageLoader( this.manager );\n\n\t\t\tloader.load( this._baseDir + url, function ( image ) {\n\n\t\t\t\ttex.image = image;\n\t\t\t\ttex.needsUpdate = true;\n\n\t\t\t} );\n\n\t\t\treturn tex;\n\n\t\t},\n\n\t\tparseSkeleton: function () {\n\n\t\t\t// Array<Bone>\n\t\t\t//\n\t\t\tthis.readUTF();\n\t\t\tvar\tnum_joints = this.readU16(),\n\t\t\t\tskeleton = [],\n\t\t\t\tjoints_parsed = 0;\n\n\t\t\tthis.parseProperties( null );\n\n\t\t\twhile ( joints_parsed < num_joints ) {\n\n\t\t\t\tvar joint, ibp;\n\n\t\t\t\t// Ignore joint id\n\t\t\t\tthis.readU16();\n\n\t\t\t\tjoint = new Bone();\n\t\t\t\tjoint.parent = this.readU16() - 1; // 0=null in AWD\n\t\t\t\tjoint.name = this.readUTF();\n\n\t\t\t\tibp = this.parseMatrix4();\n\t\t\t\tjoint.skinMatrix = ibp;\n\n\t\t\t\t// Ignore joint props/attributes for now\n\t\t\t\tthis.parseProperties( null );\n\t\t\t\tthis.parseUserAttributes();\n\n\t\t\t\tskeleton.push( joint );\n\t\t\t\tjoints_parsed ++;\n\n\t\t\t}\n\n\t\t\t// Discard attributes for now\n\t\t\tthis.parseUserAttributes();\n\n\n\t\t\treturn skeleton;\n\n\t\t},\n\n\t\tparseSkeletonPose: function () {\n\n\t\t\tvar name = this.readUTF();\n\n\t\t\tvar num_joints = this.readU16();\n\t\t\tthis.parseProperties( null );\n\n\t\t\t// debug( 'parse Skeleton Pose. joints : ' + num_joints);\n\n\t\t\tvar pose = [];\n\n\t\t\tvar joints_parsed = 0;\n\n\t\t\twhile ( joints_parsed < num_joints ) {\n\n\t\t\t\tvar has_transform; //:uint;\n\t\t\t\tvar mtx_data;\n\n\t\t\t\thas_transform = this.readU8();\n\n\t\t\t\tif ( has_transform === 1 ) {\n\n\t\t\t\t\tmtx_data = this.parseMatrix4();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tmtx_data = new Matrix4();\n\n\t\t\t\t}\n\t\t\t\tpose[ joints_parsed ] = mtx_data;\n\t\t\t\tjoints_parsed ++;\n\n\t\t\t}\n\n\t\t\t// Skip attributes for now\n\t\t\tthis.parseUserAttributes();\n\n\t\t\treturn pose;\n\n\t\t},\n\n\t\tparseSkeletonAnimation: function () {\n\n\t\t\tvar frame_dur;\n\t\t\tvar pose_addr;\n\t\t\tvar pose;\n\n\t\t\tvar name = this.readUTF();\n\n\t\t\tvar clip = [];\n\n\t\t\tvar num_frames = this.readU16();\n\t\t\tthis.parseProperties( null );\n\n\t\t\tvar frames_parsed = 0;\n\n\t\t\t// debug( 'parse Skeleton Animation. frames : ' + num_frames);\n\n\t\t\twhile ( frames_parsed < num_frames ) {\n\n\t\t\t\tpose_addr = this.readU32();\n\t\t\t\tframe_dur = this.readU16();\n\n\t\t\t\tpose = this._blocks[ pose_addr ].data;\n\t\t\t\t// debug( 'pose address ',pose[2].elements[12],pose[2].elements[13],pose[2].elements[14] );\n\t\t\t\tclip.push( {\n\t\t\t\t\tpose: pose,\n\t\t\t\t\tduration: frame_dur\n\t\t\t\t} );\n\n\t\t\t\tframes_parsed ++;\n\n\t\t\t}\n\n\t\t\tif ( clip.length === 0 ) {\n\n\t\t\t\t// debug(\"Could not this SkeletonClipNode, because no Frames where set.\");\n\t\t\t\treturn;\n\n\t\t\t}\n\t\t\t// Ignore attributes for now\n\t\t\tthis.parseUserAttributes();\n\t\t\treturn clip;\n\n\t\t},\n\n\t\tparseVertexAnimationSet: function () {\n\n\t\t\tvar poseBlockAdress,\n\t\t\t\tname = this.readUTF(),\n\t\t\t\tnum_frames = this.readU16(),\n\t\t\t\tprops = this.parseProperties( { 1: UINT16 } ),\n\t\t\t\tframes_parsed = 0,\n\t\t\t\tskeletonFrames = [];\n\n\t\t\twhile ( frames_parsed < num_frames ) {\n\n\t\t\t\tposeBlockAdress = this.readU32();\n\t\t\t\tskeletonFrames.push( this._blocks[ poseBlockAdress ].data );\n\t\t\t\tframes_parsed ++;\n\n\t\t\t}\n\n\t\t\tthis.parseUserAttributes();\n\n\n\t\t\treturn skeletonFrames;\n\n\t\t},\n\n\t\tparseAnimatorSet: function () {\n\n\t\t\tvar animSetBlockAdress; //:int\n\n\t\t\tvar targetAnimationSet; //:AnimationSetBase;\n\t\t\tvar name = this.readUTF();\n\t\t\tvar type = this.readU16();\n\n\t\t\tvar props = this.parseProperties( { 1: BADDR } );\n\n\t\t\tanimSetBlockAdress = this.readU32();\n\t\t\tvar targetMeshLength = this.readU16();\n\n\t\t\tvar meshAdresses = []; //:Vector.<uint> = new Vector.<uint>;\n\n\t\t\tfor ( var i = 0; i < targetMeshLength; i ++ )\n\t\t\t\tmeshAdresses.push( this.readU32() );\n\n\t\t\tvar activeState = this.readU16();\n\t\t\tvar autoplay = Boolean( this.readU8() );\n\t\t\tthis.parseUserAttributes();\n\t\t\tthis.parseUserAttributes();\n\n\t\t\tvar targetMeshes = []; //:Vector.<Mesh> = new Vector.<Mesh>;\n\n\t\t\tfor ( i = 0; i < meshAdresses.length; i ++ ) {\n\n\t\t\t\t//\t\t\treturnedArray = getAssetByID(meshAdresses[i], [AssetType.MESH]);\n\t\t\t\t//\t\t\tif (returnedArray[0])\n\t\t\t\ttargetMeshes.push( this._blocks[ meshAdresses[ i ] ].data );\n\n\t\t\t}\n\n\t\t\ttargetAnimationSet = this._blocks[ animSetBlockAdress ].data;\n\t\t\tvar thisAnimator;\n\n\t\t\tif ( type == 1 ) {\n\n\n\t\t\t\tthisAnimator = {\n\t\t\t\t\tanimationSet: targetAnimationSet,\n\t\t\t\t\tskeleton: this._blocks[ props.get( 1, 0 ) ].data\n\t\t\t\t};\n\n\t\t\t} else if ( type == 2 ) {\n\t\t\t\t// debug( \"vertex Anim???\");\n\t\t\t}\n\n\n\t\t\tfor ( i = 0; i < targetMeshes.length; i ++ ) {\n\n\t\t\t\ttargetMeshes[ i ].animator = thisAnimator;\n\n\t\t\t}\n\t\t\t// debug(\"Parsed a Animator: Name = \" + name);\n\n\t\t\treturn thisAnimator;\n\n\t\t},\n\n\t\tparseMeshData: function () {\n\n\t\t\tvar name = this.readUTF(),\n\t\t\t\tnum_subs = this.readU16(),\n\t\t\t\tgeom,\n\t\t\t\tsubs_parsed = 0,\n\t\t\t\tbuffer,\n\t\t\t\tgeometries = [];\n\n\t\t\t// Ignore for now\n\t\t\tthis.parseProperties( { 1: this._geoNrType, 2: this._geoNrType } );\n\n\t\t\t// Loop through sub meshes\n\t\t\twhile ( subs_parsed < num_subs ) {\n\n\t\t\t\tvar sm_len, sm_end, attrib;\n\n\t\t\t\tgeom = new BufferGeometry();\n\t\t\t\tgeom.name = name;\n\t\t\t\tgeometries.push( geom );\n\n\n\t\t\t\tsm_len = this.readU32();\n\t\t\t\tsm_end = this._ptr + sm_len;\n\n\n\t\t\t\t// Ignore for now\n\t\t\t\tthis.parseProperties( { 1: this._geoNrType, 2: this._geoNrType } );\n\n\t\t\t\t// Loop through data streams\n\t\t\t\twhile ( this._ptr < sm_end ) {\n\n\t\t\t\t\tvar idx = 0,\n\t\t\t\t\t\tstr_type = this.readU8(),\n\t\t\t\t\t\tstr_ftype = this.readU8(),\n\t\t\t\t\t\tstr_len = this.readU32(),\n\t\t\t\t\t\tstr_end = str_len + this._ptr;\n\n\t\t\t\t\tif ( str_type === 1 ) {\n\n\t\t\t\t\t\t// VERTICES\n\n\t\t\t\t\t\tbuffer = new Float32Array( ( str_len / 12 ) * 3 );\n\t\t\t\t\t\tattrib = new BufferAttribute( buffer, 3 );\n\n\t\t\t\t\t\tgeom.setAttribute( 'position', attrib );\n\t\t\t\t\t\tidx = 0;\n\n\t\t\t\t\t\twhile ( this._ptr < str_end ) {\n\n\t\t\t\t\t\t\tbuffer[ idx ] = - this.readF32();\n\t\t\t\t\t\t\tbuffer[ idx + 1 ] = this.readF32();\n\t\t\t\t\t\t\tbuffer[ idx + 2 ] = this.readF32();\n\t\t\t\t\t\t\tidx += 3;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( str_type === 2 ) {\n\n\t\t\t\t\t\t// INDICES\n\n\t\t\t\t\t\tbuffer = new Uint16Array( str_len / 2 );\n\t\t\t\t\t\tattrib = new BufferAttribute( buffer, 1 );\n\t\t\t\t\t\tgeom.setIndex( attrib );\n\n\t\t\t\t\t\tidx = 0;\n\n\t\t\t\t\t\twhile ( this._ptr < str_end ) {\n\n\t\t\t\t\t\t\tbuffer[ idx + 1 ] = this.readU16();\n\t\t\t\t\t\t\tbuffer[ idx ] = this.readU16();\n\t\t\t\t\t\t\tbuffer[ idx + 2 ] = this.readU16();\n\t\t\t\t\t\t\tidx += 3;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( str_type === 3 ) {\n\n\t\t\t\t\t\t// UVS\n\n\t\t\t\t\t\tbuffer = new Float32Array( ( str_len / 8 ) * 2 );\n\t\t\t\t\t\tattrib = new BufferAttribute( buffer, 2 );\n\n\t\t\t\t\t\tgeom.setAttribute( 'uv', attrib );\n\t\t\t\t\t\tidx = 0;\n\n\t\t\t\t\t\twhile ( this._ptr < str_end ) {\n\n\t\t\t\t\t\t\tbuffer[ idx ] = this.readF32();\n\t\t\t\t\t\t\tbuffer[ idx + 1 ] = 1.0 - this.readF32();\n\t\t\t\t\t\t\tidx += 2;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( str_type === 4 ) {\n\n\t\t\t\t\t\t// NORMALS\n\n\t\t\t\t\t\tbuffer = new Float32Array( ( str_len / 12 ) * 3 );\n\t\t\t\t\t\tattrib = new BufferAttribute( buffer, 3 );\n\t\t\t\t\t\tgeom.setAttribute( 'normal', attrib );\n\t\t\t\t\t\tidx = 0;\n\n\t\t\t\t\t\twhile ( this._ptr < str_end ) {\n\n\t\t\t\t\t\t\tbuffer[ idx ] = - this.readF32();\n\t\t\t\t\t\t\tbuffer[ idx + 1 ] = this.readF32();\n\t\t\t\t\t\t\tbuffer[ idx + 2 ] = this.readF32();\n\t\t\t\t\t\t\tidx += 3;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis._ptr = str_end;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis.parseUserAttributes();\n\n\t\t\t\tgeom.computeBoundingSphere();\n\t\t\t\tsubs_parsed ++;\n\n\t\t\t}\n\n\t\t\t//geom.computeFaceNormals();\n\n\t\t\tthis.parseUserAttributes();\n\t\t\t//finalizeAsset(geom, name);\n\n\t\t\treturn geometries;\n\n\t\t},\n\n\t\tparseMeshPoseAnimation: function ( poseOnly ) {\n\n\t\t\tvar num_frames = 1,\n\t\t\t\tnum_submeshes,\n\t\t\t\tframes_parsed,\n\t\t\t\tsubMeshParsed,\n\n\t\t\t\tstr_len,\n\t\t\t\tstr_end,\n\t\t\t\tgeom,\n\t\t\t\tidx = 0,\n\t\t\t\tclip = {},\n\t\t\t\tnum_Streams,\n\t\t\t\tstreamsParsed,\n\t\t\t\tstreamtypes = [],\n\n\t\t\t\tprops,\n\t\t\t\tname = this.readUTF(),\n\t\t\t\tgeoAdress = this.readU32();\n\n\t\t\tvar mesh = this.getBlock( geoAdress );\n\n\t\t\tif ( mesh === null ) {\n\n\t\t\t\tconsole.log( \"parseMeshPoseAnimation target mesh not found at:\", geoAdress );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tgeom = mesh.geometry;\n\t\t\tgeom.morphTargets = [];\n\n\t\t\tif ( ! poseOnly )\n\t\t\t\tnum_frames = this.readU16();\n\n\t\t\tnum_submeshes = this.readU16();\n\t\t\tnum_Streams = this.readU16();\n\n\t\t\t// debug(\"VA num_frames : \", num_frames );\n\t\t\t// debug(\"VA num_submeshes : \", num_submeshes );\n\t\t\t// debug(\"VA numstreams : \", num_Streams );\n\n\t\t\tstreamsParsed = 0;\n\t\t\twhile ( streamsParsed < num_Streams ) {\n\n\t\t\t\tstreamtypes.push( this.readU16() );\n\t\t\t\tstreamsParsed ++;\n\n\t\t\t}\n\t\t\tprops = this.parseProperties( { 1: BOOL, 2: BOOL } );\n\n\t\t\tclip.looping = props.get( 1, true );\n\t\t\tclip.stitchFinalFrame = props.get( 2, false );\n\n\t\t\tframes_parsed = 0;\n\n\t\t\twhile ( frames_parsed < num_frames ) {\n\n\t\t\t\tthis.readU16();\n\t\t\t\tsubMeshParsed = 0;\n\n\t\t\t\twhile ( subMeshParsed < num_submeshes ) {\n\n\t\t\t\t\tstreamsParsed = 0;\n\t\t\t\t\tstr_len = this.readU32();\n\t\t\t\t\tstr_end = this._ptr + str_len;\n\n\t\t\t\t\twhile ( streamsParsed < num_Streams ) {\n\n\t\t\t\t\t\tif ( streamtypes[ streamsParsed ] === 1 ) {\n\n\t\t\t\t\t\t\t//geom.setAttribute( 'morphTarget'+frames_parsed, Float32Array, str_len/12, 3 );\n\t\t\t\t\t\t\tvar buffer = new Float32Array( str_len / 4 );\n\t\t\t\t\t\t\tgeom.morphTargets.push( {\n\t\t\t\t\t\t\t\tarray: buffer\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t//buffer = geom.attributes['morphTarget'+frames_parsed].array\n\t\t\t\t\t\t\tidx = 0;\n\n\t\t\t\t\t\t\twhile ( this._ptr < str_end ) {\n\n\t\t\t\t\t\t\t\tbuffer[ idx ] = this.readF32();\n\t\t\t\t\t\t\t\tbuffer[ idx + 1 ] = this.readF32();\n\t\t\t\t\t\t\t\tbuffer[ idx + 2 ] = this.readF32();\n\t\t\t\t\t\t\t\tidx += 3;\n\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tsubMeshParsed ++;\n\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tthis._ptr = str_end;\n\t\t\t\t\t\tstreamsParsed ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\n\t\t\t\tframes_parsed ++;\n\n\t\t\t}\n\n\t\t\tthis.parseUserAttributes();\n\n\t\t\treturn null;\n\n\t\t},\n\n\t\tgetBlock: function ( id ) {\n\n\t\t\treturn this._blocks[ id ].data;\n\n\t\t},\n\n\t\tparseMatrix4: function () {\n\n\t\t\tvar mtx = new Matrix4();\n\t\t\tvar e = mtx.elements;\n\n\t\t\te[ 0 ] = this.readF32();\n\t\t\te[ 1 ] = this.readF32();\n\t\t\te[ 2 ] = this.readF32();\n\t\t\te[ 3 ] = 0.0;\n\t\t\t//e[3] = 0.0;\n\n\t\t\te[ 4 ] = this.readF32();\n\t\t\te[ 5 ] = this.readF32();\n\t\t\te[ 6 ] = this.readF32();\n\t\t\t//e[7] = this.readF32();\n\t\t\te[ 7 ] = 0.0;\n\n\t\t\te[ 8 ] = this.readF32();\n\t\t\te[ 9 ] = this.readF32();\n\t\t\te[ 10 ] = this.readF32();\n\t\t\t//e[11] = this.readF32();\n\t\t\te[ 11 ] = 0.0;\n\n\t\t\te[ 12 ] = - this.readF32();\n\t\t\te[ 13 ] = this.readF32();\n\t\t\te[ 14 ] = this.readF32();\n\t\t\t//e[15] = this.readF32();\n\t\t\te[ 15 ] = 1.0;\n\t\t\treturn mtx;\n\n\t\t},\n\n\t\tparseProperties: function ( expected ) {\n\n\t\t\tvar list_len = this.readU32();\n\t\t\tvar list_end = this._ptr + list_len;\n\n\t\t\tvar props = new AWDProperties();\n\n\t\t\tif ( expected ) {\n\n\t\t\t\twhile ( this._ptr < list_end ) {\n\n\t\t\t\t\tvar key = this.readU16();\n\t\t\t\t\tvar len = this.readU32();\n\t\t\t\t\tvar type;\n\n\t\t\t\t\tif ( expected.hasOwnProperty( key ) ) {\n\n\t\t\t\t\t\ttype = expected[ key ];\n\t\t\t\t\t\tprops.set( key, this.parseAttrValue( type, len ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis._ptr += len;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn props;\n\n\t\t},\n\n\t\tparseUserAttributes: function () {\n\n\t\t\t// skip for now\n\t\t\tthis._ptr = this.readU32() + this._ptr;\n\t\t\treturn null;\n\n\t\t},\n\n\t\tparseAttrValue: function ( type, len ) {\n\n\t\t\tvar elem_len;\n\t\t\tvar read_func;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase AWD_FIELD_INT8:\n\t\t\t\t\telem_len = 1;\n\t\t\t\t\tread_func = this.readI8;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD_FIELD_INT16:\n\t\t\t\t\telem_len = 2;\n\t\t\t\t\tread_func = this.readI16;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD_FIELD_INT32:\n\t\t\t\t\telem_len = 4;\n\t\t\t\t\tread_func = this.readI32;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD_FIELD_BOOL:\n\t\t\t\tcase AWD_FIELD_UINT8:\n\t\t\t\t\telem_len = 1;\n\t\t\t\t\tread_func = this.readU8;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD_FIELD_UINT16:\n\t\t\t\t\telem_len = 2;\n\t\t\t\t\tread_func = this.readU16;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD_FIELD_UINT32:\n\t\t\t\tcase AWD_FIELD_BADDR:\n\t\t\t\t\telem_len = 4;\n\t\t\t\t\tread_func = this.readU32;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD_FIELD_FLOAT32:\n\t\t\t\t\telem_len = 4;\n\t\t\t\t\tread_func = this.readF32;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD_FIELD_FLOAT64:\n\t\t\t\t\telem_len = 8;\n\t\t\t\t\tread_func = this.readF64;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD_FIELD_VECTOR2x1:\n\t\t\t\tcase AWD_FIELD_VECTOR3x1:\n\t\t\t\tcase AWD_FIELD_VECTOR4x1:\n\t\t\t\tcase AWD_FIELD_MTX3x2:\n\t\t\t\tcase AWD_FIELD_MTX3x3:\n\t\t\t\tcase AWD_FIELD_MTX4x3:\n\t\t\t\tcase AWD_FIELD_MTX4x4:\n\t\t\t\t\telem_len = 8;\n\t\t\t\t\tread_func = this.readF64;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( elem_len < len ) {\n\n\t\t\t\tvar list;\n\t\t\t\tvar num_read;\n\t\t\t\tvar num_elems;\n\n\t\t\t\tlist = [];\n\t\t\t\tnum_read = 0;\n\t\t\t\tnum_elems = len / elem_len;\n\n\t\t\t\twhile ( num_read < num_elems ) {\n\n\t\t\t\t\tlist.push( read_func.call( this ) );\n\t\t\t\t\tnum_read ++;\n\n\t\t\t\t}\n\n\t\t\t\treturn list;\n\n\t\t\t} else {\n\n\t\t\t\treturn read_func.call( this );\n\n\t\t\t}\n\n\t\t},\n\n\t\treadU8: function () {\n\n\t\t\treturn this._data.getUint8( this._ptr ++ );\n\n\t\t},\n\t\treadI8: function () {\n\n\t\t\treturn this._data.getInt8( this._ptr ++ );\n\n\t\t},\n\t\treadU16: function () {\n\n\t\t\tvar a = this._data.getUint16( this._ptr, littleEndian );\n\t\t\tthis._ptr += 2;\n\t\t\treturn a;\n\n\t\t},\n\t\treadI16: function () {\n\n\t\t\tvar a = this._data.getInt16( this._ptr, littleEndian );\n\t\t\tthis._ptr += 2;\n\t\t\treturn a;\n\n\t\t},\n\t\treadU32: function () {\n\n\t\t\tvar a = this._data.getUint32( this._ptr, littleEndian );\n\t\t\tthis._ptr += 4;\n\t\t\treturn a;\n\n\t\t},\n\t\treadI32: function () {\n\n\t\t\tvar a = this._data.getInt32( this._ptr, littleEndian );\n\t\t\tthis._ptr += 4;\n\t\t\treturn a;\n\n\t\t},\n\t\treadF32: function () {\n\n\t\t\tvar a = this._data.getFloat32( this._ptr, littleEndian );\n\t\t\tthis._ptr += 4;\n\t\t\treturn a;\n\n\t\t},\n\t\treadF64: function () {\n\n\t\t\tvar a = this._data.getFloat64( this._ptr, littleEndian );\n\t\t\tthis._ptr += 8;\n\t\t\treturn a;\n\n\t\t},\n\n\t\t/**\n\t * Converts a UTF-8 byte array to JavaScript's 16-bit Unicode.\n\t * @param {Array.<number>} bytes UTF-8 byte array.\n\t * @return {string} 16-bit Unicode string.\n\t */\n\t\treadUTF: function () {\n\n\t\t\tvar len = this.readU16();\n\t\t\treturn this.readUTFBytes( len );\n\n\t\t},\n\n\t\t/**\n\t\t * Converts a UTF-8 byte array to JavaScript's 16-bit Unicode.\n\t\t * @param {Array.<number>} bytes UTF-8 byte array.\n\t\t * @return {string} 16-bit Unicode string.\n\t\t */\n\t\treadUTFBytes: function ( len ) {\n\n\t\t\t// TODO(user): Use native implementations if/when available\n\t\t\tvar out = [], c = 0;\n\n\t\t\twhile ( out.length < len ) {\n\n\t\t\t\tvar c1 = this._data.getUint8( this._ptr ++, littleEndian );\n\t\t\t\tif ( c1 < 128 ) {\n\n\t\t\t\t\tout[ c ++ ] = String.fromCharCode( c1 );\n\n\t\t\t\t} else if ( c1 > 191 && c1 < 224 ) {\n\n\t\t\t\t\tvar c2 = this._data.getUint8( this._ptr ++, littleEndian );\n\t\t\t\t\tout[ c ++ ] = String.fromCharCode( ( c1 & 31 ) << 6 | c2 & 63 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar c2 = this._data.getUint8( this._ptr ++, littleEndian );\n\t\t\t\t\tvar c3 = this._data.getUint8( this._ptr ++, littleEndian );\n\t\t\t\t\tout[ c ++ ] = String.fromCharCode( ( c1 & 15 ) << 12 | ( c2 & 63 ) << 6 | c3 & 63 );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\treturn out.join( '' );\n\n\t\t}\n\n\t} );\n\n\treturn AWDLoader;\n\n} )();\n\nexport { AWDLoader };\n"]}