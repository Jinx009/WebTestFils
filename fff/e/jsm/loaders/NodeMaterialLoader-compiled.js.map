{"version":3,"sources":["NodeMaterialLoader.js"],"names":[],"mappings":"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","file":"NodeMaterialLoader-compiled.js","sourcesContent":["/**\n * @author sunag / http://www.sunag.com.br/\n */\n\nimport {\n\tDefaultLoadingManager,\n\tFileLoader\n} from \"../../../build/three.module.js\";\n\nimport * as Nodes from \"../nodes/Nodes.js\";\n\nvar NodeMaterialLoader = function ( manager, library ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\tthis.nodes = {};\n\tthis.materials = {};\n\tthis.passes = {};\n\tthis.names = {};\n\tthis.library = library || {};\n\n};\n\nvar NodeMaterialLoaderUtils = {\n\n\treplaceUUIDObject: function ( object, uuid, value, recursive ) {\n\n\t\trecursive = recursive !== undefined ? recursive : true;\n\n\t\tif ( typeof uuid === \"object\" ) uuid = uuid.uuid;\n\n\t\tif ( typeof object === \"object\" ) {\n\n\t\t\tvar keys = Object.keys( object );\n\n\t\t\tfor ( var i = 0; i < keys.length; i ++ ) {\n\n\t\t\t\tvar key = keys[ i ];\n\n\t\t\t\tif ( recursive ) {\n\n\t\t\t\t\tobject[ key ] = this.replaceUUIDObject( object[ key ], uuid, value );\n\n\t\t\t\t}\n\n\t\t\t\tif ( key === uuid ) {\n\n\t\t\t\t\tobject[ uuid ] = object[ key ];\n\n\t\t\t\t\tdelete object[ key ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn object === uuid ? value : object;\n\n\t},\n\n\treplaceUUID: function ( json, uuid, value ) {\n\n\t\tthis.replaceUUIDObject( json, uuid, value, false );\n\t\tthis.replaceUUIDObject( json.nodes, uuid, value );\n\t\tthis.replaceUUIDObject( json.materials, uuid, value );\n\t\tthis.replaceUUIDObject( json.passes, uuid, value );\n\t\tthis.replaceUUIDObject( json.library, uuid, value, false );\n\n\t\treturn json;\n\n\t}\n\n};\n\nObject.assign( NodeMaterialLoader.prototype, {\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t}, onProgress, onError );\n\n\t\treturn this;\n\n\t},\n\n\tsetPath: function ( value ) {\n\n\t\tthis.path = value;\n\t\treturn this;\n\n\t},\n\n\tgetObjectByName: function ( uuid ) {\n\n\t\treturn this.names[ uuid ];\n\n\t},\n\n\tgetObjectById: function ( uuid ) {\n\n\t\treturn this.library[ uuid ] ||\n\t\t\tthis.nodes[ uuid ] ||\n\t\t\tthis.materials[ uuid ] ||\n\t\t\tthis.passes[ uuid ] ||\n\t\t\tthis.names[ uuid ];\n\n\t},\n\n\tgetNode: function ( uuid ) {\n\n\t\tvar object = this.getObjectById( uuid );\n\n\t\tif ( ! object ) {\n\n\t\t\tconsole.warn( \"Node \\\"\" + uuid + \"\\\" not found.\" );\n\n\t\t}\n\n\t\treturn object;\n\n\t},\n\n\tresolve: function ( json ) {\n\n\t\tswitch ( typeof json ) {\n\n\t\t\tcase \"boolean\":\n\t\t\tcase \"number\":\n\n\t\t\t\treturn json;\n\n\t\t\tcase \"string\":\n\n\t\t\t\tif ( /^\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}$/i.test( json ) || this.library[ json ] ) {\n\n\t\t\t\t\treturn this.getNode( json );\n\n\t\t\t\t}\n\n\t\t\t\treturn json;\n\n\t\t\tdefault:\n\n\t\t\t\tif ( Array.isArray( json ) ) {\n\n\t\t\t\t\tfor ( var i = 0; i < json.length; i ++ ) {\n\n\t\t\t\t\t\tjson[ i ] = this.resolve( json[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfor ( var prop in json ) {\n\n\t\t\t\t\t\tif ( prop === \"uuid\" ) continue;\n\n\t\t\t\t\t\tjson[ prop ] = this.resolve( json[ prop ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t}\n\n\t\treturn json;\n\n\t},\n\n\tdeclare: function ( json ) {\n\n\t\tvar uuid, node, object;\n\n\t\tfor ( uuid in json.nodes ) {\n\n\t\t\tnode = json.nodes[ uuid ];\n\n\t\t\tobject = new Nodes[ node.nodeType + \"Node\" ]();\n\n\t\t\tif ( node.name ) {\n\n\t\t\t\tobject.name = node.name;\n\n\t\t\t\tthis.names[ object.name ] = object;\n\n\t\t\t}\n\n\t\t\tthis.nodes[ uuid ] = object;\n\n\t\t}\n\n\t\tfor ( uuid in json.materials ) {\n\n\t\t\tnode = json.materials[ uuid ];\n\n\t\t\tobject = new Nodes[ node.type ]();\n\n\t\t\tif ( node.name ) {\n\n\t\t\t\tobject.name = node.name;\n\n\t\t\t\tthis.names[ object.name ] = object;\n\n\t\t\t}\n\n\t\t\tthis.materials[ uuid ] = object;\n\n\t\t}\n\n\t\tfor ( uuid in json.passes ) {\n\n\t\t\tnode = json.passes[ uuid ];\n\n\t\t\tobject = new Nodes[ node.type ]();\n\n\t\t\tif ( node.name ) {\n\n\t\t\t\tobject.name = node.name;\n\n\t\t\t\tthis.names[ object.name ] = object;\n\n\t\t\t}\n\n\t\t\tthis.passes[ uuid ] = object;\n\n\t\t}\n\n\t\tif ( json.material ) this.material = this.materials[ json.material ];\n\n\t\tif ( json.pass ) this.pass = this.passes[ json.pass ];\n\n\t\treturn json;\n\n\t},\n\n\tparse: function ( json ) {\n\n\t\tvar uuid;\n\n\t\tjson = this.resolve( this.declare( json ) );\n\n\t\tfor ( uuid in json.nodes ) {\n\n\t\t\tthis.nodes[ uuid ].copy( json.nodes[ uuid ] );\n\n\t\t}\n\n\t\tfor ( uuid in json.materials ) {\n\n\t\t\tthis.materials[ uuid ].copy( json.materials[ uuid ] );\n\n\t\t}\n\n\t\tfor ( uuid in json.passes ) {\n\n\t\t\tthis.passes[ uuid ].copy( json.passes[ uuid ] );\n\n\t\t}\n\n\t\treturn this.material || this.pass || this;\n\n\t}\n\n} );\n\nexport { NodeMaterialLoader, NodeMaterialLoaderUtils };\n"]}