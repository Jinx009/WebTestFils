{"version":3,"sources":["ColladaLoader.js"],"names":[],"mappings":"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","file":"ColladaLoader-compiled.js","sourcesContent":["/**\n * @author mrdoob / http://mrdoob.com/\n * @author Mugen87 / https://github.com/Mugen87\n */\n\nimport {\n\tAmbientLight,\n\tAnimationClip,\n\tBone,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tDoubleSide,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLine,\n\tLineBasicMaterial,\n\tLineSegments,\n\tLoader,\n\tLoaderUtils,\n\tMath as _Math,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshLambertMaterial,\n\tMeshPhongMaterial,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tScene,\n\tSkeleton,\n\tSkinnedMesh,\n\tSpotLight,\n\tTextureLoader,\n\tVector3,\n\tVectorKeyframeTrack\n} from \"../../../build/three.module.js\";\nimport { TGALoader } from \"../loaders/TGALoader.js\";\n\nvar ColladaLoader = function ( manager ) {\n\n\tLoader.call( this, manager );\n\n};\n\nColladaLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: ColladaLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\n\n\t\tvar loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tonLoad( scope.parse( text, path ) );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\toptions: {\n\n\t\tset convertUpAxis( value ) {\n\n\t\t\tconsole.warn( 'THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.' );\n\n\t\t}\n\n\t},\n\n\tparse: function ( text, path ) {\n\n\t\tfunction getElementsByTagName( xml, name ) {\n\n\t\t\t// Non recursive xml.getElementsByTagName() ...\n\n\t\t\tvar array = [];\n\t\t\tvar childNodes = xml.childNodes;\n\n\t\t\tfor ( var i = 0, l = childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = childNodes[ i ];\n\n\t\t\t\tif ( child.nodeName === name ) {\n\n\t\t\t\t\tarray.push( child );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn array;\n\n\t\t}\n\n\t\tfunction parseStrings( text ) {\n\n\t\t\tif ( text.length === 0 ) return [];\n\n\t\t\tvar parts = text.trim().split( /\\s+/ );\n\t\t\tvar array = new Array( parts.length );\n\n\t\t\tfor ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ] = parts[ i ];\n\n\t\t\t}\n\n\t\t\treturn array;\n\n\t\t}\n\n\t\tfunction parseFloats( text ) {\n\n\t\t\tif ( text.length === 0 ) return [];\n\n\t\t\tvar parts = text.trim().split( /\\s+/ );\n\t\t\tvar array = new Array( parts.length );\n\n\t\t\tfor ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ] = parseFloat( parts[ i ] );\n\n\t\t\t}\n\n\t\t\treturn array;\n\n\t\t}\n\n\t\tfunction parseInts( text ) {\n\n\t\t\tif ( text.length === 0 ) return [];\n\n\t\t\tvar parts = text.trim().split( /\\s+/ );\n\t\t\tvar array = new Array( parts.length );\n\n\t\t\tfor ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ] = parseInt( parts[ i ] );\n\n\t\t\t}\n\n\t\t\treturn array;\n\n\t\t}\n\n\t\tfunction parseId( text ) {\n\n\t\t\treturn text.substring( 1 );\n\n\t\t}\n\n\t\tfunction generateId() {\n\n\t\t\treturn 'three_default_' + ( count ++ );\n\n\t\t}\n\n\t\tfunction isEmpty( object ) {\n\n\t\t\treturn Object.keys( object ).length === 0;\n\n\t\t}\n\n\t\t// asset\n\n\t\tfunction parseAsset( xml ) {\n\n\t\t\treturn {\n\t\t\t\tunit: parseAssetUnit( getElementsByTagName( xml, 'unit' )[ 0 ] ),\n\t\t\t\tupAxis: parseAssetUpAxis( getElementsByTagName( xml, 'up_axis' )[ 0 ] )\n\t\t\t};\n\n\t\t}\n\n\t\tfunction parseAssetUnit( xml ) {\n\n\t\t\tif ( ( xml !== undefined ) && ( xml.hasAttribute( 'meter' ) === true ) ) {\n\n\t\t\t\treturn parseFloat( xml.getAttribute( 'meter' ) );\n\n\t\t\t} else {\n\n\t\t\t\treturn 1; // default 1 meter\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parseAssetUpAxis( xml ) {\n\n\t\t\treturn xml !== undefined ? xml.textContent : 'Y_UP';\n\n\t\t}\n\n\t\t// library\n\n\t\tfunction parseLibrary( xml, libraryName, nodeName, parser ) {\n\n\t\t\tvar library = getElementsByTagName( xml, libraryName )[ 0 ];\n\n\t\t\tif ( library !== undefined ) {\n\n\t\t\t\tvar elements = getElementsByTagName( library, nodeName );\n\n\t\t\t\tfor ( var i = 0; i < elements.length; i ++ ) {\n\n\t\t\t\t\tparser( elements[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction buildLibrary( data, builder ) {\n\n\t\t\tfor ( var name in data ) {\n\n\t\t\t\tvar object = data[ name ];\n\t\t\t\tobject.build = builder( data[ name ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// get\n\n\t\tfunction getBuild( data, builder ) {\n\n\t\t\tif ( data.build !== undefined ) return data.build;\n\n\t\t\tdata.build = builder( data );\n\n\t\t\treturn data.build;\n\n\t\t}\n\n\t\t// animation\n\n\t\tfunction parseAnimation( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tsources: {},\n\t\t\t\tsamplers: {},\n\t\t\t\tchannels: {}\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tvar id;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'source':\n\t\t\t\t\t\tid = child.getAttribute( 'id' );\n\t\t\t\t\t\tdata.sources[ id ] = parseSource( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'sampler':\n\t\t\t\t\t\tid = child.getAttribute( 'id' );\n\t\t\t\t\t\tdata.samplers[ id ] = parseAnimationSampler( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'channel':\n\t\t\t\t\t\tid = child.getAttribute( 'target' );\n\t\t\t\t\t\tdata.channels[ id ] = parseAnimationChannel( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.log( child );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.animations[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction parseAnimationSampler( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tinputs: {},\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'input':\n\t\t\t\t\t\tvar id = parseId( child.getAttribute( 'source' ) );\n\t\t\t\t\t\tvar semantic = child.getAttribute( 'semantic' );\n\t\t\t\t\t\tdata.inputs[ semantic ] = id;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseAnimationChannel( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tvar target = xml.getAttribute( 'target' );\n\n\t\t\t// parsing SID Addressing Syntax\n\n\t\t\tvar parts = target.split( '/' );\n\n\t\t\tvar id = parts.shift();\n\t\t\tvar sid = parts.shift();\n\n\t\t\t// check selection syntax\n\n\t\t\tvar arraySyntax = ( sid.indexOf( '(' ) !== - 1 );\n\t\t\tvar memberSyntax = ( sid.indexOf( '.' ) !== - 1 );\n\n\t\t\tif ( memberSyntax ) {\n\n\t\t\t\t//  member selection access\n\n\t\t\t\tparts = sid.split( '.' );\n\t\t\t\tsid = parts.shift();\n\t\t\t\tdata.member = parts.shift();\n\n\t\t\t} else if ( arraySyntax ) {\n\n\t\t\t\t// array-access syntax. can be used to express fields in one-dimensional vectors or two-dimensional matrices.\n\n\t\t\t\tvar indices = sid.split( '(' );\n\t\t\t\tsid = indices.shift();\n\n\t\t\t\tfor ( var i = 0; i < indices.length; i ++ ) {\n\n\t\t\t\t\tindices[ i ] = parseInt( indices[ i ].replace( /\\)/, '' ) );\n\n\t\t\t\t}\n\n\t\t\t\tdata.indices = indices;\n\n\t\t\t}\n\n\t\t\tdata.id = id;\n\t\t\tdata.sid = sid;\n\n\t\t\tdata.arraySyntax = arraySyntax;\n\t\t\tdata.memberSyntax = memberSyntax;\n\n\t\t\tdata.sampler = parseId( xml.getAttribute( 'source' ) );\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction buildAnimation( data ) {\n\n\t\t\tvar tracks = [];\n\n\t\t\tvar channels = data.channels;\n\t\t\tvar samplers = data.samplers;\n\t\t\tvar sources = data.sources;\n\n\t\t\tfor ( var target in channels ) {\n\n\t\t\t\tif ( channels.hasOwnProperty( target ) ) {\n\n\t\t\t\t\tvar channel = channels[ target ];\n\t\t\t\t\tvar sampler = samplers[ channel.sampler ];\n\n\t\t\t\t\tvar inputId = sampler.inputs.INPUT;\n\t\t\t\t\tvar outputId = sampler.inputs.OUTPUT;\n\n\t\t\t\t\tvar inputSource = sources[ inputId ];\n\t\t\t\t\tvar outputSource = sources[ outputId ];\n\n\t\t\t\t\tvar animation = buildAnimationChannel( channel, inputSource, outputSource );\n\n\t\t\t\t\tcreateKeyframeTracks( animation, tracks );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn tracks;\n\n\t\t}\n\n\t\tfunction getAnimation( id ) {\n\n\t\t\treturn getBuild( library.animations[ id ], buildAnimation );\n\n\t\t}\n\n\t\tfunction buildAnimationChannel( channel, inputSource, outputSource ) {\n\n\t\t\tvar node = library.nodes[ channel.id ];\n\t\t\tvar object3D = getNode( node.id );\n\n\t\t\tvar transform = node.transforms[ channel.sid ];\n\t\t\tvar defaultMatrix = node.matrix.clone().transpose();\n\n\t\t\tvar time, stride;\n\t\t\tvar i, il, j, jl;\n\n\t\t\tvar data = {};\n\n\t\t\t// the collada spec allows the animation of data in various ways.\n\t\t\t// depending on the transform type (matrix, translate, rotate, scale), we execute different logic\n\n\t\t\tswitch ( transform ) {\n\n\t\t\t\tcase 'matrix':\n\n\t\t\t\t\tfor ( i = 0, il = inputSource.array.length; i < il; i ++ ) {\n\n\t\t\t\t\t\ttime = inputSource.array[ i ];\n\t\t\t\t\t\tstride = i * outputSource.stride;\n\n\t\t\t\t\t\tif ( data[ time ] === undefined ) data[ time ] = {};\n\n\t\t\t\t\t\tif ( channel.arraySyntax === true ) {\n\n\t\t\t\t\t\t\tvar value = outputSource.array[ stride ];\n\t\t\t\t\t\t\tvar index = channel.indices[ 0 ] + 4 * channel.indices[ 1 ];\n\n\t\t\t\t\t\t\tdata[ time ][ index ] = value;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tfor ( j = 0, jl = outputSource.stride; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\t\tdata[ time ][ j ] = outputSource.array[ stride + j ];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'translate':\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'rotate':\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'scale':\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tvar keyframes = prepareAnimationData( data, defaultMatrix );\n\n\t\t\tvar animation = {\n\t\t\t\tname: object3D.uuid,\n\t\t\t\tkeyframes: keyframes\n\t\t\t};\n\n\t\t\treturn animation;\n\n\t\t}\n\n\t\tfunction prepareAnimationData( data, defaultMatrix ) {\n\n\t\t\tvar keyframes = [];\n\n\t\t\t// transfer data into a sortable array\n\n\t\t\tfor ( var time in data ) {\n\n\t\t\t\tkeyframes.push( { time: parseFloat( time ), value: data[ time ] } );\n\n\t\t\t}\n\n\t\t\t// ensure keyframes are sorted by time\n\n\t\t\tkeyframes.sort( ascending );\n\n\t\t\t// now we clean up all animation data, so we can use them for keyframe tracks\n\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\n\n\t\t\t\ttransformAnimationData( keyframes, i, defaultMatrix.elements[ i ] );\n\n\t\t\t}\n\n\t\t\treturn keyframes;\n\n\t\t\t// array sort function\n\n\t\t\tfunction ascending( a, b ) {\n\n\t\t\t\treturn a.time - b.time;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar position = new Vector3();\n\t\tvar scale = new Vector3();\n\t\tvar quaternion = new Quaternion();\n\n\t\tfunction createKeyframeTracks( animation, tracks ) {\n\n\t\t\tvar keyframes = animation.keyframes;\n\t\t\tvar name = animation.name;\n\n\t\t\tvar times = [];\n\t\t\tvar positionData = [];\n\t\t\tvar quaternionData = [];\n\t\t\tvar scaleData = [];\n\n\t\t\tfor ( var i = 0, l = keyframes.length; i < l; i ++ ) {\n\n\t\t\t\tvar keyframe = keyframes[ i ];\n\n\t\t\t\tvar time = keyframe.time;\n\t\t\t\tvar value = keyframe.value;\n\n\t\t\t\tmatrix.fromArray( value ).transpose();\n\t\t\t\tmatrix.decompose( position, quaternion, scale );\n\n\t\t\t\ttimes.push( time );\n\t\t\t\tpositionData.push( position.x, position.y, position.z );\n\t\t\t\tquaternionData.push( quaternion.x, quaternion.y, quaternion.z, quaternion.w );\n\t\t\t\tscaleData.push( scale.x, scale.y, scale.z );\n\n\t\t\t}\n\n\t\t\tif ( positionData.length > 0 ) tracks.push( new VectorKeyframeTrack( name + '.position', times, positionData ) );\n\t\t\tif ( quaternionData.length > 0 ) tracks.push( new QuaternionKeyframeTrack( name + '.quaternion', times, quaternionData ) );\n\t\t\tif ( scaleData.length > 0 ) tracks.push( new VectorKeyframeTrack( name + '.scale', times, scaleData ) );\n\n\t\t\treturn tracks;\n\n\t\t}\n\n\t\tfunction transformAnimationData( keyframes, property, defaultValue ) {\n\n\t\t\tvar keyframe;\n\n\t\t\tvar empty = true;\n\t\t\tvar i, l;\n\n\t\t\t// check, if values of a property are missing in our keyframes\n\n\t\t\tfor ( i = 0, l = keyframes.length; i < l; i ++ ) {\n\n\t\t\t\tkeyframe = keyframes[ i ];\n\n\t\t\t\tif ( keyframe.value[ property ] === undefined ) {\n\n\t\t\t\t\tkeyframe.value[ property ] = null; // mark as missing\n\n\t\t\t\t} else {\n\n\t\t\t\t\tempty = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( empty === true ) {\n\n\t\t\t\t// no values at all, so we set a default value\n\n\t\t\t\tfor ( i = 0, l = keyframes.length; i < l; i ++ ) {\n\n\t\t\t\t\tkeyframe = keyframes[ i ];\n\n\t\t\t\t\tkeyframe.value[ property ] = defaultValue;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// filling gaps\n\n\t\t\t\tcreateMissingKeyframes( keyframes, property );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction createMissingKeyframes( keyframes, property ) {\n\n\t\t\tvar prev, next;\n\n\t\t\tfor ( var i = 0, l = keyframes.length; i < l; i ++ ) {\n\n\t\t\t\tvar keyframe = keyframes[ i ];\n\n\t\t\t\tif ( keyframe.value[ property ] === null ) {\n\n\t\t\t\t\tprev = getPrev( keyframes, i, property );\n\t\t\t\t\tnext = getNext( keyframes, i, property );\n\n\t\t\t\t\tif ( prev === null ) {\n\n\t\t\t\t\t\tkeyframe.value[ property ] = next.value[ property ];\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( next === null ) {\n\n\t\t\t\t\t\tkeyframe.value[ property ] = prev.value[ property ];\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tinterpolate( keyframe, prev, next, property );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getPrev( keyframes, i, property ) {\n\n\t\t\twhile ( i >= 0 ) {\n\n\t\t\t\tvar keyframe = keyframes[ i ];\n\n\t\t\t\tif ( keyframe.value[ property ] !== null ) return keyframe;\n\n\t\t\t\ti --;\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfunction getNext( keyframes, i, property ) {\n\n\t\t\twhile ( i < keyframes.length ) {\n\n\t\t\t\tvar keyframe = keyframes[ i ];\n\n\t\t\t\tif ( keyframe.value[ property ] !== null ) return keyframe;\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfunction interpolate( key, prev, next, property ) {\n\n\t\t\tif ( ( next.time - prev.time ) === 0 ) {\n\n\t\t\t\tkey.value[ property ] = prev.value[ property ];\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tkey.value[ property ] = ( ( key.time - prev.time ) * ( next.value[ property ] - prev.value[ property ] ) / ( next.time - prev.time ) ) + prev.value[ property ];\n\n\t\t}\n\n\t\t// animation clips\n\n\t\tfunction parseAnimationClip( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tname: xml.getAttribute( 'id' ) || 'default',\n\t\t\t\tstart: parseFloat( xml.getAttribute( 'start' ) || 0 ),\n\t\t\t\tend: parseFloat( xml.getAttribute( 'end' ) || 0 ),\n\t\t\t\tanimations: []\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'instance_animation':\n\t\t\t\t\t\tdata.animations.push( parseId( child.getAttribute( 'url' ) ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.clips[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction buildAnimationClip( data ) {\n\n\t\t\tvar tracks = [];\n\n\t\t\tvar name = data.name;\n\t\t\tvar duration = ( data.end - data.start ) || - 1;\n\t\t\tvar animations = data.animations;\n\n\t\t\tfor ( var i = 0, il = animations.length; i < il; i ++ ) {\n\n\t\t\t\tvar animationTracks = getAnimation( animations[ i ] );\n\n\t\t\t\tfor ( var j = 0, jl = animationTracks.length; j < jl; j ++ ) {\n\n\t\t\t\t\ttracks.push( animationTracks[ j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( name, duration, tracks );\n\n\t\t}\n\n\t\tfunction getAnimationClip( id ) {\n\n\t\t\treturn getBuild( library.clips[ id ], buildAnimationClip );\n\n\t\t}\n\n\t\t// controller\n\n\t\tfunction parseController( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'skin':\n\t\t\t\t\t\t// there is exactly one skin per controller\n\t\t\t\t\t\tdata.id = parseId( child.getAttribute( 'source' ) );\n\t\t\t\t\t\tdata.skin = parseSkin( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'morph':\n\t\t\t\t\t\tdata.id = parseId( child.getAttribute( 'source' ) );\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Morph target animation not supported yet.' );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.controllers[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction parseSkin( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tsources: {}\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'bind_shape_matrix':\n\t\t\t\t\t\tdata.bindShapeMatrix = parseFloats( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'source':\n\t\t\t\t\t\tvar id = child.getAttribute( 'id' );\n\t\t\t\t\t\tdata.sources[ id ] = parseSource( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'joints':\n\t\t\t\t\t\tdata.joints = parseJoints( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'vertex_weights':\n\t\t\t\t\t\tdata.vertexWeights = parseVertexWeights( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseJoints( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tinputs: {}\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'input':\n\t\t\t\t\t\tvar semantic = child.getAttribute( 'semantic' );\n\t\t\t\t\t\tvar id = parseId( child.getAttribute( 'source' ) );\n\t\t\t\t\t\tdata.inputs[ semantic ] = id;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseVertexWeights( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tinputs: {}\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'input':\n\t\t\t\t\t\tvar semantic = child.getAttribute( 'semantic' );\n\t\t\t\t\t\tvar id = parseId( child.getAttribute( 'source' ) );\n\t\t\t\t\t\tvar offset = parseInt( child.getAttribute( 'offset' ) );\n\t\t\t\t\t\tdata.inputs[ semantic ] = { id: id, offset: offset };\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'vcount':\n\t\t\t\t\t\tdata.vcount = parseInts( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v':\n\t\t\t\t\t\tdata.v = parseInts( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction buildController( data ) {\n\n\t\t\tvar build = {\n\t\t\t\tid: data.id\n\t\t\t};\n\n\t\t\tvar geometry = library.geometries[ build.id ];\n\n\t\t\tif ( data.skin !== undefined ) {\n\n\t\t\t\tbuild.skin = buildSkin( data.skin );\n\n\t\t\t\t// we enhance the 'sources' property of the corresponding geometry with our skin data\n\n\t\t\t\tgeometry.sources.skinIndices = build.skin.indices;\n\t\t\t\tgeometry.sources.skinWeights = build.skin.weights;\n\n\t\t\t}\n\n\t\t\treturn build;\n\n\t\t}\n\n\t\tfunction buildSkin( data ) {\n\n\t\t\tvar BONE_LIMIT = 4;\n\n\t\t\tvar build = {\n\t\t\t\tjoints: [], // this must be an array to preserve the joint order\n\t\t\t\tindices: {\n\t\t\t\t\tarray: [],\n\t\t\t\t\tstride: BONE_LIMIT\n\t\t\t\t},\n\t\t\t\tweights: {\n\t\t\t\t\tarray: [],\n\t\t\t\t\tstride: BONE_LIMIT\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar sources = data.sources;\n\t\t\tvar vertexWeights = data.vertexWeights;\n\n\t\t\tvar vcount = vertexWeights.vcount;\n\t\t\tvar v = vertexWeights.v;\n\t\t\tvar jointOffset = vertexWeights.inputs.JOINT.offset;\n\t\t\tvar weightOffset = vertexWeights.inputs.WEIGHT.offset;\n\n\t\t\tvar jointSource = data.sources[ data.joints.inputs.JOINT ];\n\t\t\tvar inverseSource = data.sources[ data.joints.inputs.INV_BIND_MATRIX ];\n\n\t\t\tvar weights = sources[ vertexWeights.inputs.WEIGHT.id ].array;\n\t\t\tvar stride = 0;\n\n\t\t\tvar i, j, l;\n\n\t\t\t// procces skin data for each vertex\n\n\t\t\tfor ( i = 0, l = vcount.length; i < l; i ++ ) {\n\n\t\t\t\tvar jointCount = vcount[ i ]; // this is the amount of joints that affect a single vertex\n\t\t\t\tvar vertexSkinData = [];\n\n\t\t\t\tfor ( j = 0; j < jointCount; j ++ ) {\n\n\t\t\t\t\tvar skinIndex = v[ stride + jointOffset ];\n\t\t\t\t\tvar weightId = v[ stride + weightOffset ];\n\t\t\t\t\tvar skinWeight = weights[ weightId ];\n\n\t\t\t\t\tvertexSkinData.push( { index: skinIndex, weight: skinWeight } );\n\n\t\t\t\t\tstride += 2;\n\n\t\t\t\t}\n\n\t\t\t\t// we sort the joints in descending order based on the weights.\n\t\t\t\t// this ensures, we only procced the most important joints of the vertex\n\n\t\t\t\tvertexSkinData.sort( descending );\n\n\t\t\t\t// now we provide for each vertex a set of four index and weight values.\n\t\t\t\t// the order of the skin data matches the order of vertices\n\n\t\t\t\tfor ( j = 0; j < BONE_LIMIT; j ++ ) {\n\n\t\t\t\t\tvar d = vertexSkinData[ j ];\n\n\t\t\t\t\tif ( d !== undefined ) {\n\n\t\t\t\t\t\tbuild.indices.array.push( d.index );\n\t\t\t\t\t\tbuild.weights.array.push( d.weight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbuild.indices.array.push( 0 );\n\t\t\t\t\t\tbuild.weights.array.push( 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// setup bind matrix\n\n\t\t\tif ( data.bindShapeMatrix ) {\n\n\t\t\t\tbuild.bindMatrix = new Matrix4().fromArray( data.bindShapeMatrix ).transpose();\n\n\t\t\t} else {\n\n\t\t\t\tbuild.bindMatrix = new Matrix4().identity();\n\n\t\t\t}\n\n\t\t\t// process bones and inverse bind matrix data\n\n\t\t\tfor ( i = 0, l = jointSource.array.length; i < l; i ++ ) {\n\n\t\t\t\tvar name = jointSource.array[ i ];\n\t\t\t\tvar boneInverse = new Matrix4().fromArray( inverseSource.array, i * inverseSource.stride ).transpose();\n\n\t\t\t\tbuild.joints.push( { name: name, boneInverse: boneInverse } );\n\n\t\t\t}\n\n\t\t\treturn build;\n\n\t\t\t// array sort function\n\n\t\t\tfunction descending( a, b ) {\n\n\t\t\t\treturn b.weight - a.weight;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getController( id ) {\n\n\t\t\treturn getBuild( library.controllers[ id ], buildController );\n\n\t\t}\n\n\t\t// image\n\n\t\tfunction parseImage( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tinit_from: getElementsByTagName( xml, 'init_from' )[ 0 ].textContent\n\t\t\t};\n\n\t\t\tlibrary.images[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction buildImage( data ) {\n\n\t\t\tif ( data.build !== undefined ) return data.build;\n\n\t\t\treturn data.init_from;\n\n\t\t}\n\n\t\tfunction getImage( id ) {\n\n\t\t\tvar data = library.images[ id ];\n\n\t\t\tif ( data !== undefined ) {\n\n\t\t\t\treturn getBuild( data, buildImage );\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.ColladaLoader: Couldn\\'t find image with ID:', id );\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// effect\n\n\t\tfunction parseEffect( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'profile_COMMON':\n\t\t\t\t\t\tdata.profile = parseEffectProfileCOMMON( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.effects[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction parseEffectProfileCOMMON( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tsurfaces: {},\n\t\t\t\tsamplers: {}\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'newparam':\n\t\t\t\t\t\tparseEffectNewparam( child, data );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'technique':\n\t\t\t\t\t\tdata.technique = parseEffectTechnique( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'extra':\n\t\t\t\t\t\tdata.extra = parseEffectExtra( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseEffectNewparam( xml, data ) {\n\n\t\t\tvar sid = xml.getAttribute( 'sid' );\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'surface':\n\t\t\t\t\t\tdata.surfaces[ sid ] = parseEffectSurface( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'sampler2D':\n\t\t\t\t\t\tdata.samplers[ sid ] = parseEffectSampler( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parseEffectSurface( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'init_from':\n\t\t\t\t\t\tdata.init_from = child.textContent;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseEffectSampler( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'source':\n\t\t\t\t\t\tdata.source = child.textContent;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseEffectTechnique( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'constant':\n\t\t\t\t\tcase 'lambert':\n\t\t\t\t\tcase 'blinn':\n\t\t\t\t\tcase 'phong':\n\t\t\t\t\t\tdata.type = child.nodeName;\n\t\t\t\t\t\tdata.parameters = parseEffectParameters( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseEffectParameters( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'emission':\n\t\t\t\t\tcase 'diffuse':\n\t\t\t\t\tcase 'specular':\n\t\t\t\t\tcase 'bump':\n\t\t\t\t\tcase 'ambient':\n\t\t\t\t\tcase 'shininess':\n\t\t\t\t\tcase 'transparency':\n\t\t\t\t\t\tdata[ child.nodeName ] = parseEffectParameter( child );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'transparent':\n\t\t\t\t\t\tdata[ child.nodeName ] = {\n\t\t\t\t\t\t\topaque: child.getAttribute( 'opaque' ),\n\t\t\t\t\t\t\tdata: parseEffectParameter( child )\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseEffectParameter( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'color':\n\t\t\t\t\t\tdata[ child.nodeName ] = parseFloats( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'float':\n\t\t\t\t\t\tdata[ child.nodeName ] = parseFloat( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'texture':\n\t\t\t\t\t\tdata[ child.nodeName ] = { id: child.getAttribute( 'texture' ), extra: parseEffectParameterTexture( child ) };\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseEffectParameterTexture( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\ttechnique: {}\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'extra':\n\t\t\t\t\t\tparseEffectParameterTextureExtra( child, data );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseEffectParameterTextureExtra( xml, data ) {\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'technique':\n\t\t\t\t\t\tparseEffectParameterTextureExtraTechnique( child, data );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parseEffectParameterTextureExtraTechnique( xml, data ) {\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'repeatU':\n\t\t\t\t\tcase 'repeatV':\n\t\t\t\t\tcase 'offsetU':\n\t\t\t\t\tcase 'offsetV':\n\t\t\t\t\t\tdata.technique[ child.nodeName ] = parseFloat( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'wrapU':\n\t\t\t\t\tcase 'wrapV':\n\n\t\t\t\t\t\t// some files have values for wrapU/wrapV which become NaN via parseInt\n\n\t\t\t\t\t\tif ( child.textContent.toUpperCase() === 'TRUE' ) {\n\n\t\t\t\t\t\t\tdata.technique[ child.nodeName ] = 1;\n\n\t\t\t\t\t\t} else if ( child.textContent.toUpperCase() === 'FALSE' ) {\n\n\t\t\t\t\t\t\tdata.technique[ child.nodeName ] = 0;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tdata.technique[ child.nodeName ] = parseInt( child.textContent );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parseEffectExtra( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'technique':\n\t\t\t\t\t\tdata.technique = parseEffectExtraTechnique( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseEffectExtraTechnique( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'double_sided':\n\t\t\t\t\t\tdata[ child.nodeName ] = parseInt( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction buildEffect( data ) {\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction getEffect( id ) {\n\n\t\t\treturn getBuild( library.effects[ id ], buildEffect );\n\n\t\t}\n\n\t\t// material\n\n\t\tfunction parseMaterial( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tname: xml.getAttribute( 'name' )\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'instance_effect':\n\t\t\t\t\t\tdata.url = parseId( child.getAttribute( 'url' ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.materials[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction getTextureLoader( image ) {\n\n\t\t\tvar loader;\n\n\t\t\tvar extension = image.slice( ( image.lastIndexOf( '.' ) - 1 >>> 0 ) + 2 ); // http://www.jstips.co/en/javascript/get-file-extension/\n\t\t\textension = extension.toLowerCase();\n\n\t\t\tswitch ( extension ) {\n\n\t\t\t\tcase 'tga':\n\t\t\t\t\tloader = tgaLoader;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tloader = textureLoader;\n\n\t\t\t}\n\n\t\t\treturn loader;\n\n\t\t}\n\n\t\tfunction buildMaterial( data ) {\n\n\t\t\tvar effect = getEffect( data.url );\n\t\t\tvar technique = effect.profile.technique;\n\t\t\tvar extra = effect.profile.extra;\n\n\t\t\tvar material;\n\n\t\t\tswitch ( technique.type ) {\n\n\t\t\t\tcase 'phong':\n\t\t\t\tcase 'blinn':\n\t\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'lambert':\n\t\t\t\t\tmaterial = new MeshLambertMaterial();\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tmaterial = new MeshBasicMaterial();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tmaterial.name = data.name || '';\n\n\t\t\tfunction getTexture( textureObject ) {\n\n\t\t\t\tvar sampler = effect.profile.samplers[ textureObject.id ];\n\t\t\t\tvar image = null;\n\n\t\t\t\t// get image\n\n\t\t\t\tif ( sampler !== undefined ) {\n\n\t\t\t\t\tvar surface = effect.profile.surfaces[ sampler.source ];\n\t\t\t\t\timage = getImage( surface.init_from );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530).' );\n\t\t\t\t\timage = getImage( textureObject.id );\n\n\t\t\t\t}\n\n\t\t\t\t// create texture if image is avaiable\n\n\t\t\t\tif ( image !== null ) {\n\n\t\t\t\t\tvar loader = getTextureLoader( image );\n\n\t\t\t\t\tif ( loader !== undefined ) {\n\n\t\t\t\t\t\tvar texture = loader.load( image );\n\n\t\t\t\t\t\tvar extra = textureObject.extra;\n\n\t\t\t\t\t\tif ( extra !== undefined && extra.technique !== undefined && isEmpty( extra.technique ) === false ) {\n\n\t\t\t\t\t\t\tvar technique = extra.technique;\n\n\t\t\t\t\t\t\ttexture.wrapS = technique.wrapU ? RepeatWrapping : ClampToEdgeWrapping;\n\t\t\t\t\t\t\ttexture.wrapT = technique.wrapV ? RepeatWrapping : ClampToEdgeWrapping;\n\n\t\t\t\t\t\t\ttexture.offset.set( technique.offsetU || 0, technique.offsetV || 0 );\n\t\t\t\t\t\t\ttexture.repeat.set( technique.repeatU || 1, technique.repeatV || 1 );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttexture.wrapS = RepeatWrapping;\n\t\t\t\t\t\t\ttexture.wrapT = RepeatWrapping;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn texture;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Loader for texture %s not found.', image );\n\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Couldn\\'t create texture with ID:', textureObject.id );\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar parameters = technique.parameters;\n\n\t\t\tfor ( var key in parameters ) {\n\n\t\t\t\tvar parameter = parameters[ key ];\n\n\t\t\t\tswitch ( key ) {\n\n\t\t\t\t\tcase 'diffuse':\n\t\t\t\t\t\tif ( parameter.color ) material.color.fromArray( parameter.color );\n\t\t\t\t\t\tif ( parameter.texture ) material.map = getTexture( parameter.texture );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'specular':\n\t\t\t\t\t\tif ( parameter.color && material.specular ) material.specular.fromArray( parameter.color );\n\t\t\t\t\t\tif ( parameter.texture ) material.specularMap = getTexture( parameter.texture );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'bump':\n\t\t\t\t\t\tif ( parameter.texture ) material.normalMap = getTexture( parameter.texture );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'ambient':\n\t\t\t\t\t\tif ( parameter.texture ) material.lightMap = getTexture( parameter.texture );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'shininess':\n\t\t\t\t\t\tif ( parameter.float && material.shininess ) material.shininess = parameter.float;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'emission':\n\t\t\t\t\t\tif ( parameter.color && material.emissive ) material.emissive.fromArray( parameter.color );\n\t\t\t\t\t\tif ( parameter.texture ) material.emissiveMap = getTexture( parameter.texture );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tvar transparent = parameters[ 'transparent' ];\n\t\t\tvar transparency = parameters[ 'transparency' ];\n\n\t\t\t// <transparency> does not exist but <transparent>\n\n\t\t\tif ( transparency === undefined && transparent ) {\n\n\t\t\t\ttransparency = {\n\t\t\t\t\tfloat: 1\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\t// <transparent> does not exist but <transparency>\n\n\t\t\tif ( transparent === undefined && transparency ) {\n\n\t\t\t\ttransparent = {\n\t\t\t\t\topaque: 'A_ONE',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcolor: [ 1, 1, 1, 1 ]\n\t\t\t\t\t} };\n\n\t\t\t}\n\n\t\t\tif ( transparent && transparency ) {\n\n\t\t\t\t// handle case if a texture exists but no color\n\n\t\t\t\tif ( transparent.data.texture ) {\n\n\t\t\t\t\t// we do not set an alpha map (see #13792)\n\n\t\t\t\t\tmaterial.transparent = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar color = transparent.data.color;\n\n\t\t\t\t\tswitch ( transparent.opaque ) {\n\n\t\t\t\t\t\tcase 'A_ONE':\n\t\t\t\t\t\t\tmaterial.opacity = color[ 3 ] * transparency.float;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'RGB_ZERO':\n\t\t\t\t\t\t\tmaterial.opacity = 1 - ( color[ 0 ] * transparency.float );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'A_ZERO':\n\t\t\t\t\t\t\tmaterial.opacity = 1 - ( color[ 3 ] * transparency.float );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'RGB_ONE':\n\t\t\t\t\t\t\tmaterial.opacity = color[ 0 ] * transparency.float;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Invalid opaque type \"%s\" of transparent tag.', transparent.opaque );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( material.opacity < 1 ) material.transparent = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tif ( extra !== undefined && extra.technique !== undefined && extra.technique.double_sided === 1 ) {\n\n\t\t\t\tmaterial.side = DoubleSide;\n\n\t\t\t}\n\n\t\t\treturn material;\n\n\t\t}\n\n\t\tfunction getMaterial( id ) {\n\n\t\t\treturn getBuild( library.materials[ id ], buildMaterial );\n\n\t\t}\n\n\t\t// camera\n\n\t\tfunction parseCamera( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tname: xml.getAttribute( 'name' )\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'optics':\n\t\t\t\t\t\tdata.optics = parseCameraOptics( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.cameras[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction parseCameraOptics( xml ) {\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'technique_common':\n\t\t\t\t\t\treturn parseCameraTechnique( child );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {};\n\n\t\t}\n\n\t\tfunction parseCameraTechnique( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'perspective':\n\t\t\t\t\tcase 'orthographic':\n\n\t\t\t\t\t\tdata.technique = child.nodeName;\n\t\t\t\t\t\tdata.parameters = parseCameraParameters( child );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseCameraParameters( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'xfov':\n\t\t\t\t\tcase 'yfov':\n\t\t\t\t\tcase 'xmag':\n\t\t\t\t\tcase 'ymag':\n\t\t\t\t\tcase 'znear':\n\t\t\t\t\tcase 'zfar':\n\t\t\t\t\tcase 'aspect_ratio':\n\t\t\t\t\t\tdata[ child.nodeName ] = parseFloat( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction buildCamera( data ) {\n\n\t\t\tvar camera;\n\n\t\t\tswitch ( data.optics.technique ) {\n\n\t\t\t\tcase 'perspective':\n\t\t\t\t\tcamera = new PerspectiveCamera(\n\t\t\t\t\t\tdata.optics.parameters.yfov,\n\t\t\t\t\t\tdata.optics.parameters.aspect_ratio,\n\t\t\t\t\t\tdata.optics.parameters.znear,\n\t\t\t\t\t\tdata.optics.parameters.zfar\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'orthographic':\n\t\t\t\t\tvar ymag = data.optics.parameters.ymag;\n\t\t\t\t\tvar xmag = data.optics.parameters.xmag;\n\t\t\t\t\tvar aspectRatio = data.optics.parameters.aspect_ratio;\n\n\t\t\t\t\txmag = ( xmag === undefined ) ? ( ymag * aspectRatio ) : xmag;\n\t\t\t\t\tymag = ( ymag === undefined ) ? ( xmag / aspectRatio ) : ymag;\n\n\t\t\t\t\txmag *= 0.5;\n\t\t\t\t\tymag *= 0.5;\n\n\t\t\t\t\tcamera = new OrthographicCamera(\n\t\t\t\t\t\t- xmag, xmag, ymag, - ymag, // left, right, top, bottom\n\t\t\t\t\t\tdata.optics.parameters.znear,\n\t\t\t\t\t\tdata.optics.parameters.zfar\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tcamera = new PerspectiveCamera();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tcamera.name = data.name || '';\n\n\t\t\treturn camera;\n\n\t\t}\n\n\t\tfunction getCamera( id ) {\n\n\t\t\tvar data = library.cameras[ id ];\n\n\t\t\tif ( data !== undefined ) {\n\n\t\t\t\treturn getBuild( data, buildCamera );\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.ColladaLoader: Couldn\\'t find camera with ID:', id );\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// light\n\n\t\tfunction parseLight( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'technique_common':\n\t\t\t\t\t\tdata = parseLightTechnique( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.lights[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction parseLightTechnique( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'directional':\n\t\t\t\t\tcase 'point':\n\t\t\t\t\tcase 'spot':\n\t\t\t\t\tcase 'ambient':\n\n\t\t\t\t\t\tdata.technique = child.nodeName;\n\t\t\t\t\t\tdata.parameters = parseLightParameters( child );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseLightParameters( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'color':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tdata.color = new Color().fromArray( array );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'falloff_angle':\n\t\t\t\t\t\tdata.falloffAngle = parseFloat( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'quadratic_attenuation':\n\t\t\t\t\t\tvar f = parseFloat( child.textContent );\n\t\t\t\t\t\tdata.distance = f ? Math.sqrt( 1 / f ) : 0;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction buildLight( data ) {\n\n\t\t\tvar light;\n\n\t\t\tswitch ( data.technique ) {\n\n\t\t\t\tcase 'directional':\n\t\t\t\t\tlight = new DirectionalLight();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'point':\n\t\t\t\t\tlight = new PointLight();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'spot':\n\t\t\t\t\tlight = new SpotLight();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ambient':\n\t\t\t\t\tlight = new AmbientLight();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( data.parameters.color ) light.color.copy( data.parameters.color );\n\t\t\tif ( data.parameters.distance ) light.distance = data.parameters.distance;\n\n\t\t\treturn light;\n\n\t\t}\n\n\t\tfunction getLight( id ) {\n\n\t\t\tvar data = library.lights[ id ];\n\n\t\t\tif ( data !== undefined ) {\n\n\t\t\t\treturn getBuild( data, buildLight );\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.ColladaLoader: Couldn\\'t find light with ID:', id );\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// geometry\n\n\t\tfunction parseGeometry( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tname: xml.getAttribute( 'name' ),\n\t\t\t\tsources: {},\n\t\t\t\tvertices: {},\n\t\t\t\tprimitives: []\n\t\t\t};\n\n\t\t\tvar mesh = getElementsByTagName( xml, 'mesh' )[ 0 ];\n\n\t\t\t// the following tags inside geometry are not supported yet (see https://github.com/mrdoob/three.js/pull/12606): convex_mesh, spline, brep\n\t\t\tif ( mesh === undefined ) return;\n\n\t\t\tfor ( var i = 0; i < mesh.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = mesh.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tvar id = child.getAttribute( 'id' );\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'source':\n\t\t\t\t\t\tdata.sources[ id ] = parseSource( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'vertices':\n\t\t\t\t\t\t// data.sources[ id ] = data.sources[ parseId( getElementsByTagName( child, 'input' )[ 0 ].getAttribute( 'source' ) ) ];\n\t\t\t\t\t\tdata.vertices = parseGeometryVertices( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'polygons':\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Unsupported primitive type: ', child.nodeName );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'lines':\n\t\t\t\t\tcase 'linestrips':\n\t\t\t\t\tcase 'polylist':\n\t\t\t\t\tcase 'triangles':\n\t\t\t\t\t\tdata.primitives.push( parseGeometryPrimitive( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.log( child );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.geometries[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction parseSource( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tarray: [],\n\t\t\t\tstride: 3\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'float_array':\n\t\t\t\t\t\tdata.array = parseFloats( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Name_array':\n\t\t\t\t\t\tdata.array = parseStrings( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'technique_common':\n\t\t\t\t\t\tvar accessor = getElementsByTagName( child, 'accessor' )[ 0 ];\n\n\t\t\t\t\t\tif ( accessor !== undefined ) {\n\n\t\t\t\t\t\t\tdata.stride = parseInt( accessor.getAttribute( 'stride' ) );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseGeometryVertices( xml ) {\n\n\t\t\tvar data = {};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tdata[ child.getAttribute( 'semantic' ) ] = parseId( child.getAttribute( 'source' ) );\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseGeometryPrimitive( xml ) {\n\n\t\t\tvar primitive = {\n\t\t\t\ttype: xml.nodeName,\n\t\t\t\tmaterial: xml.getAttribute( 'material' ),\n\t\t\t\tcount: parseInt( xml.getAttribute( 'count' ) ),\n\t\t\t\tinputs: {},\n\t\t\t\tstride: 0,\n\t\t\t\thasUV: false\n\t\t\t};\n\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'input':\n\t\t\t\t\t\tvar id = parseId( child.getAttribute( 'source' ) );\n\t\t\t\t\t\tvar semantic = child.getAttribute( 'semantic' );\n\t\t\t\t\t\tvar offset = parseInt( child.getAttribute( 'offset' ) );\n\t\t\t\t\t\tvar set = parseInt( child.getAttribute( 'set' ) );\n\t\t\t\t\t\tvar inputname = ( set > 0 ? semantic + set : semantic );\n\t\t\t\t\t\tprimitive.inputs[ inputname ] = { id: id, offset: offset };\n\t\t\t\t\t\tprimitive.stride = Math.max( primitive.stride, offset + 1 );\n\t\t\t\t\t\tif ( semantic === 'TEXCOORD' ) primitive.hasUV = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'vcount':\n\t\t\t\t\t\tprimitive.vcount = parseInts( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'p':\n\t\t\t\t\t\tprimitive.p = parseInts( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn primitive;\n\n\t\t}\n\n\t\tfunction groupPrimitives( primitives ) {\n\n\t\t\tvar build = {};\n\n\t\t\tfor ( var i = 0; i < primitives.length; i ++ ) {\n\n\t\t\t\tvar primitive = primitives[ i ];\n\n\t\t\t\tif ( build[ primitive.type ] === undefined ) build[ primitive.type ] = [];\n\n\t\t\t\tbuild[ primitive.type ].push( primitive );\n\n\t\t\t}\n\n\t\t\treturn build;\n\n\t\t}\n\n\t\tfunction checkUVCoordinates( primitives ) {\n\n\t\t\tvar count = 0;\n\n\t\t\tfor ( var i = 0, l = primitives.length; i < l; i ++ ) {\n\n\t\t\t\tvar primitive = primitives[ i ];\n\n\t\t\t\tif ( primitive.hasUV === true ) {\n\n\t\t\t\t\tcount ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( count > 0 && count < primitives.length ) {\n\n\t\t\t\tprimitives.uvsNeedsFix = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction buildGeometry( data ) {\n\n\t\t\tvar build = {};\n\n\t\t\tvar sources = data.sources;\n\t\t\tvar vertices = data.vertices;\n\t\t\tvar primitives = data.primitives;\n\n\t\t\tif ( primitives.length === 0 ) return {};\n\n\t\t\t// our goal is to create one buffer geometry for a single type of primitives\n\t\t\t// first, we group all primitives by their type\n\n\t\t\tvar groupedPrimitives = groupPrimitives( primitives );\n\n\t\t\tfor ( var type in groupedPrimitives ) {\n\n\t\t\t\tvar primitiveType = groupedPrimitives[ type ];\n\n\t\t\t\t// second, ensure consistent uv coordinates for each type of primitives (polylist,triangles or lines)\n\n\t\t\t\tcheckUVCoordinates( primitiveType );\n\n\t\t\t\t// third, create a buffer geometry for each type of primitives\n\n\t\t\t\tbuild[ type ] = buildGeometryType( primitiveType, sources, vertices );\n\n\t\t\t}\n\n\t\t\treturn build;\n\n\t\t}\n\n\t\tfunction buildGeometryType( primitives, sources, vertices ) {\n\n\t\t\tvar build = {};\n\n\t\t\tvar position = { array: [], stride: 0 };\n\t\t\tvar normal = { array: [], stride: 0 };\n\t\t\tvar uv = { array: [], stride: 0 };\n\t\t\tvar uv2 = { array: [], stride: 0 };\n\t\t\tvar color = { array: [], stride: 0 };\n\n\t\t\tvar skinIndex = { array: [], stride: 4 };\n\t\t\tvar skinWeight = { array: [], stride: 4 };\n\n\t\t\tvar geometry = new BufferGeometry();\n\n\t\t\tvar materialKeys = [];\n\n\t\t\tvar start = 0;\n\n\t\t\tfor ( var p = 0; p < primitives.length; p ++ ) {\n\n\t\t\t\tvar primitive = primitives[ p ];\n\t\t\t\tvar inputs = primitive.inputs;\n\n\t\t\t\t// groups\n\n\t\t\t\tvar count = 0;\n\n\t\t\t\tswitch ( primitive.type ) {\n\n\t\t\t\t\tcase 'lines':\n\t\t\t\t\tcase 'linestrips':\n\t\t\t\t\t\tcount = primitive.count * 2;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'triangles':\n\t\t\t\t\t\tcount = primitive.count * 3;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'polylist':\n\n\t\t\t\t\t\tfor ( var g = 0; g < primitive.count; g ++ ) {\n\n\t\t\t\t\t\t\tvar vc = primitive.vcount[ g ];\n\n\t\t\t\t\t\t\tswitch ( vc ) {\n\n\t\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\t\tcount += 3; // single triangle\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\t\t\tcount += 6; // quad, subdivided into two triangles\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tcount += ( vc - 2 ) * 3; // polylist with more than four vertices\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Unknow primitive type:', primitive.type );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.addGroup( start, count, p );\n\t\t\t\tstart += count;\n\n\t\t\t\t// material\n\n\t\t\t\tif ( primitive.material ) {\n\n\t\t\t\t\tmaterialKeys.push( primitive.material );\n\n\t\t\t\t}\n\n\t\t\t\t// geometry data\n\n\t\t\t\tfor ( var name in inputs ) {\n\n\t\t\t\t\tvar input = inputs[ name ];\n\n\t\t\t\t\tswitch ( name )\t{\n\n\t\t\t\t\t\tcase 'VERTEX':\n\t\t\t\t\t\t\tfor ( var key in vertices ) {\n\n\t\t\t\t\t\t\t\tvar id = vertices[ key ];\n\n\t\t\t\t\t\t\t\tswitch ( key ) {\n\n\t\t\t\t\t\t\t\t\tcase 'POSITION':\n\t\t\t\t\t\t\t\t\t\tvar prevLength = position.array.length;\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, position.array );\n\t\t\t\t\t\t\t\t\t\tposition.stride = sources[ id ].stride;\n\n\t\t\t\t\t\t\t\t\t\tif ( sources.skinWeights && sources.skinIndices ) {\n\n\t\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources.skinIndices, input.offset, skinIndex.array );\n\t\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources.skinWeights, input.offset, skinWeight.array );\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// see #3803\n\n\t\t\t\t\t\t\t\t\t\tif ( primitive.hasUV === false && primitives.uvsNeedsFix === true ) {\n\n\t\t\t\t\t\t\t\t\t\t\tvar count = ( position.array.length - prevLength ) / position.stride;\n\n\t\t\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < count; i ++ ) {\n\n\t\t\t\t\t\t\t\t\t\t\t\t// fill missing uv coordinates\n\n\t\t\t\t\t\t\t\t\t\t\t\tuv.array.push( 0, 0 );\n\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\tcase 'NORMAL':\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, normal.array );\n\t\t\t\t\t\t\t\t\t\tnormal.stride = sources[ id ].stride;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\tcase 'COLOR':\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, color.array );\n\t\t\t\t\t\t\t\t\t\tcolor.stride = sources[ id ].stride;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\tcase 'TEXCOORD':\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, uv.array );\n\t\t\t\t\t\t\t\t\t\tuv.stride = sources[ id ].stride;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\tcase 'TEXCOORD1':\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, uv2.array );\n\t\t\t\t\t\t\t\t\t\tuv.stride = sources[ id ].stride;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Semantic \"%s\" not handled in geometry build process.', key );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'NORMAL':\n\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ input.id ], input.offset, normal.array );\n\t\t\t\t\t\t\tnormal.stride = sources[ input.id ].stride;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'COLOR':\n\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ input.id ], input.offset, color.array );\n\t\t\t\t\t\t\tcolor.stride = sources[ input.id ].stride;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'TEXCOORD':\n\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ input.id ], input.offset, uv.array );\n\t\t\t\t\t\t\tuv.stride = sources[ input.id ].stride;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'TEXCOORD1':\n\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ input.id ], input.offset, uv2.array );\n\t\t\t\t\t\t\tuv2.stride = sources[ input.id ].stride;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// build geometry\n\n\t\t\tif ( position.array.length > 0 ) geometry.setAttribute( 'position', new Float32BufferAttribute( position.array, position.stride ) );\n\t\t\tif ( normal.array.length > 0 ) geometry.setAttribute( 'normal', new Float32BufferAttribute( normal.array, normal.stride ) );\n\t\t\tif ( color.array.length > 0 ) geometry.setAttribute( 'color', new Float32BufferAttribute( color.array, color.stride ) );\n\t\t\tif ( uv.array.length > 0 ) geometry.setAttribute( 'uv', new Float32BufferAttribute( uv.array, uv.stride ) );\n\t\t\tif ( uv2.array.length > 0 ) geometry.setAttribute( 'uv2', new Float32BufferAttribute( uv2.array, uv2.stride ) );\n\n\t\t\tif ( skinIndex.array.length > 0 ) geometry.setAttribute( 'skinIndex', new Float32BufferAttribute( skinIndex.array, skinIndex.stride ) );\n\t\t\tif ( skinWeight.array.length > 0 ) geometry.setAttribute( 'skinWeight', new Float32BufferAttribute( skinWeight.array, skinWeight.stride ) );\n\n\t\t\tbuild.data = geometry;\n\t\t\tbuild.type = primitives[ 0 ].type;\n\t\t\tbuild.materialKeys = materialKeys;\n\n\t\t\treturn build;\n\n\t\t}\n\n\t\tfunction buildGeometryData( primitive, source, offset, array ) {\n\n\t\t\tvar indices = primitive.p;\n\t\t\tvar stride = primitive.stride;\n\t\t\tvar vcount = primitive.vcount;\n\n\t\t\tfunction pushVector( i ) {\n\n\t\t\t\tvar index = indices[ i + offset ] * sourceStride;\n\t\t\t\tvar length = index + sourceStride;\n\n\t\t\t\tfor ( ; index < length; index ++ ) {\n\n\t\t\t\t\tarray.push( sourceArray[ index ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar sourceArray = source.array;\n\t\t\tvar sourceStride = source.stride;\n\n\t\t\tif ( primitive.vcount !== undefined ) {\n\n\t\t\t\tvar index = 0;\n\n\t\t\t\tfor ( var i = 0, l = vcount.length; i < l; i ++ ) {\n\n\t\t\t\t\tvar count = vcount[ i ];\n\n\t\t\t\t\tif ( count === 4 ) {\n\n\t\t\t\t\t\tvar a = index + stride * 0;\n\t\t\t\t\t\tvar b = index + stride * 1;\n\t\t\t\t\t\tvar c = index + stride * 2;\n\t\t\t\t\t\tvar d = index + stride * 3;\n\n\t\t\t\t\t\tpushVector( a ); pushVector( b ); pushVector( d );\n\t\t\t\t\t\tpushVector( b ); pushVector( c ); pushVector( d );\n\n\t\t\t\t\t} else if ( count === 3 ) {\n\n\t\t\t\t\t\tvar a = index + stride * 0;\n\t\t\t\t\t\tvar b = index + stride * 1;\n\t\t\t\t\t\tvar c = index + stride * 2;\n\n\t\t\t\t\t\tpushVector( a ); pushVector( b ); pushVector( c );\n\n\t\t\t\t\t} else if ( count > 4 ) {\n\n\t\t\t\t\t\tfor ( var k = 1, kl = ( count - 2 ); k <= kl; k ++ ) {\n\n\t\t\t\t\t\t\tvar a = index + stride * 0;\n\t\t\t\t\t\t\tvar b = index + stride * k;\n\t\t\t\t\t\t\tvar c = index + stride * ( k + 1 );\n\n\t\t\t\t\t\t\tpushVector( a ); pushVector( b ); pushVector( c );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tindex += stride * count;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += stride ) {\n\n\t\t\t\t\tpushVector( i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getGeometry( id ) {\n\n\t\t\treturn getBuild( library.geometries[ id ], buildGeometry );\n\n\t\t}\n\n\t\t// kinematics\n\n\t\tfunction parseKinematicsModel( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\n\t\t\t\tjoints: {},\n\t\t\t\tlinks: []\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'technique_common':\n\t\t\t\t\t\tparseKinematicsTechniqueCommon( child, data );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.kinematicsModels[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction buildKinematicsModel( data ) {\n\n\t\t\tif ( data.build !== undefined ) return data.build;\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction getKinematicsModel( id ) {\n\n\t\t\treturn getBuild( library.kinematicsModels[ id ], buildKinematicsModel );\n\n\t\t}\n\n\t\tfunction parseKinematicsTechniqueCommon( xml, data ) {\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'joint':\n\t\t\t\t\t\tdata.joints[ child.getAttribute( 'sid' ) ] = parseKinematicsJoint( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'link':\n\t\t\t\t\t\tdata.links.push( parseKinematicsLink( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parseKinematicsJoint( xml ) {\n\n\t\t\tvar data;\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'prismatic':\n\t\t\t\t\tcase 'revolute':\n\t\t\t\t\t\tdata = parseKinematicsJointParameter( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseKinematicsJointParameter( xml, data ) {\n\n\t\t\tvar data = {\n\t\t\t\tsid: xml.getAttribute( 'sid' ),\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\n\t\t\t\taxis: new Vector3(),\n\t\t\t\tlimits: {\n\t\t\t\t\tmin: 0,\n\t\t\t\t\tmax: 0\n\t\t\t\t},\n\t\t\t\ttype: xml.nodeName,\n\t\t\t\tstatic: false,\n\t\t\t\tzeroPosition: 0,\n\t\t\t\tmiddlePosition: 0\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'axis':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tdata.axis.fromArray( array );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'limits':\n\t\t\t\t\t\tvar max = child.getElementsByTagName( 'max' )[ 0 ];\n\t\t\t\t\t\tvar min = child.getElementsByTagName( 'min' )[ 0 ];\n\n\t\t\t\t\t\tdata.limits.max = parseFloat( max.textContent );\n\t\t\t\t\t\tdata.limits.min = parseFloat( min.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// if min is equal to or greater than max, consider the joint static\n\n\t\t\tif ( data.limits.min >= data.limits.max ) {\n\n\t\t\t\tdata.static = true;\n\n\t\t\t}\n\n\t\t\t// calculate middle position\n\n\t\t\tdata.middlePosition = ( data.limits.min + data.limits.max ) / 2.0;\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseKinematicsLink( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tsid: xml.getAttribute( 'sid' ),\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\n\t\t\t\tattachments: [],\n\t\t\t\ttransforms: []\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'attachment_full':\n\t\t\t\t\t\tdata.attachments.push( parseKinematicsAttachment( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'matrix':\n\t\t\t\t\tcase 'translate':\n\t\t\t\t\tcase 'rotate':\n\t\t\t\t\t\tdata.transforms.push( parseKinematicsTransform( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseKinematicsAttachment( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tjoint: xml.getAttribute( 'joint' ).split( '/' ).pop(),\n\t\t\t\ttransforms: [],\n\t\t\t\tlinks: []\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'link':\n\t\t\t\t\t\tdata.links.push( parseKinematicsLink( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'matrix':\n\t\t\t\t\tcase 'translate':\n\t\t\t\t\tcase 'rotate':\n\t\t\t\t\t\tdata.transforms.push( parseKinematicsTransform( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseKinematicsTransform( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\ttype: xml.nodeName\n\t\t\t};\n\n\t\t\tvar array = parseFloats( xml.textContent );\n\n\t\t\tswitch ( data.type ) {\n\n\t\t\t\tcase 'matrix':\n\t\t\t\t\tdata.obj = new Matrix4();\n\t\t\t\t\tdata.obj.fromArray( array ).transpose();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'translate':\n\t\t\t\t\tdata.obj = new Vector3();\n\t\t\t\t\tdata.obj.fromArray( array );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'rotate':\n\t\t\t\t\tdata.obj = new Vector3();\n\t\t\t\t\tdata.obj.fromArray( array );\n\t\t\t\t\tdata.angle = _Math.degToRad( array[ 3 ] );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\t// physics\n\n\t\tfunction parsePhysicsModel( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\n\t\t\t\trigidBodies: {}\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'rigid_body':\n\t\t\t\t\t\tdata.rigidBodies[ child.getAttribute( 'name' ) ] = {};\n\t\t\t\t\t\tparsePhysicsRigidBody( child, data.rigidBodies[ child.getAttribute( 'name' ) ] );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.physicsModels[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction parsePhysicsRigidBody( xml, data ) {\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'technique_common':\n\t\t\t\t\t\tparsePhysicsTechniqueCommon( child, data );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parsePhysicsTechniqueCommon( xml, data ) {\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'inertia':\n\t\t\t\t\t\tdata.inertia = parseFloats( child.textContent );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'mass':\n\t\t\t\t\t\tdata.mass = parseFloats( child.textContent )[ 0 ];\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// scene\n\n\t\tfunction parseKinematicsScene( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tbindJointAxis: []\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'bind_joint_axis':\n\t\t\t\t\t\tdata.bindJointAxis.push( parseKinematicsBindJointAxis( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlibrary.kinematicsScenes[ parseId( xml.getAttribute( 'url' ) ) ] = data;\n\n\t\t}\n\n\t\tfunction parseKinematicsBindJointAxis( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\ttarget: xml.getAttribute( 'target' ).split( '/' ).pop()\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'axis':\n\t\t\t\t\t\tvar param = child.getElementsByTagName( 'param' )[ 0 ];\n\t\t\t\t\t\tdata.axis = param.textContent;\n\t\t\t\t\t\tvar tmpJointIndex = data.axis.split( 'inst_' ).pop().split( 'axis' )[ 0 ];\n\t\t\t\t\t\tdata.jointIndex = tmpJointIndex.substr( 0, tmpJointIndex.length - 1 );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction buildKinematicsScene( data ) {\n\n\t\t\tif ( data.build !== undefined ) return data.build;\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction getKinematicsScene( id ) {\n\n\t\t\treturn getBuild( library.kinematicsScenes[ id ], buildKinematicsScene );\n\n\t\t}\n\n\t\tfunction setupKinematics() {\n\n\t\t\tvar kinematicsModelId = Object.keys( library.kinematicsModels )[ 0 ];\n\t\t\tvar kinematicsSceneId = Object.keys( library.kinematicsScenes )[ 0 ];\n\t\t\tvar visualSceneId = Object.keys( library.visualScenes )[ 0 ];\n\n\t\t\tif ( kinematicsModelId === undefined || kinematicsSceneId === undefined ) return;\n\n\t\t\tvar kinematicsModel = getKinematicsModel( kinematicsModelId );\n\t\t\tvar kinematicsScene = getKinematicsScene( kinematicsSceneId );\n\t\t\tvar visualScene = getVisualScene( visualSceneId );\n\n\t\t\tvar bindJointAxis = kinematicsScene.bindJointAxis;\n\t\t\tvar jointMap = {};\n\n\t\t\tfor ( var i = 0, l = bindJointAxis.length; i < l; i ++ ) {\n\n\t\t\t\tvar axis = bindJointAxis[ i ];\n\n\t\t\t\t// the result of the following query is an element of type 'translate', 'rotate','scale' or 'matrix'\n\n\t\t\t\tvar targetElement = collada.querySelector( '[sid=\"' + axis.target + '\"]' );\n\n\t\t\t\tif ( targetElement ) {\n\n\t\t\t\t\t// get the parent of the transfrom element\n\n\t\t\t\t\tvar parentVisualElement = targetElement.parentElement;\n\n\t\t\t\t\t// connect the joint of the kinematics model with the element in the visual scene\n\n\t\t\t\t\tconnect( axis.jointIndex, parentVisualElement );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction connect( jointIndex, visualElement ) {\n\n\t\t\t\tvar visualElementName = visualElement.getAttribute( 'name' );\n\t\t\t\tvar joint = kinematicsModel.joints[ jointIndex ];\n\n\t\t\t\tvisualScene.traverse( function ( object ) {\n\n\t\t\t\t\tif ( object.name === visualElementName ) {\n\n\t\t\t\t\t\tjointMap[ jointIndex ] = {\n\t\t\t\t\t\t\tobject: object,\n\t\t\t\t\t\t\ttransforms: buildTransformList( visualElement ),\n\t\t\t\t\t\t\tjoint: joint,\n\t\t\t\t\t\t\tposition: joint.zeroPosition\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tvar m0 = new Matrix4();\n\n\t\t\tkinematics = {\n\n\t\t\t\tjoints: kinematicsModel && kinematicsModel.joints,\n\n\t\t\t\tgetJointValue: function ( jointIndex ) {\n\n\t\t\t\t\tvar jointData = jointMap[ jointIndex ];\n\n\t\t\t\t\tif ( jointData ) {\n\n\t\t\t\t\t\treturn jointData.position;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' doesn\\'t exist.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t},\n\n\t\t\t\tsetJointValue: function ( jointIndex, value ) {\n\n\t\t\t\t\tvar jointData = jointMap[ jointIndex ];\n\n\t\t\t\t\tif ( jointData ) {\n\n\t\t\t\t\t\tvar joint = jointData.joint;\n\n\t\t\t\t\t\tif ( value > joint.limits.max || value < joint.limits.min ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' value ' + value + ' outside of limits (min: ' + joint.limits.min + ', max: ' + joint.limits.max + ').' );\n\n\t\t\t\t\t\t} else if ( joint.static ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' is static.' );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tvar object = jointData.object;\n\t\t\t\t\t\t\tvar axis = joint.axis;\n\t\t\t\t\t\t\tvar transforms = jointData.transforms;\n\n\t\t\t\t\t\t\tmatrix.identity();\n\n\t\t\t\t\t\t\t// each update, we have to apply all transforms in the correct order\n\n\t\t\t\t\t\t\tfor ( var i = 0; i < transforms.length; i ++ ) {\n\n\t\t\t\t\t\t\t\tvar transform = transforms[ i ];\n\n\t\t\t\t\t\t\t\t// if there is a connection of the transform node with a joint, apply the joint value\n\n\t\t\t\t\t\t\t\tif ( transform.sid && transform.sid.indexOf( jointIndex ) !== - 1 ) {\n\n\t\t\t\t\t\t\t\t\tswitch ( joint.type ) {\n\n\t\t\t\t\t\t\t\t\t\tcase 'revolute':\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m0.makeRotationAxis( axis, _Math.degToRad( value ) ) );\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\t\tcase 'prismatic':\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m0.makeTranslation( axis.x * value, axis.y * value, axis.z * value ) );\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Unknown joint type: ' + joint.type );\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tswitch ( transform.type ) {\n\n\t\t\t\t\t\t\t\t\t\tcase 'matrix':\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( transform.obj );\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\t\tcase 'translate':\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m0.makeTranslation( transform.obj.x, transform.obj.y, transform.obj.z ) );\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\t\tcase 'scale':\n\t\t\t\t\t\t\t\t\t\t\tmatrix.scale( transform.obj );\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\t\tcase 'rotate':\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m0.makeRotationAxis( transform.obj, transform.angle ) );\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tobject.matrix.copy( matrix );\n\t\t\t\t\t\t\tobject.matrix.decompose( object.position, object.quaternion, object.scale );\n\n\t\t\t\t\t\t\tjointMap[ jointIndex ].position = value;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.log( 'THREE.ColladaLoader: ' + jointIndex + ' does not exist.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\tfunction buildTransformList( node ) {\n\n\t\t\tvar transforms = [];\n\n\t\t\tvar xml = collada.querySelector( '[id=\"' + node.id + '\"]' );\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'matrix':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tvar matrix = new Matrix4().fromArray( array ).transpose();\n\t\t\t\t\t\ttransforms.push( {\n\t\t\t\t\t\t\tsid: child.getAttribute( 'sid' ),\n\t\t\t\t\t\t\ttype: child.nodeName,\n\t\t\t\t\t\t\tobj: matrix\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'translate':\n\t\t\t\t\tcase 'scale':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tvar vector = new Vector3().fromArray( array );\n\t\t\t\t\t\ttransforms.push( {\n\t\t\t\t\t\t\tsid: child.getAttribute( 'sid' ),\n\t\t\t\t\t\t\ttype: child.nodeName,\n\t\t\t\t\t\t\tobj: vector\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'rotate':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tvar vector = new Vector3().fromArray( array );\n\t\t\t\t\t\tvar angle = _Math.degToRad( array[ 3 ] );\n\t\t\t\t\t\ttransforms.push( {\n\t\t\t\t\t\t\tsid: child.getAttribute( 'sid' ),\n\t\t\t\t\t\t\ttype: child.nodeName,\n\t\t\t\t\t\t\tobj: vector,\n\t\t\t\t\t\t\tangle: angle\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn transforms;\n\n\t\t}\n\n\t\t// nodes\n\n\t\tfunction prepareNodes( xml ) {\n\n\t\t\tvar elements = xml.getElementsByTagName( 'node' );\n\n\t\t\t// ensure all node elements have id attributes\n\n\t\t\tfor ( var i = 0; i < elements.length; i ++ ) {\n\n\t\t\t\tvar element = elements[ i ];\n\n\t\t\t\tif ( element.hasAttribute( 'id' ) === false ) {\n\n\t\t\t\t\telement.setAttribute( 'id', generateId() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar matrix = new Matrix4();\n\t\tvar vector = new Vector3();\n\n\t\tfunction parseNode( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\n\t\t\t\ttype: xml.getAttribute( 'type' ),\n\t\t\t\tid: xml.getAttribute( 'id' ),\n\t\t\t\tsid: xml.getAttribute( 'sid' ),\n\t\t\t\tmatrix: new Matrix4(),\n\t\t\t\tnodes: [],\n\t\t\t\tinstanceCameras: [],\n\t\t\t\tinstanceControllers: [],\n\t\t\t\tinstanceLights: [],\n\t\t\t\tinstanceGeometries: [],\n\t\t\t\tinstanceNodes: [],\n\t\t\t\ttransforms: {}\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'node':\n\t\t\t\t\t\tdata.nodes.push( child.getAttribute( 'id' ) );\n\t\t\t\t\t\tparseNode( child );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'instance_camera':\n\t\t\t\t\t\tdata.instanceCameras.push( parseId( child.getAttribute( 'url' ) ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'instance_controller':\n\t\t\t\t\t\tdata.instanceControllers.push( parseNodeInstance( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'instance_light':\n\t\t\t\t\t\tdata.instanceLights.push( parseId( child.getAttribute( 'url' ) ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'instance_geometry':\n\t\t\t\t\t\tdata.instanceGeometries.push( parseNodeInstance( child ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'instance_node':\n\t\t\t\t\t\tdata.instanceNodes.push( parseId( child.getAttribute( 'url' ) ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'matrix':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tdata.matrix.multiply( matrix.fromArray( array ).transpose() );\n\t\t\t\t\t\tdata.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'translate':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tvector.fromArray( array );\n\t\t\t\t\t\tdata.matrix.multiply( matrix.makeTranslation( vector.x, vector.y, vector.z ) );\n\t\t\t\t\t\tdata.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'rotate':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tvar angle = _Math.degToRad( array[ 3 ] );\n\t\t\t\t\t\tdata.matrix.multiply( matrix.makeRotationAxis( vector.fromArray( array ), angle ) );\n\t\t\t\t\t\tdata.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'scale':\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\n\t\t\t\t\t\tdata.matrix.scale( vector.fromArray( array ) );\n\t\t\t\t\t\tdata.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'extra':\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.log( child );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasNode( data.id ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.', data.id );\n\n\t\t\t} else {\n\n\t\t\t\tlibrary.nodes[ data.id ] = data;\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction parseNodeInstance( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tid: parseId( xml.getAttribute( 'url' ) ),\n\t\t\t\tmaterials: {},\n\t\t\t\tskeletons: []\n\t\t\t};\n\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n\t\t\t\tvar child = xml.childNodes[ i ];\n\n\t\t\t\tswitch ( child.nodeName ) {\n\n\t\t\t\t\tcase 'bind_material':\n\t\t\t\t\t\tvar instances = child.getElementsByTagName( 'instance_material' );\n\n\t\t\t\t\t\tfor ( var j = 0; j < instances.length; j ++ ) {\n\n\t\t\t\t\t\t\tvar instance = instances[ j ];\n\t\t\t\t\t\t\tvar symbol = instance.getAttribute( 'symbol' );\n\t\t\t\t\t\t\tvar target = instance.getAttribute( 'target' );\n\n\t\t\t\t\t\t\tdata.materials[ symbol ] = parseId( target );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'skeleton':\n\t\t\t\t\t\tdata.skeletons.push( parseId( child.textContent ) );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tfunction buildSkeleton( skeletons, joints ) {\n\n\t\t\tvar boneData = [];\n\t\t\tvar sortedBoneData = [];\n\n\t\t\tvar i, j, data;\n\n\t\t\t// a skeleton can have multiple root bones. collada expresses this\n\t\t\t// situtation with multiple \"skeleton\" tags per controller instance\n\n\t\t\tfor ( i = 0; i < skeletons.length; i ++ ) {\n\n\t\t\t\tvar skeleton = skeletons[ i ];\n\n\t\t\t\tvar root;\n\n\t\t\t\tif ( hasNode( skeleton ) ) {\n\n\t\t\t\t\troot = getNode( skeleton );\n\t\t\t\t\tbuildBoneHierarchy( root, joints, boneData );\n\n\t\t\t\t} else if ( hasVisualScene( skeleton ) ) {\n\n\t\t\t\t\t// handle case where the skeleton refers to the visual scene (#13335)\n\n\t\t\t\t\tvar visualScene = library.visualScenes[ skeleton ];\n\t\t\t\t\tvar children = visualScene.children;\n\n\t\t\t\t\tfor ( var j = 0; j < children.length; j ++ ) {\n\n\t\t\t\t\t\tvar child = children[ j ];\n\n\t\t\t\t\t\tif ( child.type === 'JOINT' ) {\n\n\t\t\t\t\t\t\tvar root = getNode( child.id );\n\t\t\t\t\t\t\tbuildBoneHierarchy( root, joints, boneData );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.ColladaLoader: Unable to find root bone of skeleton with ID:', skeleton );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// sort bone data (the order is defined in the corresponding controller)\n\n\t\t\tfor ( i = 0; i < joints.length; i ++ ) {\n\n\t\t\t\tfor ( j = 0; j < boneData.length; j ++ ) {\n\n\t\t\t\t\tdata = boneData[ j ];\n\n\t\t\t\t\tif ( data.bone.name === joints[ i ].name ) {\n\n\t\t\t\t\t\tsortedBoneData[ i ] = data;\n\t\t\t\t\t\tdata.processed = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add unprocessed bone data at the end of the list\n\n\t\t\tfor ( i = 0; i < boneData.length; i ++ ) {\n\n\t\t\t\tdata = boneData[ i ];\n\n\t\t\t\tif ( data.processed === false ) {\n\n\t\t\t\t\tsortedBoneData.push( data );\n\t\t\t\t\tdata.processed = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// setup arrays for skeleton creation\n\n\t\t\tvar bones = [];\n\t\t\tvar boneInverses = [];\n\n\t\t\tfor ( i = 0; i < sortedBoneData.length; i ++ ) {\n\n\t\t\t\tdata = sortedBoneData[ i ];\n\n\t\t\t\tbones.push( data.bone );\n\t\t\t\tboneInverses.push( data.boneInverse );\n\n\t\t\t}\n\n\t\t\treturn new Skeleton( bones, boneInverses );\n\n\t\t}\n\n\t\tfunction buildBoneHierarchy( root, joints, boneData ) {\n\n\t\t\t// setup bone data from visual scene\n\n\t\t\troot.traverse( function ( object ) {\n\n\t\t\t\tif ( object.isBone === true ) {\n\n\t\t\t\t\tvar boneInverse;\n\n\t\t\t\t\t// retrieve the boneInverse from the controller data\n\n\t\t\t\t\tfor ( var i = 0; i < joints.length; i ++ ) {\n\n\t\t\t\t\t\tvar joint = joints[ i ];\n\n\t\t\t\t\t\tif ( joint.name === object.name ) {\n\n\t\t\t\t\t\t\tboneInverse = joint.boneInverse;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( boneInverse === undefined ) {\n\n\t\t\t\t\t\t// Unfortunately, there can be joints in the visual scene that are not part of the\n\t\t\t\t\t\t// corresponding controller. In this case, we have to create a dummy boneInverse matrix\n\t\t\t\t\t\t// for the respective bone. This bone won't affect any vertices, because there are no skin indices\n\t\t\t\t\t\t// and weights defined for it. But we still have to add the bone to the sorted bone list in order to\n\t\t\t\t\t\t// ensure a correct animation of the model.\n\n\t\t\t\t\t\tboneInverse = new Matrix4();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneData.push( { bone: object, boneInverse: boneInverse, processed: false } );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\tfunction buildNode( data ) {\n\n\t\t\tvar objects = [];\n\n\t\t\tvar matrix = data.matrix;\n\t\t\tvar nodes = data.nodes;\n\t\t\tvar type = data.type;\n\t\t\tvar instanceCameras = data.instanceCameras;\n\t\t\tvar instanceControllers = data.instanceControllers;\n\t\t\tvar instanceLights = data.instanceLights;\n\t\t\tvar instanceGeometries = data.instanceGeometries;\n\t\t\tvar instanceNodes = data.instanceNodes;\n\n\t\t\t// nodes\n\n\t\t\tfor ( var i = 0, l = nodes.length; i < l; i ++ ) {\n\n\t\t\t\tobjects.push( getNode( nodes[ i ] ) );\n\n\t\t\t}\n\n\t\t\t// instance cameras\n\n\t\t\tfor ( var i = 0, l = instanceCameras.length; i < l; i ++ ) {\n\n\t\t\t\tvar instanceCamera = getCamera( instanceCameras[ i ] );\n\n\t\t\t\tif ( instanceCamera !== null ) {\n\n\t\t\t\t\tobjects.push( instanceCamera.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// instance controllers\n\n\t\t\tfor ( var i = 0, l = instanceControllers.length; i < l; i ++ ) {\n\n\t\t\t\tvar instance = instanceControllers[ i ];\n\t\t\t\tvar controller = getController( instance.id );\n\t\t\t\tvar geometries = getGeometry( controller.id );\n\t\t\t\tvar newObjects = buildObjects( geometries, instance.materials );\n\n\t\t\t\tvar skeletons = instance.skeletons;\n\t\t\t\tvar joints = controller.skin.joints;\n\n\t\t\t\tvar skeleton = buildSkeleton( skeletons, joints );\n\n\t\t\t\tfor ( var j = 0, jl = newObjects.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar object = newObjects[ j ];\n\n\t\t\t\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\t\t\t\tobject.bind( skeleton, controller.skin.bindMatrix );\n\t\t\t\t\t\tobject.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobjects.push( object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// instance lights\n\n\t\t\tfor ( var i = 0, l = instanceLights.length; i < l; i ++ ) {\n\n\t\t\t\tvar instanceLight = getLight( instanceLights[ i ] );\n\n\t\t\t\tif ( instanceLight !== null ) {\n\n\t\t\t\t\tobjects.push( instanceLight.clone() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// instance geometries\n\n\t\t\tfor ( var i = 0, l = instanceGeometries.length; i < l; i ++ ) {\n\n\t\t\t\tvar instance = instanceGeometries[ i ];\n\n\t\t\t\t// a single geometry instance in collada can lead to multiple object3Ds.\n\t\t\t\t// this is the case when primitives are combined like triangles and lines\n\n\t\t\t\tvar geometries = getGeometry( instance.id );\n\t\t\t\tvar newObjects = buildObjects( geometries, instance.materials );\n\n\t\t\t\tfor ( var j = 0, jl = newObjects.length; j < jl; j ++ ) {\n\n\t\t\t\t\tobjects.push( newObjects[ j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// instance nodes\n\n\t\t\tfor ( var i = 0, l = instanceNodes.length; i < l; i ++ ) {\n\n\t\t\t\tobjects.push( getNode( instanceNodes[ i ] ).clone() );\n\n\t\t\t}\n\n\t\t\tvar object;\n\n\t\t\tif ( nodes.length === 0 && objects.length === 1 ) {\n\n\t\t\t\tobject = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tobject = ( type === 'JOINT' ) ? new Bone() : new Group();\n\n\t\t\t\tfor ( var i = 0; i < objects.length; i ++ ) {\n\n\t\t\t\t\tobject.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( object.name === '' ) {\n\n\t\t\t\tobject.name = ( type === 'JOINT' ) ? data.sid : data.name;\n\n\t\t\t}\n\n\t\t\tobject.matrix.copy( matrix );\n\t\t\tobject.matrix.decompose( object.position, object.quaternion, object.scale );\n\n\t\t\treturn object;\n\n\t\t}\n\n\t\tvar fallbackMaterial = new MeshBasicMaterial( { color: 0xff00ff } );\n\n\t\tfunction resolveMaterialBinding( keys, instanceMaterials ) {\n\n\t\t\tvar materials = [];\n\n\t\t\tfor ( var i = 0, l = keys.length; i < l; i ++ ) {\n\n\t\t\t\tvar id = instanceMaterials[ keys[ i ] ];\n\n\t\t\t\tif ( id === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Material with key %s not found. Apply fallback material.', keys[ i ] );\n\t\t\t\t\tmaterials.push( fallbackMaterial );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tmaterials.push( getMaterial( id ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn materials;\n\n\t\t}\n\n\t\tfunction buildObjects( geometries, instanceMaterials ) {\n\n\t\t\tvar objects = [];\n\n\t\t\tfor ( var type in geometries ) {\n\n\t\t\t\tvar geometry = geometries[ type ];\n\n\t\t\t\tvar materials = resolveMaterialBinding( geometry.materialKeys, instanceMaterials );\n\n\t\t\t\t// handle case if no materials are defined\n\n\t\t\t\tif ( materials.length === 0 ) {\n\n\t\t\t\t\tif ( type === 'lines' || type === 'linestrips' ) {\n\n\t\t\t\t\t\tmaterials.push( new LineBasicMaterial() );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmaterials.push( new MeshPhongMaterial() );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// regard skinning\n\n\t\t\t\tvar skinning = ( geometry.data.attributes.skinIndex !== undefined );\n\n\t\t\t\tif ( skinning ) {\n\n\t\t\t\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tmaterials[ i ].skinning = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// choose between a single or multi materials (material array)\n\n\t\t\t\tvar material = ( materials.length === 1 ) ? materials[ 0 ] : materials;\n\n\t\t\t\t// now create a specific 3D object\n\n\t\t\t\tvar object;\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'lines':\n\t\t\t\t\t\tobject = new LineSegments( geometry.data, material );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'linestrips':\n\t\t\t\t\t\tobject = new Line( geometry.data, material );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'triangles':\n\t\t\t\t\tcase 'polylist':\n\t\t\t\t\t\tif ( skinning ) {\n\n\t\t\t\t\t\t\tobject = new SkinnedMesh( geometry.data, material );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tobject = new Mesh( geometry.data, material );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tobjects.push( object );\n\n\t\t\t}\n\n\t\t\treturn objects;\n\n\t\t}\n\n\t\tfunction hasNode( id ) {\n\n\t\t\treturn library.nodes[ id ] !== undefined;\n\n\t\t}\n\n\t\tfunction getNode( id ) {\n\n\t\t\treturn getBuild( library.nodes[ id ], buildNode );\n\n\t\t}\n\n\t\t// visual scenes\n\n\t\tfunction parseVisualScene( xml ) {\n\n\t\t\tvar data = {\n\t\t\t\tname: xml.getAttribute( 'name' ),\n\t\t\t\tchildren: []\n\t\t\t};\n\n\t\t\tprepareNodes( xml );\n\n\t\t\tvar elements = getElementsByTagName( xml, 'node' );\n\n\t\t\tfor ( var i = 0; i < elements.length; i ++ ) {\n\n\t\t\t\tdata.children.push( parseNode( elements[ i ] ) );\n\n\t\t\t}\n\n\t\t\tlibrary.visualScenes[ xml.getAttribute( 'id' ) ] = data;\n\n\t\t}\n\n\t\tfunction buildVisualScene( data ) {\n\n\t\t\tvar group = new Group();\n\t\t\tgroup.name = data.name;\n\n\t\t\tvar children = data.children;\n\n\t\t\tfor ( var i = 0; i < children.length; i ++ ) {\n\n\t\t\t\tvar child = children[ i ];\n\n\t\t\t\tgroup.add( getNode( child.id ) );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t}\n\n\t\tfunction hasVisualScene( id ) {\n\n\t\t\treturn library.visualScenes[ id ] !== undefined;\n\n\t\t}\n\n\t\tfunction getVisualScene( id ) {\n\n\t\t\treturn getBuild( library.visualScenes[ id ], buildVisualScene );\n\n\t\t}\n\n\t\t// scenes\n\n\t\tfunction parseScene( xml ) {\n\n\t\t\tvar instance = getElementsByTagName( xml, 'instance_visual_scene' )[ 0 ];\n\t\t\treturn getVisualScene( parseId( instance.getAttribute( 'url' ) ) );\n\n\t\t}\n\n\t\tfunction setupAnimations() {\n\n\t\t\tvar clips = library.clips;\n\n\t\t\tif ( isEmpty( clips ) === true ) {\n\n\t\t\t\tif ( isEmpty( library.animations ) === false ) {\n\n\t\t\t\t\t// if there are animations but no clips, we create a default clip for playback\n\n\t\t\t\t\tvar tracks = [];\n\n\t\t\t\t\tfor ( var id in library.animations ) {\n\n\t\t\t\t\t\tvar animationTracks = getAnimation( id );\n\n\t\t\t\t\t\tfor ( var i = 0, l = animationTracks.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\ttracks.push( animationTracks[ i ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tanimations.push( new AnimationClip( 'default', - 1, tracks ) );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( var id in clips ) {\n\n\t\t\t\t\tanimations.push( getAnimationClip( id ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// convert the parser error element into text with each child elements text\n\t\t// separated by new lines.\n\n\t\tfunction parserErrorToText( parserError ) {\n\n\t\t\tvar result = '';\n\t\t\tvar stack = [ parserError ];\n\n\t\t\twhile ( stack.length ) {\n\n\t\t\t\tvar node = stack.shift();\n\n\t\t\t\tif ( node.nodeType === Node.TEXT_NODE ) {\n\n\t\t\t\t\tresult += node.textContent;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tresult += '\\n';\n\t\t\t\t\tstack.push.apply( stack, node.childNodes );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn result.trim();\n\n\t\t}\n\n\t\tif ( text.length === 0 ) {\n\n\t\t\treturn { scene: new Scene() };\n\n\t\t}\n\n\t\tvar xml = new DOMParser().parseFromString( text, 'application/xml' );\n\n\t\tvar collada = getElementsByTagName( xml, 'COLLADA' )[ 0 ];\n\n\t\tvar parserError = xml.getElementsByTagName( 'parsererror' )[ 0 ];\n\t\tif ( parserError !== undefined ) {\n\n\t\t\t// Chrome will return parser error with a div in it\n\n\t\t\tvar errorElement = getElementsByTagName( parserError, 'div' )[ 0 ];\n\t\t\tvar errorText;\n\n\t\t\tif ( errorElement ) {\n\n\t\t\t\terrorText = errorElement.textContent;\n\n\t\t\t} else {\n\n\t\t\t\terrorText = parserErrorToText( parserError );\n\n\t\t\t}\n\n\t\t\tconsole.error( 'THREE.ColladaLoader: Failed to parse collada file.\\n', errorText );\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// metadata\n\n\t\tvar version = collada.getAttribute( 'version' );\n\t\tconsole.log( 'THREE.ColladaLoader: File version', version );\n\n\t\tvar asset = parseAsset( getElementsByTagName( collada, 'asset' )[ 0 ] );\n\t\tvar textureLoader = new TextureLoader( this.manager );\n\t\ttextureLoader.setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\tvar tgaLoader;\n\n\t\tif ( TGALoader ) {\n\n\t\t\ttgaLoader = new TGALoader( this.manager );\n\t\t\ttgaLoader.setPath( this.resourcePath || path );\n\n\t\t}\n\n\t\t//\n\n\t\tvar animations = [];\n\t\tvar kinematics = {};\n\t\tvar count = 0;\n\n\t\t//\n\n\t\tvar library = {\n\t\t\tanimations: {},\n\t\t\tclips: {},\n\t\t\tcontrollers: {},\n\t\t\timages: {},\n\t\t\teffects: {},\n\t\t\tmaterials: {},\n\t\t\tcameras: {},\n\t\t\tlights: {},\n\t\t\tgeometries: {},\n\t\t\tnodes: {},\n\t\t\tvisualScenes: {},\n\t\t\tkinematicsModels: {},\n\t\t\tphysicsModels: {},\n\t\t\tkinematicsScenes: {}\n\t\t};\n\n\t\tparseLibrary( collada, 'library_animations', 'animation', parseAnimation );\n\t\tparseLibrary( collada, 'library_animation_clips', 'animation_clip', parseAnimationClip );\n\t\tparseLibrary( collada, 'library_controllers', 'controller', parseController );\n\t\tparseLibrary( collada, 'library_images', 'image', parseImage );\n\t\tparseLibrary( collada, 'library_effects', 'effect', parseEffect );\n\t\tparseLibrary( collada, 'library_materials', 'material', parseMaterial );\n\t\tparseLibrary( collada, 'library_cameras', 'camera', parseCamera );\n\t\tparseLibrary( collada, 'library_lights', 'light', parseLight );\n\t\tparseLibrary( collada, 'library_geometries', 'geometry', parseGeometry );\n\t\tparseLibrary( collada, 'library_nodes', 'node', parseNode );\n\t\tparseLibrary( collada, 'library_visual_scenes', 'visual_scene', parseVisualScene );\n\t\tparseLibrary( collada, 'library_kinematics_models', 'kinematics_model', parseKinematicsModel );\n\t\tparseLibrary( collada, 'library_physics_models', 'physics_model', parsePhysicsModel );\n\t\tparseLibrary( collada, 'scene', 'instance_kinematics_scene', parseKinematicsScene );\n\n\t\tbuildLibrary( library.animations, buildAnimation );\n\t\tbuildLibrary( library.clips, buildAnimationClip );\n\t\tbuildLibrary( library.controllers, buildController );\n\t\tbuildLibrary( library.images, buildImage );\n\t\tbuildLibrary( library.effects, buildEffect );\n\t\tbuildLibrary( library.materials, buildMaterial );\n\t\tbuildLibrary( library.cameras, buildCamera );\n\t\tbuildLibrary( library.lights, buildLight );\n\t\tbuildLibrary( library.geometries, buildGeometry );\n\t\tbuildLibrary( library.visualScenes, buildVisualScene );\n\n\t\tsetupAnimations();\n\t\tsetupKinematics();\n\n\t\tvar scene = parseScene( getElementsByTagName( collada, 'scene' )[ 0 ] );\n\n\t\tif ( asset.upAxis === 'Z_UP' ) {\n\n\t\t\tscene.quaternion.setFromEuler( new Euler( - Math.PI / 2, 0, 0 ) );\n\n\t\t}\n\n\t\tscene.scale.multiplyScalar( asset.unit );\n\n\t\treturn {\n\t\t\tanimations: animations,\n\t\t\tkinematics: kinematics,\n\t\t\tlibrary: library,\n\t\t\tscene: scene\n\t\t};\n\n\t}\n\n} );\n\nexport { ColladaLoader };\n"]}